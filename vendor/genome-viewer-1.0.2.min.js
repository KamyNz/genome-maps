/*! Genome Viewer - v1.0.2 - 2013-07-17
* http://https://github.com/opencb-bigdata-viz/js-common-libs/
* Copyright (c) 2013  Licensed GPLv2 */
function Event(a){this._sender=a,this._listeners=[]}function CellBaseManager(a,b){this.host=CELLBASE_HOST,this.version=CELLBASE_VERSION,"string"==typeof a?this.species=a:null!=a&&(this.species=Utils.getSpeciesCode(a.text)),this.category=null,this.subcategory=null,this.contentformat="json",this.fileformat="",this.outputcompress=!1,this.dataType="script",this.query=null,this.originalQuery="",this.resource="",this.params={},this.async=!0,this.maxQuery=30,this.numberQueries=0,this.results=new Array,this.resultsCount=new Array,this.batching=!1,null!=b&&(null!=b.host&&(this.host=b.host),null!=b.async&&(this.async=b.async)),this.completed=new Event,this.success=new Event,this.batchSuccessed=new Event,this.error=new Event,this.setVersion=function(a){this.version=a},this.setSpecies=function(a){this.species=a},this.getVersion=function(){return this.version},this.getSpecies=function(){return this.species},this.setAsync=function(a){this.async=a},this.getUrl=function(){return null!=this.query?this.host+"/"+this.version+"/"+this.species+"/"+this.category+"/"+this.subcategory+"/"+this.query+"/"+this.resource:this.host+"/"+this.version+"/"+this.species+"/"+this.category+"/"+this.subcategory+"/"+this.resource},this.get=function(a,b,c,d,e,f){if(null!=e&&(this.params=e),null==c)return this.getSingle(a,b,c,d,f);var g;return g=c instanceof Array?c:c.split(","),this.originalQuery=g,g.length>1?(this.batching=!0,this.results=new Array,this.getMultiple(a,b,g,d)):this.maxQuery<g.length?(this.batching=!0,this.getMultiple(a,b,g,d,f),void 0):(this.batching=!1,this.getSingle(a,b,g[0],d,f))},this._joinToResults=function(a){if(this.resultsCount.push(!0),this.results[a.id]=a.data,this.numberQueries==this.resultsCount.length){for(var b=[],c=0;c<this.results.length;c++)for(var d=0;d<this.results[c].length;d++)b.push(this.results[c][d]);this.success.notify({result:b,category:this.category,subcategory:this.subcategory,query:this.originalQuery,resource:this.resource,params:this.params,error:""})}},this.getSingle=function(a,b,c,d,e,f){this.category=a,this.subcategory=b,this.query=c,this.resource=d;var g=this.getUrl();return this._callServer(g,e,f)},this.getMultiple=function(a,b,c,d){var e=new Array;if(c.length>this.maxQuery)for(var f=0;f<c.length;f+=this.maxQuery)e.push(c.slice(f,f+this.maxQuery));else e.push(c);this.numberQueries=e.length;var g=this;this.batchSuccessed.addEventListener(function(a,b){g._joinToResults(b)});for(var f=0;f<e.length;f++)this.results.push(new Array),this.getSingle(a,b,e[f].toString(),d,f)},this._callServer=function(a,b){var c=this;if(this.params.of=this.contentformat,a+=this.getQuery(this.params,a),console.log(a),1!=this.async){var d=null;return $.ajax({type:"GET",url:a,dataType:"json",async:this.async,success:function(a){var b=a;d={result:b,category:c.category,subcategory:c.subcategory,query:c.originalQuery,resource:c.resource,params:c.params,error:""}},error:function(){}}),d}$.ajax({type:"GET",url:a,dataType:"json",async:this.async,success:function(a){var d=a;c.batching?c.batchSuccessed.notify({data:d,id:b}):c.success.notify({result:d,category:c.category,subcategory:c.subcategory,query:c.originalQuery,resource:c.resource,params:c.params,error:""})},complete:function(){c.completed.notify()},error:function(a,b,d){console.log("CellBaseManager: Ajax call returned : "+d+"	"+b+"	"+a.statusText+" END"),c.error.notify()}})}}function InfoWidget(a,b,c){switch(this.id="InfoWidget_"+Math.round(1e7*Math.random()),this.targetId=null,this.species=b,this.title=null,this.featureId=null,this.width=800,this.height=460,this.feature=null,this.query=null,this.adapter=null,null!=a&&(this.targetId=a),null!=c&&(null!=c.title&&(this.title=c.title),null!=c.width&&(this.width=c.width),null!=c.height&&(this.height=c.height)),b){case"hsapiens":this.ensemblSpecie="Homo_sapiens",this.reactomeSpecie="48887",this.wikipathwaysSpecie="Homo+sapiens",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie="";break;case"mmusculus":this.ensemblSpecies="Mus_musculus",this.reactomeSpecies="48892",this.wikipathwaysSpecie="Mus+musculus",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie="";break;case"drerio":this.ensemblSpecie="Danio_rerio",this.reactomeSpecie="68323",this.wikipathwaysSpecie="Danio+rerio",this.omimSpecie="",this.uniprotSpecie="",this.intactSpecie="",this.dbsnpSpecie="",this.haphapSpecie=""}this.notFoundPanel=Ext.create("Ext.panel.Panel",{id:this.id+"notFoundPanel",cls:"panel-border-left",border:!1,flex:3,bodyPadding:"40",html:"No results found"})}function GeneInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Gene Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function GeneOrangeInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Gene Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function MirnaInfoWidget(a,b,c){null==c&&(c=new Object),c.title="miRNA Information",InfoWidget.prototype.constructor.call(this,a,b,c)}function ProteinInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Protein Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function SnpInfoWidget(a,b,c){null==c&&(c=new Object),c.title="SNP Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function TFInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcription Factor Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function TranscriptInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcript",InfoWidget.prototype.constructor.call(this,a,b,c)}function TranscriptOrangeInfoWidget(a,b,c){null==c&&(c=new Object),c.title="Transcript",InfoWidget.prototype.constructor.call(this,a,b,c)}function VCFVariantInfoWidget(a,b,c){null==c&&(c=new Object),c.title="VCF variant Info",InfoWidget.prototype.constructor.call(this,a,b,c)}function DataSource(){}function FileDataSource(a){DataSource.prototype.constructor.call(this),this.file=a,this.success=new Event,this.error=new Event}function StringDataSource(a){DataSource.prototype.constructor.call(this),this.str=a,this.success=new Event}function UrlDataSource(a,b){DataSource.prototype.constructor.call(this),this.url=a,this.proxy=CELLBASE_HOST+"/latest/utils/proxy?url=",null!=b&&null!=b.proxy&&("boolean"==typeof b.proxy?0==b.proxy?this.proxy=!1:this.url=this.proxy+a:"string"==typeof b.proxy&&(this.url=b.proxy+a)),this.success=new Event,this.error=new Event}function CellBaseAdapter(a){if(_.extend(this,Backbone.Events),this.host=null,this.gzip=!0,this.params={},null!=a){if(null!=a.host&&(this.host=a.host),null!=a.species&&(this.species=a.species),null!=a.category&&(this.category=a.category),null!=a.subCategory&&(this.subCategory=a.subCategory),null!=a.resource&&(this.resource=a.resource),null!=a.featureCache)var b=a.featureCache;if(null!=a.params&&(this.params=a.params),null!=a.filters&&(this.filters=a.filters),null!=a.options&&(this.options=a.options),null!=a.featureConfig&&(null!=a.featureConfig.filters&&(this.filtersConfig=a.featureConfig.filters),null!=a.featureConfig.options)){this.optionsConfig=a.featureConfig.options;for(var c=0;c<this.optionsConfig.length;c++)1==this.optionsConfig[c].checked&&(this.options[this.optionsConfig[c].name]=!0,this.params[this.optionsConfig[c].name]=!0)}}this.featureCache=new FeatureCache(b)}function SequenceAdapter(a){_.extend(this,Backbone.Events),this.host=null,this.gzip=!0,this.params={},null!=a&&(null!=a.host&&(this.host=a.host),null!=a.species&&(this.species=a.species),null!=a.category&&(this.category=a.category),null!=a.subCategory&&(this.subCategory=a.subCategory),null!=a.resource&&(this.resource=a.resource),null!=a.featureCache&&a.featureCache,null!=a.params&&(this.params=a.params)),this.onGetData=new Event,this.sequence={},this.phastCons={},this.phylop={},this.start={},this.end={}}function FeatureDataAdapter(a,b){_.extend(this,Backbone.Events),this.dataSource=a,this.gzip=!0,this.params={},null!=b&&(null!=b.gzip&&(this.gzip=b.gzip),null!=b.species&&(this.species=b.species),null!=b.params&&(this.params=b.params)),this.featureCache=new FeatureCache({chunkSize:1e4,gzip:this.gzip}),this.chromosomesLoaded={}}function BEDDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GFF2DataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GFF3DataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function GTFDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},null!=b&&null!=b.async&&(this.async=b.async)}function VCFDataAdapter(a,b){FeatureDataAdapter.prototype.constructor.call(this,a,b),this.async=!0,this.featuresCount=0,this.featuresByChromosome={},this.header="",this.samples=[],null!=b&&null!=b.async&&(this.async=b.async)}function Region(a){this.chromosome=null,this.start=null,this.end=null,"undefined"!=typeof a&&(this.load(a),null!=a.str&&this.parse(a.str))}function FeatureBinarySearchTree(){this._root=null}function FeatureCache(a){this.args=a,this.id=Math.round(1e7*Math.random()),this.chunkSize=5e4,this.gzip=!0,this.maxSize=10485760,this.size=0,null!=a&&(null!=a.chunkSize&&(this.chunkSize=a.chunkSize),null!=a.gzip&&(this.gzip=a.gzip)),this.cache={},this.chunksDisplayed={},this.maxFeaturesInterval=0,this.gzip=!1}function NavigationBar(a){_.extend(this,Backbone.Events),this.id=Utils.genId("NavigationBar"),this.species="Homo sapiens",this.increment=3,this.zoom,_.extend(this,a),this.region=new Region(this.region),this.currentChromosomeList=[],this.on(this.handlers),this.rendered=!1,this.autoRender&&this.render()}function ChromosomePanel(a){if(_.extend(this,Backbone.Events),this.id=Utils.genId("ChromosomePanel"),this.pixelBase,this.species="hsapiens",this.width=600,this.height=75,_.extend(this,a),this.region=new Region(this.region),this.lastChromosome="",this.data,"handlers"in this)for(eventName in this.handlers)this.on(eventName,this.handlers[eventName]);this.rendered=!1,this.autoRender&&this.render()}function KaryotypePanel(a){if(_.extend(this,Backbone.Events),this.id=Utils.genId("KaryotypePanel"),this.pixelBase,this.species,this.width=600,this.height=75,_.extend(this,a),this.region=new Region(this.region),this.lastSpecies=this.species,this.afterRender=new Event,this.chromosomeList,this.data2,"handlers"in this)for(eventName in this.handlers)this.on(eventName,this.handlers[eventName]);this.rendered=!1,this.autoRender&&this.render()}function TrackListPanel(a){_.extend(this,Backbone.Events),this.id=Utils.genId("TrackListPanel"),this.trackSvgList=[],this.swapHash={},this.zoomOffset=0,this.parentLayout,this.mousePosition,this.windowSize,this.zoomMultiplier=1,this.fontFamily="Source Sans Pro",this.height=0,_.extend(this,a),this.region=new Region(this.region),this.width-=18,this.visualRegion=new Region(this.region),this._setPixelBaseAndZoom(),this.onWindowSize=new Event,this.onMousePosition=new Event,this.on(this.handlers),this.rendered=!1,this.autoRender&&this.render()}function StatusBar(a){_.extend(this,Backbone.Events),this.id=Utils.genId("StatusBar"),_.extend(this,a),this.region=new Region(this.region),this.rendered=!1,this.autoRender&&this.render()}function LegendPanel(a){this.width=200,this.height=250,null!=a&&(null!=a.title&&(this.title=a.title),null!=a.targetId&&(this.targetId=a.targetId),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height))}function LegendWidget(a){this.width=300,this.height=300,this.title="Legend",null!=a&&(null!=a.title&&(this.title=a.title),null!=a.targetId&&(this.targetId=a.targetId),null!=a.width&&(this.width=a.width),null!=a.height&&(this.height=a.height)),this.legendPanel=new LegendPanel}function Track(a){if(this.width=200,this.height=200,this.dataAdapter,this.renderer,this.labelZoom=-1,this.resizable=!0,this.targetId,this.id,this.title,this.histogramZoom,this.transcriptZoom,this.height=100,this.visibleRange={start:0,end:100},this.fontFamily="Source Sans Pro",_.extend(this,a),this.pixelBase,this.svgCanvasWidth=5e5,this.pixelPosition=this.svgCanvasWidth/2,this.svgCanvasOffset,this.svgCanvasFeatures,this.status=void 0,this.histogram,this.histogramLogarithm,this.histogramMax,this.interval,this.zoom,this.svgCanvasLeftLimit,this.svgCanvasRightLimit,this.invalidZoomText,this.renderedArea={},"handlers"in this)for(eventName in this.handlers)this.on(eventName,this.handlers[eventName]);this.rendered=!1,this.autoRender&&this.render()}function FeatureTrack(a){Track.call(this,a),_.extend(this,Backbone.Events),this.defaultRenderer=this.renderer,this.histogramRenderer=new HistogramRenderer,this.chunksDisplayed={},_.extend(this,a)}function GeneTrack(a){Track.call(this,a),_.extend(this,Backbone.Events),this.defaultRenderer=this.renderer,this.histogramRenderer=new HistogramRenderer,this.chunksDisplayed={},_.extend(this,a),this.transcript=!0}function SequenceTrack(a){a.resizable=!1,Track.call(this,a),_.extend(this,Backbone.Events),this.defaultRenderer=this.renderer,this.chunksDisplayed={},_.extend(this,a)}function Renderer(){}function FeatureRenderer(a){if(Renderer.call(this,a),_.extend(this,Backbone.Events),_.isString(a)){var b=this.getDefaultConfig(a);_.extend(this,b)}else _.isObject(a)&&_.extend(this,a);this.on(this.handlers),this.fontFamily="Source Sans Pro"}function GeneRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),_.isString(a)?_.extend(this,this.getDefaultConfig(a)):_.isObject(a)&&_.extend(this,a),this.on(this.handlers),this.fontFamily="Source Sans Pro"}function HistogramRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),_.extend(this,a)}function SequenceRenderer(a){Renderer.call(this,a),_.extend(this,Backbone.Events),_.extend(this,a)}function FileWidget(a){this.targetId=null,this.id="FileWidget_"+Math.round(1e5*Math.random()),this.wum=!0,this.tags=[],this.args=a,null!=a&&(null!=a.targetId&&(this.targetId=a.targetId),null!=a.title&&(this.title=a.title,this.id=this.title+this.id),null!=a.wum&&(this.wum=a.wum),null!=a.tags&&(this.tags=a.tags),null!=a.viewer&&(this.viewer=a.viewer)),this.dataAdapter=null,this.onOk=new Event(this)}function BEDFileWidget(a){null==a&&(a=new Object),a.title="BED",a.tags=["bed"],FileWidget.prototype.constructor.call(this,a)}function GFFFileWidget(a){null==a&&(a=new Object),this.version="2",null!=a.version&&(this.version=a.version),a.title="GFF"+this.version,a.tags=["gff"],FileWidget.prototype.constructor.call(this,a)}function GTFFileWidget(a){null==a&&(a=new Object),a.title="GTF",a.tags=["gtf"],FileWidget.prototype.constructor.call(this,a)}function VCFFileWidget(a){null==a&&(a=new Object),a.title="VCF",a.tags=["vcf"],FileWidget.prototype.constructor.call(this,a)}function GenomeViewer(a){_.extend(this,Backbone.Events),this.id=Utils.genId("GenomeViewer"),this.version="Genome Viewer v1",this.targetId,this.drawNavigationBar=!0,this.drawKaryotypePanel=!0,this.drawChromosomePanel=!0,this.drawRegionOverviewPanel=!0,this.drawStatusBar=!0,this.border=!0,this.resizable=!0,this.sidePanel=!0,this.trackListTitle="Detailed information",this.trackPanelScrollWidth=18,this.availableSpecies={text:"Species",items:[{text:"Vertebrates",items:[{text:"Homo sapiens",assembly:"GRCh37.p10",region:{chromosome:"13",start:32889611,end:32889611},chromosomes:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","X","Y","MT"],url:"ftp://ftp.ensembl.org/pub/release-71/"},{text:"Mus musculus",assembly:"GRCm38.p1",region:{chromosome:"1",start:18422009,end:18422009},chromosomes:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","X","Y","MT"],url:"ftp://ftp.ensembl.org/pub/release-71/"}]}]},this.species=this.availableSpecies.items[0].items[0],this.zoom=100,_.extend(this,a),this.defaultRegion=new Region(this.region),this.width,this.height,this.sidePanelWidth=this.sidePanel?25:0,console.log(this.targetId),console.log(this.id),this.on(this.handlers),this.fullscreen=!1,this.resizing=!1,this.rendered=!1,this.autoRender&&this.render()}var Utils={characters:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",formatNumber:function(a){return a.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},formatText:function(a,b){return a=a.replace(new RegExp(b,"gi")," "),a=a.charAt(0).toUpperCase()+a.slice(1)},getPixelBaseByZoom:function(a){return a=Math.max(0,a),a=Math.min(100,a),10/Math.pow(2,20-a/5)},getZoomByPixelBase:function(a){return a=Math.max(0,a),a=Math.min(10,a),100-5*(Math.log(10/a)/Math.log(2))},getPixelBaseByRegion:function(a,b){return a/b.length()},calculatePixelBaseAndZoomByRegion:function(a){var b=this.regionLength(a.region),c=a.width/b,d=parseInt(a.width/10);if(d>b){c=this.getPixelBaseByZoom(a.zoom);var e=this.centerPosition(a.region),f=Math.ceil(d/2-1);a.region.start=Math.floor(e-f),a.region.end=Math.floor(e+f)}return{pixelBase:c,zoom:this.getZoomByPixelBase(c)}},setMinRegion:function(a,b){var c=a.length(),d=parseInt(b/this.getPixelBaseByZoom(100));if(d>c){var e=a.center(),f=Math.ceil(d/2-1);a.start=Math.floor(e-f),a.end=Math.floor(e+f)}},isString:function(a){return"string"==typeof a||a instanceof String},isFunction:function(a){return"function"==typeof a||a instanceof Function},parseDate:function(a){return a.substring(0,4)+" "+a.substring(4,6)+" "+a.substring(6,8)+", "+a.substring(8,10)+":"+a.substring(10,12)+":"+a.substring(12,14)},genId:function(a){return a=a||"",a=0==a.length?a:a+"-",a+this.randomString()},randomString:function(a){a=a||10;for(var b="",c=0;a>c;c++)b+=this.characters.charAt(this.getRandomInt(0,this.characters.length-1));return b},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},endsWithIgnoreCase:function(a,b){var c=new RegExp("^.*\\.("+b+")$","i");return c.test(a)},endsWith:function(a,b){var c=new RegExp("^.*\\.("+b+")$");return c.test(a)},randomColor:function(){for(var a="",b=0;6>b;b++)a+=[0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f"][Math.floor(16*Math.random())];return"#"+a},getSpeciesFromAvailable:function(a,b){for(var c=0;c<a.items.length;c++)for(var d=a.items[c].items,e=0;e<d.length;e++){var f=d[e];if(this.getSpeciesCode(f.text)==b)return f}},getSpeciesCode:function(a){var b=a.split(" ");return(b[0].charAt(0)+b[1]).toLowerCase()},test:function(){return this},cancelFullscreen:function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},launchFullScreen:function(a){a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()}};Utils.images={add:"data:image/gif;base64,R0lGODlhEAAQAIcAAD2GNUKNNkOPOESMO0WNPEmPP0iNQUmPQlOVTFWWTVCZQVeeRV6cVmGeWGSgVWSgV2aiWGejW2WrVWirU2uqWGqsW2yqWm61WG+1WG+1WXS3W3S3XHC4WXK5W3O6XHG+X3asZ3iuaHe8YHi0ZH+yany6ZH28Zn2+Z3m9bn25an25a3+5bUD/QHDBY3nBZHrGa3zDa37BaX7Hb4K1boO1boa3cYi4d4y7doq5eYm+eI2+e5O/f4HMdYbJeobJfIXNeYrCeY/CfYnIf4rPfZW/gozLgY7MhI7Sg5LFgJXAgpfHhZfMhZPNiJjLhpjMh5jMipvBl5vBmJTTipbTiZXUipbUi5fVi5nRi53YkqTOlKbPlqbQlqDZlaDZlqXbm6rUnavUnKbIoKfJoa/fpa/fprPZpbTZpbTaprLbqLPdqbXbqLfaqrTdqrXfrLbdrLjVr7jdr7vcr7rWsbfgr77itr3ktsTcuMXducXowMvmw87pydTrz9fu0tzx2ODy3P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAACwALAAAAAAQABAAAAi/AFkIHEiwoME7SWrMwCHH4MAdWfLs0QNnRQiHN+L4qeOlyxg8QCAU3LGmDxYmRqpQOTJHRYSBdpTw4SJFyJ8/P2DIaLNAjEAibsgU8YHiZgURHq4gaSCQBh0rPW5K/cMhxpcCAkmkGcJj6k0OJ8AMEGjjyZQXLSR85dBhiY4EAt9MYOPig4ivFzacEQBlIIgUaJByyIBBQxkLBwo6GKHGiYkSTcxQAODwgYIgW7TkCGDAocAwDAoQQBDFs2mCAQEAOw==",del:"data:image/gif;base64,R0lGODlhEAAQAIcAAED/QLpSNL9TOr5WOb5cQL9cQMFNM8RQNMBVPcBZP8xSPNBPPttWS9ddUcJnTMRkTMdrVM1gUc5iVMxmVclrVs1oWNZgVNZuZNtpZdxraN5ratxuadRxZd14c955dOZWTOZYTOZZTulZTelbT+ZWUOZaUuddWepcUOxfVOBlXO5mUuljW+pmXO5qXvBkVvNzXeNrYeNuY+FvcOJwZuJ7deR4ceJ5eeN4eeJ/feN/fOl7cOh6del/ePJ3Y/N5Y+qDfe6Efe+Gfu6KdfaCaPaEbPCFcPCDe/CMd/GOeviGcPiMdvCRf/eRfveTfvmSfvqTf/iUf9ymltynl+6Mge2Tju6Sj/SOgfqah/qdi/GclvGdluGpnvSgnvSinvWjn/qjkfupnPqrneGroOqwrOuzr/Ono/WmoferofarovWsofWvpfKtqvivpPS0qvi2qPm5r/q6rvC1tfC2tvjDvvzHuvnLxPnTzPzUzf3b1P3c2P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAAALAAAAAAQABAAAAi6AAEIHEiwoEE5ODRk8EDG4EAbVObYqdNmxgWHMtbkgfMFCxg6OiQUvFEGz5UlSKA4UeImRoWBcX7cwdJECJGbRHywWSBGYA41YY6gGEq0hxUeFARuePOkiJ6nUEW00IJAIIYzSYZAjcoiywCBHaYweSGirNkRRmg8EDiGARoXKsyKAFHCy4EoAznASIPihIgQH0h0sVCgYIQUZoKsMAGES4MADico2FGlSg0DBBwK3AIhgQAHUjSLJhgQADs=",enable:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKfSURBVDjLpZPrS1NhHMf9O3bOdmwDCWREIYKEUHsVJBI7mg3FvCxL09290jZj2EyLMnJexkgpLbPUanNOberU5taUMnHZUULMvelCtWF0sW/n7MVMEiN64AsPD8/n83uucQDi/id/DBT4Dolypw/qsz0pTMbj/WHpiDgsdSUyUmeiPt2+V7SrIM+bSss8ySGdR4abQQv6lrui6VxsRonrGCS9VEjSQ9E7CtiqdOZ4UuTqnBHO1X7YXl6Daa4yGq7vWO1D40wVDtj4kWQbn94myPGkCDPdSesczE2sCZShwl8CzcwZ6NiUs6n2nYX99T1cnKqA2EKui6+TwphA5k4yqMayopU5mANV3lNQTBdCMVUA9VQh3GuDMHiVcLCS3J4jSLhCGmKCjBEx0xlshjXYhApfMZRP5CyYD+UkG08+xt+4wLVQZA1tzxthm2tEfD3JxARH7QkbD1ZuozaggdZbxK5kAIsf5qGaKMTY2lAU/rH5HW3PLsEwUYy+YCcERmIjJpDcpzb6l7th9KtQ69fi09ePUej9l7cx2DJbD7UrG3r3afQHOyCo+V3QQzE35pvQvnAZukk5zL5qRL59jsKbPzdheXoBZc4saFhBS6AO7V4zqCpiawuptwQG+UAa7Ct3UT0hh9p9EnXT5Vh6t4C22QaUDh6HwnECOmcO7K+6kW49DKqS2DrEZCtfuI+9GrNHg4fMHVSO5kE7nAPVkAxKBxcOzsajpS4Yh4ohUPPWKTUh3PaQEptIOr6BiJjcZXCwktaAGfrRIpwblqOV3YKdhfXOIvBLeREWpnd8ynsaSJoyESFphwTtfjN6X1jRO2+FxWtCWksqBApeiFIR9K6fiTpPiigDoadqCEag5YUFKl6Yrciw0VOlhOivv/Ff8wtn0KzlebrUYwAAAABJRU5ErkJggg==",warning:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIsSURBVDjLpVNLSJQBEP7+h6uu62vLVAJDW1KQTMrINQ1vPQzq1GOpa9EppGOHLh0kCEKL7JBEhVCHihAsESyJiE4FWShGRmauu7KYiv6Pma+DGoFrBQ7MzGFmPr5vmDFIYj1mr1WYfrHPovA9VVOqbC7e/1rS9ZlrAVDYHig5WB0oPtBI0TNrUiC5yhP9jeF4X8NPcWfopoY48XT39PjjXeF0vWkZqOjd7LJYrmGasHPCCJbHwhS9/F8M4s8baid764Xi0Ilfp5voorpJfn2wwx/r3l77TwZUvR+qajXVn8PnvocYfXYH6k2ioOaCpaIdf11ivDcayyiMVudsOYqFb60gARJYHG9DbqQFmSVNjaO3K2NpAeK90ZCqtgcrjkP9aUCXp0moetDFEeRXnYCKXhm+uTW0CkBFu4JlxzZkFlbASz4CQGQVBFeEwZm8geyiMuRVntzsL3oXV+YMkvjRsydC1U+lhwZsWXgHb+oWVAEzIwvzyVlk5igsi7DymmHlHsFQR50rjl+981Jy1Fw6Gu0ObTtnU+cgs28AKgDiy+Awpj5OACBAhZ/qh2HOo6i+NeA73jUAML4/qWux8mt6NjW1w599CS9xb0mSEqQBEDAtwqALUmBaG5FV3oYPnTHMjAwetlWksyByaukxQg2wQ9FlccaK/OXA3/uAEUDp3rNIDQ1ctSk6kHh1/jRFoaL4M4snEMeD73gQx4M4PsT1IZ5AfYH68tZY7zv/ApRMY9mnuVMvAAAAAElFTkSuQmCC",edit:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB80lEQVR42o2T30tTURzArb8ioiAI6kHoZeF7CGE/IISCUDNCqAeL3rIWPfSwByskYUEJIhSChBhJFAiNqMVYPqRuc4tcW3NLt3C7u3d3d3c/+nS+0GRK0134cC6c8/ncc+7ltgFt6jqgcCg6duGQYq84deoBR6lU0iqVSq1arfI/1Dxut3u0Htke6BC5UChgmuYm+XyeXC5HOp1GIsnQNJHJi3x/7WJh/CSLT9r7Rd4jAVlgWRa2bSOjYBgGmqaRyWQwkq9Y8wyhLb0BI0VuaRrfo671xoDIwmakWCyi6zrr36bILt/HXp1l7cNDioEZqnEvgYmr1paAOgYy1u/l3NrqHNngPWpFL8XodTa+3CD8YoCvz/o078i5o1sC29FT78kG7lCzfJgrl7ESvejLThLPuxk8fbhP3KaBVFCdeX7on9yP9bOHfPAu0bEzmKkg4jQNpEKzhOduqW1/xIoNUEpcQlM7WXl6Cj39Q9Y0D4Q/TRJ662Tx3WOS/guYsV42Fm4THe/G/B2T97Jz4OVwJ+hxImPn8Tj381k91TfShfErIvLuAde1Y9g+N7Z/FL/rBDODR8gmgpTL5To7B3o69zF8pR3Pg7PMT90kn47LJ22kaeCPghapidP4Lxy3bduUiVZktdaQH7AxcFAiUm0Rhzji/gUhbp0s2Zf2xwAAAABJRU5ErkJggg==",info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJ1SURBVHjafJJdSJNhFMd/z3QzLWdZrnQmSA2DPqRCK4KuhIq66kLoAy/qoqCguqqL6JsgLwoKKhCMSIy6CDKKRFZZYYQRVhJl02nWmG5uc19u7/vuPV0lW7QOnIsHnt+P8z/Pg4gw26aZ0263uzEUCn2IxWJjXq/3JqBETLIZ8gkePLhfKyKy/Z5HHJf7xe0Jic/n65mejizPK0inUiSTKUSE0dHRhxf6JoSDb4Rjr4QDz0REJBgMtmczFrJKKYVSCjCYnPR/W1FuAwQSGjbHXAA0LRXKZnIm0NJpgAKvd/hSOBz2iIj0eiPS2vtDYsmUPH/uPg9YshklIrOyCb+/eUG5ve3au5C99W2AqGbgKivk8R4X1lSkv2pJZaNmmBQVWWeZnAiGoa+3KovdyBjsW2kn/SvK4Jcgtaf7cDqrGkQMUDkBcgXVS2tOHjp8dG2jOXT1yo5lYOpgFTB0wKTAOqdQMlqOoDD7EE8kREwGXr/oWTg4HjxONAklBayuKSUeT/hFTxrwnwlAMa8I1qyrP3H95RiQgUiC/RsWM+wZ6jIME0M38wtSM0mmojM4nc6mzr5xKDQgnWb/pmoedT29EU3pTMUS+QVKKerq6kqnI3EVHwmAplO8qBh7WTFnzpz9bOg6FovlfxGEixfOrfT6YxCOQ1rDUaIAG4EJ38+PAwNb/95Bzj8ITAZwLHbMT0yHw3N33YVwEnQDqss41VzPkaalX6Iz+m6Xy/Xp34JAAICR7187nLWuvbe6h9C0DA2uRTTVV9J++87OlpaWJxUVFf9+xj+1cfOWls6OO93Nq1zblMVm9flG3pcvXNPm90+E/777ewB+UIqdqtYXHAAAAABJRU5ErkJggg==",bucket:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90BCg4hBcbCoOMAAABsSURBVDjLY2RgYFBjYGCIZCAPLGeBam4g0wAGJgYKARMDA8NZCvSfZYQy6sk0oJEFiUNqODRQLQxGDYCAb2To/YZswEsyDHiJbMAHMgz4gO6F5aTkQpgXYElZkoGBgZeEbL2cgYHhMwMDw3MA93ARk+mSg4gAAAAASUVORK5CYII=",dir:"data:image/png;base64,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",r:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90CDRIvNbHTpbwAAADjSURBVDjLpZFBbsIwEEUfVRZYahcVK3qKXoauMFK5C91nkyUB+xC5BqeAA7SKq1B5ugl2EiC04UkjayzN17NnROTRWvvJFbTWL8CBHqbGWOlSlqVkWSbGWAGm3aGHZiMiAByPP6FOd1rP2W7NvhvSCvDe10E+VJPFQpPnm1ZIcsmgPgJVVZGmaejX63y/XL4/AV/JJYPTCeDcN7PZWyuwKAqA8wARqSsGKDVGqXGjV8H07AnRQPq21TK8+YSBAQMN4hb6Df7wB/5eA+4zmEyehxk451itPrhFksSxUeP+lf+z+wXwdayJk/mqtgAAAABJRU5ErkJggg==",box:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwRAVvTmTAAAAK/SURBVDjLpZM9bFxFGEXPNzPvZ+39sb2xHceREjDQBwlDCqqIiiotokAghYKEjvSkQkKJkEiB0lOkoAHaBAokFCQKUATIIOLIMbHWrHfX+7zvvZk3MzQODUgU3PJK5+g2F/5n5N/Kb66/1NNK3hAxr4HcFqVuvfju18V/Cu58sPmMVnJZ4K32Qr+t8za+KnCz4kCUuiGibm5euTv5h+CL958/nxj1XivVF+e6C9TVhPmFdbROgEhwNU1d4m09UaJuInLjhct3DgDUh5ee7j14PLxulLvYP/0seadPkub88Wib0eB3bDkmxgbRoFPpxeCuKvjsyQIzOyqImT7/y8Mh++NveW7jLFmrx6m1NlWxz6PHA7otQ7tloAmYJE9isOeeCJRtIrULLLUTjsqG7+//xs72z7jZgCTNONlVJKEiuobW0jqSaoiet19dFQATJcc2FSFEciNoLYwOHcPDASvdjM5cQntxlbR9gqacoFSK84VsnOrkH11Zdmp0FFXjobSeCFgXSDS0Eo11ge7yGXSaU092UUlCaEpC8FK4tDcu4rzZ2a/S+bWI94HSAgFigDQD24Cvp4gIOp0juBJvC2L07B1Uc/Mtg9k7sHMbywZrA3lLECV4AtaCpAp79CcmzXHlhOBrAJrGyNbOVBY7qTO1C9r5EKyPSttAiJEs01SuQStFkrdp6gKd5AzHjixVxCDxp+1paZRUxoc4Kp36bndYbS53U5WlCq0CMYIPMY7GI0mNpiqmGK0oK4jIveGkPgRqfTBt3A8Pqtvrq52HtglnGh9XIaKUkCQ6nj6RyWBsmdXCtFI/bu2Fq5c+3roGzIAgWokCDNACOhfOLb781Ip+vd+RC2dXWibROkxKvvp1z376yZe7d4HpMdz8/YVjiQYyoA30Ti6la2++0n/n83vTW/e3ix1gcgzXgPchBoC/AFu/UBF5InryAAAAAElFTkSuQmCC",bluebox:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwTE5pcivoAAALsSURBVDjLXZPPaxxlGMc/77wz+3N2k822tWsTIrQFe/BWEKxKCV5UohdFhJ60p6rgUfpP6C0K4kHx0ENEkV7aElHwUikhFVosRGoTm83+3pnZnXfed2beHtItIQ98+Z6+H57nga8AsNYKDkYcEofcHvKZEEJYcSTszPzqL3fmf3+w/+a51tytby9d6D0N5UecGeBZ8MPv/jh9fy/6dKzMpVPHmvWdbl/XCvKn5Wbl6+ufrNwGssMgYa2VgFj58sZr7VB/LqX3zlKrydJzTTzXxdqcx90hO+0Bk2l8Z74i1z6+cOba5VfOqGeAb3579M/NR53T40xwrDGHFALPEUjn4LoMi0ktwWTKXqCIqAVrbyycvHj2hHYBR+bO8Q/Ov0imEzZ2xrRDRalQwC9LLBalUgaJQy+tU6gvIBJbv3j2RA4IFxDdICFa9ulMCrz/UgOs5kEwpeh57I4Nt/dzsmLOYlEThgFjUePp33IHoD9SJAbuTVyudRweixJvnVtg3/i00wpLPiwQ0hkO6YYKawWj0UjONqAfKHwDkxTqqeW/RHA3hO2+Zqk05e5wTD9KmOqMKDEUqoLNzU0PyF2AQaBoaIhiw0h6TIwgUDCODb5NiWJNlKREyhAozXwOW1tbFSmlcAHbD2KaytCdGgyWglfEs4LeNKeaa4axYRgpwlgTTTXVDDqdTslaewAYh4kNlKUbZsTGonOwCYwm1vq5Ft1AMYgU08SQR5o0gziOcRxHuoCNtdl6uPHX6/Vmi3Yyh9I5IoEgMdkgT9x+qJhEGrdQo77cJMuy+4DJskwLa60DOCtf3HhZpfZKtVx+L3x+sfCv8CFxTINd72HfodQ4aQp5fP24/v/Hd4Nf/5RSJmma6lkXZn1wPvvq5qndsbhS9esf/Zy/UEtzxnURfn8+/fuHV7m353mecV1XSym1lDI72kaxvr5e3N7eruyP0tpG/e3LK/rW2mLNUb7vm3K5nFarVdNqtbJer2dXV1fzJ6cDpboAZRAGAAAAAElFTkSuQmCC",refresh:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAK8AAACvABQqw0mAAAAAd0SU1FB90CFA8bKScXIjIAAAJ1SURBVDjLlVJdSJNRGH7es+/7NlduWFLTKAskwjJqZYiBglJhLKguqou6EFkFIkLQH9IPBFI3BsouzMJupGYRajcqmeBFhWBU5oUgpZikrSnzZ9v3nW/ndKEbziXUAwfOOe/7Puc9z/MCq1DwMmB1NX/rzfCNnsc/gK08lPgnnT8Cs33BULg0HI4YKdkHX9DqKwKArXXv1bTMTFcoyruC89E8MxaDw659t6rKhIUwRBLdP2t2v/5bBwQA+5pH8ibnIj3BucgWIQRASw8RERTGYFUtsGmWYUXKmqmr7t4UAnal54GQ8lq8MBlyOU0CEnA67MiwqfvHbhZ+Smgg6o9eV2L8Nhk6wI2lZeggrpvE+TTjxgxxQ4IbmJsJYSa00JQiotnguacJ8zIZOmDosAnzTpowt8tGj0s0ejZqprnDKmPHSNebjHDkUPatt4cTTbZ+LsmO79XK52dZxTNp9/ovAEDnaM62lo8HHrd9SVfiOelVryrSq9vrEx0s8sW2tuEzDgDgT875bcIsjy6owwAwHhjnYT5bGTL29PiHyuwAMO873aL/Ct5PiPjwXe5vq7KJW2hdJxENMFInGCkhIblLj80WRoyxGxZmh1XJGlSIlV8s6A8kuVDXn+MF6JHC7GBkBSNlOSRgiihMsQhAgJGGNNU1atc2HPG6O8YSBABwt2/nGyFlGSCSB4UIBMuyoQKMFNiUjIApRH5t8YfpFOOrO/JrhZBVUiJLxq2ipIkY8Z36uivpC6txqb3YbhqhIingFlLmxmLSKyXAGAaYqh13aFjfcHJwfE2ClSitK9psc85PMVC3M999orX4Kcf/wuPb27VW7A+O2QVVA1M1CQAAAABJRU5ErkJggg==",newitem:"data:image/png;base64,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"},Utils.genBamVariants=function(a,b,c,d){for(var e=a.length,f=b/6,g="",h=0;e>h;h++){switch(a.charAt(h)){case"A":g+="M"+(2.5*f+c)+","+d+"l-"+2.5*f+","+6*f+"l"+f+",0"+"l"+.875*f+",-"+2*f+"l"+2.25*f+",0"+"l"+.875*f+","+2*f+"l"+f+",0"+"l-"+2.5*f+",-"+6*f+"l-"+.5*f+",0"+"l0,"+f+"l"+.75*f+","+2*f+"l-"+1.5*f+",0"+"l"+.75*f+",-"+2*f+"l0,-"+f+" ";
break;case"T":g+="M"+(.5*f+c)+","+d+"l0,"+f+"l"+2*f+",0"+"l0,"+5*f+"l"+f+",0"+"l0,-"+5*f+"l"+2*f+",0"+"l0,-"+f+" ";break;case"C":g+="M"+(5*f+c)+","+(0*f+d)+"l-"+2*f+",0"+"l-"+2*f+","+2*f+"l0,"+2*f+"l"+2*f+","+2*f+"l"+2*f+",0"+"l0,-"+f+"l-"+1.5*f+",0"+"l-"+1.5*f+",-"+1.5*f+"l0,-"+1*f+"l"+1.5*f+",-"+1.5*f+"l"+1.5*f+",0"+" ";break;case"G":g+="M"+(5*f+c)+","+(0*f+d)+"l-"+2*f+",0"+"l-"+2*f+","+2*f+"l0,"+2*f+"l"+2*f+","+2*f+"l"+2*f+",0"+"l0,-"+3*f+"l-"+1*f+",0"+"l0,"+2*f+"l-"+.5*f+",0"+"l-"+1.5*f+",-"+1.5*f+"l0,-"+1*f+"l"+1.5*f+",-"+1.5*f+"l"+1.5*f+",0"+" ";break;case"N":g+="M"+(.5*f+c)+","+(0*f+d)+"l0,"+6*f+"l"+f+",0"+"l0,-"+4.5*f+"l"+3*f+","+4.5*f+"l"+f+",0"+"l0,-"+6*f+"l-"+f+",0"+"l0,"+4.5*f+"l-"+3*f+",-"+4.5*f+" ";break;case"d":g+="M"+(0*f+c)+","+(2.5*f+d)+"l"+6*f+",0"+"l0,"+f+"l-"+6*f+",0"+"l0,-"+f+" ";break;default:g+="M0,0"}c+=b}return g},Event.prototype={addEventListener:function(a){return this._listeners.push(a)-1},removeEventListener:function(a){this._listeners.splice(a,1)},attach:function(a){this._listeners.push(a)},notify:function(a){for(var b=0;b<this._listeners.length;b++)this._listeners[b](this._sender,a)}};var SVG={create:function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)c.setAttribute(d,b[d]);return c},addChild:function(a,b,c,d){var e=document.createElementNS("http://www.w3.org/2000/svg",b);for(var f in c)e.setAttribute(f,c[f]);return this._insert(a,e,d)},addChildImage:function(a,b,c){var d=document.createElementNS("http://www.w3.org/2000/svg","image");for(var e in b)"xlink:href"==e&&d.setAttributeNS("http://www.w3.org/1999/xlink","href",b[e]),d.setAttribute(e,b[e]);return this._insert(a,d,c)},_insert:function(a,b,c){if(null==c)a.appendChild(b);else{var d=c+1;0==c&&(d=0);var e=a.childNodes[d];e?a.insertBefore(b,e):a.appendChild(b)}return b},init:function(a,b){return this.addChild(a,"svg",b)}};Ext.define("Ext.ux.Window",{extend:"Ext.window.Window",minimizable:!0,constrain:!0,collapsible:!0,initComponent:function(){this.callParent(),null!=this.taskbar&&(this.zIndexManager=this.taskbar.winMgr,this.iconCls="icon-grid",this.button=Ext.create("Ext.button.Button",{text:this.title,window:this,iconCls:this.iconCls,handler:function(){this.window.zIndexManager.front==this.window?this.window.minimize():this.window.show()}}),this.taskbar.add(this.button),this.contextMenu=new Ext.menu.Menu({items:[{text:"Close",window:this,iconCls:"tools-icons x-tool-close",handler:function(){this.window.close()}}]}),this.button.getEl().on("contextmenu",function(a){a.preventDefault(),this.contextMenu.showAt(a.getX(),a.getY()-10-25*this.contextMenu.items.length)},this),this.button.on("destroy",function(){this.window.close()}),this.on("destroy",function(){1!=this.button.destroying&&this.button.destroy()}),this.on("minimize",function(){this.hide()}),this.on("deactivate",function(){this.zIndexManager&&this.zIndexManager.front.ghostPanel&&this.zIndexManager.unregister(this.zIndexManager.front.ghostPanel),this.button.toggle(!1)}),this.on("activate",function(){this.button.toggle(!0)}))}}),CellBaseManager.prototype.getQuery=function(a,b){var c="?";-1!=b.indexOf("?")&&(c="&");var d="";for(var e in a)null!=a[e]&&(d+=e+"="+a[e].toString()+"&");return""!=d&&(d=c+d.substring(0,d.length-1)),d},InfoWidget.prototype.draw=function(a){console.log(a),this.query=a.query,this.feature=a.feature,this.adapter=a.adapter,this.panel=Ext.getCmp(this.title+" "+this.query),null==this.panel?(this.render(),this.panel.show(),this.getData()):this.panel.show()},InfoWidget.prototype.render=function(){this.panel=Ext.create("Ext.ux.Window",{title:this.title+" "+this.query,id:this.title+" "+this.query,minimizable:!0,constrain:!0,closable:!0,height:this.height,width:this.width,layout:{type:"hbox",align:"stretch"},items:[this.getTreePanel()],buttonAlign:"right",listeners:{scope:this,minimize:function(){this.panel.hide()},destroy:function(){delete this.panel}}})},InfoWidget.prototype.getTreePanel=function(){var a=this.getdataTypes();this.checkDataTypes(a);var b=Ext.create("Ext.data.TreeStore",{root:{expanded:!0,text:"Options",children:a}}),c=Ext.create("Ext.tree.Panel",{title:"Detailed information",bodyPadding:10,flex:1,border:!1,store:b,useArrows:!0,rootVisible:!1,listeners:{scope:this,itemclick:function(a,b){this.optionClick(b.data)}}});return c},InfoWidget.prototype.doGrid=function(a,b,c,d){for(var e=Ext.create("Ext.grid.feature.Grouping",{groupHeaderTpl:'{[values.name]} ({rows.length} Item{[values.rows.length > 1 ? "s" : ""]})',startCollapsed:!0}),f=[],g=0;g<b.length;g++)f.push({type:"string",dataIndex:b[g]});var f={ftype:"filters",local:!0,filters:f};Ext.define(c,{extend:"Ext.data.Model",fields:b});var h=Ext.create("Ext.data.Store",{groupField:d,model:c}),i=Ext.create("Ext.grid.Panel",{id:this.id+c,store:h,title:c,border:!1,cls:"panel-border-left",flex:3,features:[e,f],viewConfig:{enableTextSelection:!0},columns:a,bbar:["->",{text:"Clear Grouping",handler:function(){e.disable()}}]});return i},InfoWidget.prototype.checkDataTypes=function(a){for(var b=0;b<a.length;b++)null!=a[b].children?(a[b].iconCls="icon-box",a[b].expanded=!0,this.checkDataTypes(a[b].children)):(a[b].iconCls="icon-blue-box",a[b].leaf=!0)},InfoWidget.prototype.getdataTypes=function(){return[]},InfoWidget.prototype.optionClick=function(){},InfoWidget.prototype.getData=function(){},InfoWidget.prototype.getGeneTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {id} </span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Location/View?g={id}">Ensembl</a>',' &nbsp; <a target="_blank" href="http://wikipathways.org//index.php?query={externalName}&species='+this.wikipathwaysSpecie+'&title=Special%3ASearchPathways&doSearch=1">Wikipathways</a>',"</div><br>",'<div><span class="w75 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w75 infokey s90">Biotype: </span> {biotype}</div>','<div><span class="w75 infokey s90">Description: </span> <span><tpl if="description == &quot;&quot;">No description available</tpl>{description}</span></div>','<div><span class="w75 infokey s90">Source: </span> <span class="s110">{source}</span></div>','<div><span class="w75 infokey s90">Status: </span> {status}</div>')},InfoWidget.prototype.getTranscriptTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {id} </span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Transcript/Transcript?t={id}">Ensembl</a>',' &nbsp; <a target="_blank" href="http://wikipathways.org//index.php?query={externalName}&species='+this.wikipathwaysSpecie+'&title=Special%3ASearchPathways&doSearch=1">Wikipathways</a>',"</div><br>",'<div><span class="w100 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w100 infokey s90">Biotype: </span> {biotype}</div>','<div><span class="w100 infokey s90">Description: </span> <span><tpl if="description == &quot;&quot;">No description available</tpl>{description}</span></div>',"",'<div><span class="w100 infokey s90">CDS &nbsp; (start-end): </span> {genomicCodingStart}-{genomicCodingEnd} <span style="margin-left:50px" class="w100 infokey s90">CDNA (start-end): </span> {cdnaCodingStart}-{cdnaCodingEnd}</div>','<div><span class="w100 infokey s90">External DB: </span> {externalDb}</div>','<div><span class="w100 infokey s90">Status: </span> {status}</div><br>')},InfoWidget.prototype.getSnpTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{id}</span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Variation/Summary?v={id}">Ensembl</a>',"</div><br>",'<div><span class="w140 infokey s90">Location: </span> <span class="">{chromosome}:{start}-{end} </span><span style="margin-left:50px" class=" infokey s90">Strand: </span> {strand}</div>','<div><span class="w140 infokey s90">Source: </span> <span class="s110">{source}</span></div>','<div><span class="w140 infokey s90">Type: </span> <span class="s110">{type}</span></div>','<div><span class="w140 infokey s90">Map weight: </span> {mapWeight}</div>','<div><span class="w140 infokey s90">Allele string: </span> {alleleString}</div>','<div><span class="w140 infokey s90">Ancestral allele: </span> {ancestralAllele}</div>','<div><span class="w140 infokey s90">Display SO consequence type: </span> {displayConsequenceType}</div>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div>')},InfoWidget.prototype.getExonTemplate=function(){return new Ext.XTemplate('<span style="font-family:Oxygen" ><span class="panel-border-bottom"><span class="ssel s110">{id}</span></span></span>','<span><span style="margin-left:30px" class="infokey s90"> Location: </span> <span class="">{chromosome}:{start}-{end} </span></span>','<span><span style="margin-left:30px" class="infokey s90"> Strand: </span> {strand}</span>')},InfoWidget.prototype.getProteinTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{name}</span> &nbsp; <span class="emph s120"> {primaryAccession} </span></span></div>',"<br>",'<div><span class="w100 infokey s90">Full name: </span> <span class="">{fullName}</span></div>','<div><span class="w100 infokey s90">Gene name: </span> <span class="">{geneName}</span></div>','<div><span class="w100 infokey s90">Organism: </span> <span class="">{organism}</span></div>')},InfoWidget.prototype.getVCFVariantTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span><span class="panel-border-bottom"><span class="ssel s130">{chromosome}:{start}-{alt}</span> &nbsp; <span class="emph s120"> {label} </span></span></span></div><br>','<div><span class="w75 infokey s90">Alt: </span> {alt}</div>','<div><span class="w75 infokey s90">Ref: </span> {ref}</div>','<div><span class="w75 infokey s90">Quality: </span> {quality}</div>','<div><span class="w75 infokey s90">Format: </span> {format}</div>','<div><span class="w75 infokey s90">Samples: </span> {samples}</div>','<div><span class="w75 infokey s90">Info: <br></span> {info}</div>')},InfoWidget.prototype.getPWMTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{accession}</span> &nbsp; <span class="emph s120"> {tfName} </span></span></div>',"<br>",'<div><span class="w100 infokey s90">Type: </span> <span class="">{source}</span></div>','<div><span class="w100 infokey s90">Source: </span> <span class="">{type}</span></div>','<div><span class="w100 infokey s90">Description: </span> <span class="">{description}</span></div>','<div><span class="w100 infokey s90">Length: </span> <span class="">{length}</span></div>','<div><span class="w100 infokey s90">Frequencies: </span> <span class="">{[this.parseFrequencies(values.frequencies)]}</span></div>',{parseFrequencies:function(a){return"<div>"+a.replace(/,/gi,"<br>")+"</div>"}})},InfoWidget.prototype.getProteinXrefTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="w75 emph s100">{[values.source.toUpperCase()]}</span> &nbsp; <span class="emph w125 s100"> {[this.generateLink(values)]} <span class="info">&raquo;</span> </span></div>',{generateLink:function(a){if(null==a.source)return"";switch(a.source.toUpperCase()){case"GO":return'<a TARGET="_blank" href="http://amigo.geneontology.org/cgi-bin/amigo/term_details?term='+a.name+'">'+a.name+"</a>";case"REACTOME":return'<a TARGET="_blank" href="http://www.reactome.org/cgi-bin/eventbrowser_st_id?ST_ID='+a.name+'">'+a.name+"</a>";case"KEGG":return'<a TARGET="_blank" href="http://www.genome.jp/dbget-bin/www_bget?'+a.name+'">'+a.name+"</a>";case"INTACT":return'<a TARGET="_blank" href="http://www.ebi.ac.uk/intact/pages/interactions/interactions.xhtml?query='+a.name+'">'+a.name+"</a>";case"MINT":return'<a TARGET="_blank" href="http://mint.bio.uniroma2.it/mint/search/search.do?queryType=protein&interactorAc='+a.name+'">'+a.name+"</a>";case"DIP":return'<a TARGET="_blank" href="http://dip.doe-mbi.ucla.edu/dip/Browse.cgi?ID='+a.name+'">'+a.name+"</a>";case"STRING":return'<a TARGET="_blank" href="http://string-db.org/newstring_cgi/show_network_section.pl?identifier=P51587">'+a.name+"</a>";case"MIM":return'<a TARGET="_blank" href="http://www.omim.org/entry/'+a.name+'">'+a.name+"</a>";case"PHARMGKB":return'<a TARGET="_blank" href="http://www.pharmgkb.org/do/serve?objId='+a.name+'&objCls=Gene">'+a.name+"</a>";case"ORPHANET":return'<a TARGET="_blank" href="http://www.orpha.net/consor/cgi-bin/OC_Exp.php?lng=EN&Expert='+a.name+'">'+a.name+"</a>"}}})},InfoWidget.prototype.getSnpTranscriptTemplate=function(){return new Ext.XTemplate('<div style="font-family:Oxygen"><span class="panel-border-bottom"><span class="ssel s130">{[this.getStableId(values)]}</span></span>',' &nbsp; <a target="_blank" href="http://www.ensembl.org/'+this.ensemblSpecie+'/Transcript/Transcript?t={[this.getStableId(values)]}">Ensembl</a>',"</div><br>",'<div><span class="w140 infokey s90">CDS &nbsp; (start : end): </span> {cdsStart} : {cdsEnd} <span style="margin-left:50px" class="w100 infokey s90">cDNA (start : end): </span> {cdnaStart} : {cdnaEnd}</div>','<div><span class="w140 infokey s90">Translation (start : end): </span> {translationStart} : {translationEnd}</div>','<div><span class="w140 infokey s90">Peptide allele: </span> {peptideAlleleString}</div>','<div><span class="w140 infokey s90">Codon: </span> {codonAlleleString}</div>','<div><span class="w140 infokey s90">Polyphen prediction: </span> {polyphenPrediction}','<span style="margin-left:50px" class="w140 infokey s90">Polyphen score: </span> {polyphenScore}</div>','<div><span class="w140 infokey s90">Sift prediction: </span> {siftPrediction}','<span style="margin-left:50px" class="w140 infokey s90">Sift score: </span> {siftScore}</div>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div><br>',{getStableId:function(a){return""!=a.transcriptId?a.transcriptId:"Intergenic SNP"}})},InfoWidget.prototype.getConsequenceTypeTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{transcriptId}</span> &nbsp; </span></div><br>','<div><span class="w140 infokey s90">SO consequence types: </span> {consequenceTypes}</div><br>')},InfoWidget.prototype.getPhenotypeTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{phenotypeDescription}</span> &nbsp; <span class="emph s120"> {source} </span></span></div><br>','<div><span class="w150 infokey s90">PValue: </span>{PValue}</div>','<div><span class="w150 infokey s90">Assoc. gene name: </span>{associatedGeneName}</div>','<div><span class="w150 infokey s90">Assoc. variant risk allele: </span>{associatedVariantRiskAllele}</div>','<div><span class="w150 infokey s90">Phenotype description: </span>{phenotypeDescription}</div>','<div><span class="w150 infokey s90">Phenotype name: </span>{phenotypeName}</div>','<div><span class="w150 infokey s90">Risk allele freq in controls: </span>{riskAlleleFrequencyInControls}</div>','<div><span class="w150 infokey s90">Source: </span>{source}</div>','<div><span class="w150 infokey s90">Study name: </span>{studyName}</div>','<div><span class="w150 infokey s90">Study type: </span>{studyType}</div>','<div><span class="w150 infokey s90">Study URL: </span>{studyUrl}</div>','<div><span class="w150 infokey s90">Study description: </span>{studyDescription}</div>')},InfoWidget.prototype.getPopulationTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{population}</span> &nbsp; <span class="emph s120"> {source} </span></span></div><br>','<div><span class="w140 infokey s90">Ref allele:  </span>{refAllele} ({refAlleleFrequency})</div>','<div><span class="w140 infokey s90">Other allele:  </span>{otherAllele} ({otherAlleleFrequency})</div>','<div><span class="w140 infokey s90">Ref allele homozygote:  </span>{refAlleleHomozygote} ({refAlleleHomozygoteFrequency})</div>','<div><span class="w140 infokey s90">Allele heterozygote:  </span>{alleleHeterozygote} ({alleleHeterozygoteFrequency})</div>','<div><span class="w140 infokey s90">Other allele homozygote:  </span>{otherAlleleHomozygote} ({otherAlleleHeterozygoteFrequency})</div>','<div><span class="w140 infokey s90">Source:  </span>{source}</div>','<div><span class="w140 infokey s90">Population:  </span>{population}</div>')},InfoWidget.prototype.getVariantEffectTemplate=function(){return new Ext.XTemplate('<div><span class="panel-border-bottom"><span class="ssel s130">{consequenceTypeObo}</span> &nbsp; <span class="emph s120"> {featureBiotype} </span></span></div><br>')},GeneInfoWidget.prototype.draw=InfoWidget.prototype.draw,GeneInfoWidget.prototype.render=InfoWidget.prototype.render,GeneInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,GeneInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,GeneInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,GeneInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,GeneInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,GeneInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"},{text:"Xrefs"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Regulatory",children:[{text:"TFBS"}]},{text:"Protein",children:[{text:"Features"},{text:"3D structure"}]}]},GeneInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getGenePanel(this.data).show());break;case"Transcripts":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Xrefs":this.panel.add(this.getXrefGrid(this.data.transcripts,"Xref","transcript").show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.transcripts,"GO","transcript").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.transcripts,"Interpro","transcript").show());break;case"Reactome":this.panel.add(this.getXrefGrid(this.data.transcripts,"Reactome","transcript").show());break;case"TFBS":this.panel.add(this.getTfbsGrid(this.data.transcripts).show());break;case"miRNA targets":this.panel.add(this.getMirnaTargetGrid(this.data.mirnaTargets).show());break;case"Features":this.panel.add(this.getProteinFeaturesGrid(this.data.proteinFeatures).show());break;case"3D structure":this.panel.add(this.get3Dprotein(this.data.snps).show())}},GeneInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},GeneInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},GeneInfoWidget.prototype.getXrefGrid=function(a,b,c){for(var d=[],e=0;e<a.length;e++)for(var f=0;f<a[e].xrefs.length;f++){var g=a[e].xrefs[f];if("Xref"==b){var h=g.dbNameShort.toLowerCase();"go"!=h&&"interpro"!=h&&"reactome"!=h&&(g.transcript=a[e].id,d.push(g))}else g.dbNameShort.toLowerCase()==b.toLowerCase()&&(g.transcript=a[e].id,d.push(g))}if(d.length<=0)return this.notFoundPanel;if(null==this[b+"Grid"]){var c=c,i=b,j=["description","id","dbName","transcript"],k=[{header:"Display Id",dataIndex:"id",flex:1},{header:"DB name",dataIndex:"dbName",flex:1},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(k,j,i,c),this[b+"Grid"].store.loadData(d)}return this[b+"Grid"]},GeneInfoWidget.prototype.getTfbsGrid=function(a){if(a.length<=0)return this.notFoundPanel;var b="";if(null!=a[0].id){var c=[];b="transcriptId";for(var d=0;d<a.length;d++)if(transcript=a[d],null!=transcript.tfbs){for(var e=0;e<transcript.tfbs.length;e++)transcript.tfbs[e].transcriptId=transcript.id;c=c.concat(transcript.tfbs)}a=c}if(null==this.tfbsGrid){var b=b,f="TFBS",g=["chromosome","start","end","strand","tfName","relativeStart","relativeEnd","targetGeneName","score","sequence","transcriptId"],h=[{header:"Name",dataIndex:"tfName",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2.5},{header:"Relative (start-end)",xtype:"templatecolumn",tpl:"{relativeStart}-{relativeEnd}",flex:1.5},{header:"Target gene",dataIndex:"targetGeneName",flex:1},{header:"Score",dataIndex:"score",flex:1},{header:"Sequence",dataIndex:"sequence",flex:1}];this.tfbsGrid=this.doGrid(h,g,f,b),this.tfbsGrid.store.loadData(a)}return this.tfbsGrid},GeneInfoWidget.prototype.getMirnaTargetGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaTargetGrid){var b="",c="miRNA targets",d=["chromosome","start","end","strand","mirbaseId","score","experimentalMethod","source"],e=[{header:"Id",dataIndex:"mirbaseId",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Score",dataIndex:"score",flex:1},{header:"Exp. Method",dataIndex:"experimentalMethod",flex:1},{header:"source",dataIndex:"source",flex:1}];this.mirnaTargetGrid=this.doGrid(e,d,c,b),this.mirnaTargetGrid.store.loadData(a)}return this.mirnaTargetGrid},GeneInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneInfoWidget.prototype.get3Dprotein=function(){var a=this;if(null==this.p3dProtein){this.p3dProtein=Ext.create("Ext.tab.Panel",{title:"3D Protein Viewer",border:!1,cls:"panel-border-left",flex:3,autoScroll:!0});var b=[];$.ajax({url:(new CellBaseManager).host+"/v3/"+a.species+"/feature/id/"+this.query+"/xref?dbname=pdb&of=json",async:!1,success:function(c){if(""!=c){b=c[0];for(var d=0;d<b.length;d++){var e=b[d].id,f=Ext.create("Ext.panel.Panel",{title:e,bodyCls:"background-black",html:'<canvas class="ChemDoodleWebComponent" id="pdb_canvas_'+e+'" width="600" height="600" style="width: 600px; height: 600px; ">This browser does not support HTML5/Canvas.</canvas>',listeners:{afterrender:function(a){var b=a.title;ChemDoodle.default_backgroundColor="#000000";var c=new ChemDoodle.TransformCanvas3D("pdb_canvas_"+b,300,300);c.gl?(c.specs.set3DRepresentation("Ball and Stick"),c.specs.proteins_ribbonCartoonize=!0,c.handle=null,c.timeout=15,c.startAnimation=ChemDoodle._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=ChemDoodle._AnimatorCanvas.prototype.stopAnimation,c.isRunning=ChemDoodle._AnimatorCanvas.prototype.isRunning,c.dblclick=ChemDoodle.RotatorCanvas.prototype.dblclick,c.nextFrame=function(a){var b=[];mat4.identity(b);var c=a/1e3,d=Math.PI/15;mat4.rotate(b,d*c,[1,0,0]),mat4.rotate(b,d*c,[0,1,0]),mat4.rotate(b,d*c,[0,0,1]),mat4.multiply(this.rotationMatrix,b)},$.get("http://www.rcsb.org/pdb/files/"+b+".pdb",function(a){var b=ChemDoodle.readPDB(a);c.loadMolecule(b),c.startAnimation()})):(c.emptyMessage="Your browser does not support WebGL",c.displayMessage())}}});a.p3dProtein.add(f)}}else a.p3dProtein.setTitle("No proteins found")}})}return this.p3dProtein},GeneInfoWidget.prototype.getEnsembleId=function(){},GeneInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(c.result)}),b.get("feature","gene",this.query,"fullinfo")},GeneInfoWidget.prototype.dataReceived=function(a){this.data=a[0][0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},GeneOrangeInfoWidget.prototype.draw=InfoWidget.prototype.draw,GeneOrangeInfoWidget.prototype.render=InfoWidget.prototype.render,GeneOrangeInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,GeneOrangeInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,GeneOrangeInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,GeneOrangeInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,GeneOrangeInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,GeneOrangeInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"}]},{text:"Functional information",children:[{text:"GO"},{text:"KEGG"},{text:"Interpro"}]}]},GeneOrangeInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getGenePanel(this.data).show());break;case"Transcripts":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.go,"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.interpro,"Interpro").show());break;case"KEGG":this.panel.add(this.getXrefGrid(this.data.kegg,"KEGG").show())}},GeneOrangeInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},GeneOrangeInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},GeneOrangeInfoWidget.prototype.getXrefGrid=function(a,b){if(a.length<=0)return this.notFoundPanel;if(null==this[b+"Grid"]){var c="",d=b,e=["description","displayId"],f=[{header:"Display Id",dataIndex:"displayId",flex:1},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(f,e,d,c),this[b+"Grid"].store.loadData(a)}return this[b+"Grid"]},GeneOrangeInfoWidget.prototype.getTfbsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.tfbsGrid){var b="",c="TFBS",d=["chromosome","start","end","strand","tfName","relativeStart","relativeEnd","targetGeneName","score","sequence"],e=[{header:"Name",dataIndex:"tfName",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2.5},{header:"Relative (start-end)",xtype:"templatecolumn",tpl:"{relativeStart}-{relativeEnd}",flex:1.5},{header:"Target gene",dataIndex:"targetGeneName",flex:1},{header:"Score",dataIndex:"score",flex:1},{header:"Sequence",dataIndex:"sequence",flex:1}];this.tfbsGrid=this.doGrid(e,d,c,b),this.tfbsGrid.store.loadData(a)}return this.tfbsGrid},GeneOrangeInfoWidget.prototype.getMirnaTargetGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaTargetGrid){var b="",c="miRNA targets",d=["chromosome","start","end","strand","mirbaseId","score","experimentalMethod","source"],e=[{header:"Id",dataIndex:"mirbaseId",flex:1},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Score",dataIndex:"score",flex:1},{header:"Exp. Method",dataIndex:"experimentalMethod",flex:1},{header:"source",dataIndex:"source",flex:1}];this.mirnaTargetGrid=this.doGrid(e,d,c,b),this.mirnaTargetGrid.store.loadData(a)}return this.mirnaTargetGrid},GeneOrangeInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneOrangeInfoWidget.prototype.getProteinFeaturesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.proteinFeaturesGrid){var b="",c="Protein features",d=["identifier","start","end","original","type","description"],e=[{header:"Identifier",dataIndex:"identifier",flex:1},{header:"Location: (start-end)",xtype:"templatecolumn",tpl:"{start}-{end}",flex:1.2},{header:"Original",dataIndex:"original",flex:1},{header:"Type",dataIndex:"type",flex:1},{header:"Description",dataIndex:"description",flex:1.5}];this.proteinFeaturesGrid=this.doGrid(e,d,c,b),this.proteinFeaturesGrid.store.loadData(a)}return this.proteinFeaturesGrid},GeneOrangeInfoWidget.prototype.get3Dprotein=function(){var a=this;if(null==this.p3dProtein){this.p3dProtein=Ext.create("Ext.tab.Panel",{title:"3D Protein Viewer",border:!1,cls:"panel-border-left",flex:3,autoScroll:!0});var b=[];$.ajax({url:"http://ws.bioinfo.cipf.es/cellbase/rest/v1/hsa/feature/id/"+this.query+"/xref?dbname=pdb",async:!1,success:function(c){if(""!=c){b=c.trim().split("\n");for(var d=0;d<b.length;d++){var e=b[d].trim(),f=Ext.create("Ext.panel.Panel",{title:e,bodyCls:"background-black",html:'<canvas class="ChemDoodleWebComponent" id="pdb_canvas_'+e+'" width="600" height="600" style="width: 600px; height: 600px; ">This browser does not support HTML5/Canvas.</canvas>',listeners:{afterrender:function(a){var b=a.title;ChemDoodle.default_backgroundColor="#000000";var c=new ChemDoodle.TransformCanvas3D("pdb_canvas_"+b,300,300);c.gl?(c.specs.set3DRepresentation("Ball and Stick"),c.specs.proteins_ribbonCartoonize=!0,c.handle=null,c.timeout=15,c.startAnimation=ChemDoodle._AnimatorCanvas.prototype.startAnimation,c.stopAnimation=ChemDoodle._AnimatorCanvas.prototype.stopAnimation,c.isRunning=ChemDoodle._AnimatorCanvas.prototype.isRunning,c.dblclick=ChemDoodle.RotatorCanvas.prototype.dblclick,c.nextFrame=function(a){var b=[];
mat4.identity(b);var c=a/1e3,d=Math.PI/15;mat4.rotate(b,d*c,[1,0,0]),mat4.rotate(b,d*c,[0,1,0]),mat4.rotate(b,d*c,[0,0,1]),mat4.multiply(this.rotationMatrix,b)},$.get("http://www.rcsb.org/pdb/files/"+b+".pdb",function(a){var b=ChemDoodle.readPDB(a);c.loadMolecule(b),c.startAnimation()})):(c.emptyMessage="Your browser does not support WebGL",c.displayMessage())}}});a.p3dProtein.add(f)}}else a.p3dProtein.setTitle("No proteins found")}})}return this.p3dProtein},GeneOrangeInfoWidget.prototype.getEnsembleId=function(){},GeneOrangeInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(JSON.parse(c.result))}),b.get("feature","gene",this.query,"fullinfo")},GeneOrangeInfoWidget.prototype.dataReceived=function(a){this.data=a[0][0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},MirnaInfoWidget.prototype.draw=InfoWidget.prototype.draw,MirnaInfoWidget.prototype.render=InfoWidget.prototype.render,MirnaInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,MirnaInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,MirnaInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,MirnaInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,MirnaInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,MirnaInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Information",children:[{text:"miRNA"},{text:"Transcript"},{text:"Gene"}]},{text:"Regulatory",children:[{text:"Target Genes"}]},{text:"Disease",children:[{text:"Related Diseases"}]}]},MirnaInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"miRNA":this.panel.add(this.getMirnaPanel(this.data.mirna).show());break;case"Transcript":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.genes).show());break;case"Target Genes":this.panel.add(this.getTargetGenesGrid(this.data.targetGenes).show());break;case"Related Diseases":this.panel.add(this.getMirnaDiseasesGrid(this.data.mirnaDiseases).show())}},MirnaInfoWidget.prototype.getMirnaPanel=function(a){if(a.mirnaMature.length<=0&&a.mirnaGenes.length<=0)return this.notFoundPanel;if(null==this.mirnaPanel){for(var b=this.getMirnaMatureTemplate(),c=this.getMirnaGeneTemplate(),d=[],e=0;e<a.mirnaMature.length;e++){var f=Ext.create("Ext.container.Container",{padding:5,data:a.mirnaMature[e],tpl:b});d.push(f)}for(var e=0;e<a.mirnaGenes.length;e++){var g=Ext.create("Ext.container.Container",{padding:5,data:a.mirnaGenes[e],tpl:c});d.push(g)}this.mirnaPanel=Ext.create("Ext.panel.Panel",{title:"miRNA",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:d})}return this.mirnaPanel},MirnaInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},MirnaInfoWidget.prototype.getGenePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.genePanel){for(var b=this.getGeneTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.genePanel=Ext.create("Ext.panel.Panel",{title:"Genes ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.genePanel},MirnaInfoWidget.prototype.getTargetGenesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.targetGenesGrid){var b="",c="targetGenes",d=["externalName","stableId","biotype","chromosome","start","end","strand","description"],e=[{header:"Name",dataIndex:"externalName",flex:1},{header:"Stable Id",dataIndex:"stableId",flex:2},{header:"Biotype",dataIndex:"biotype",flex:1.5},{header:"Chr",dataIndex:"chromosome",flex:.5},{header:"Start",dataIndex:"start",flex:1},{header:"End",dataIndex:"end",flex:1},{header:"Strand",dataIndex:"strand",flex:.5},{header:"Description",dataIndex:"description",flex:1}];this.targetGenesGrid=this.doGrid(e,d,c,b),this.targetGenesGrid.store.loadData(a)}return this.targetGenesGrid},MirnaInfoWidget.prototype.getMirnaDiseasesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mirnaDiseasesGrid){var b="",c="mirnaDiseases",d=["mirnaDiseaseId","mirnaGene","mirbaseId","diseaseName","pubmedId","description"],e=[{header:"Name",dataIndex:"mirbaseId",flex:1.5},{header:"Disease",dataIndex:"diseaseName",flex:1.5},{header:"PubMed id",dataIndex:"pubmedId",flex:1},{header:"Description",dataIndex:"description",flex:3}];this.mirnaDiseasesGrid=this.doGrid(e,d,c,b),this.mirnaDiseasesGrid.store.loadData(a)}return this.mirnaDiseasesGrid},MirnaInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseDataAdapter(this.species);b.successed.addEventListener(function(){a.dataReceived(b.toJSON())}),b.fill("regulatory","mirna_mature",this.feature.getName(),"fullinfo"),console.log(this.feature.getName())},MirnaInfoWidget.prototype.dataReceived=function(a){var b=JSON.parse(a);this.data=b[0],console.log(this.data),this.optionClick({text:"miRNA",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},MirnaInfoWidget.prototype.getMirnaMatureTemplate=function(){return new Ext.XTemplate('<p><span class="panel-border-bottom"><span class="ssel s130">miRNA mature</span> &nbsp; <span class="emph s120"> {mirbaseId} </span></span></p>',"<br>",'<p><span class="w140 dis s90">miRBase Accession: </span> <span class="">{mirbaseAcc}</span></p>','<span class="w140 dis s90">Sequence: </span> <span class="">{sequence}</span>')},MirnaInfoWidget.prototype.getMirnaGeneTemplate=function(){return new Ext.XTemplate('<p><span class="panel-border-bottom"><span class="ssel s130">miRNA gene</span> &nbsp; <span class="emph s120"> {mirbaseId} </span></span></p>',"<br>",'<p><span class="w140 dis s90">miRBase Accession: </span> <span class="">{mirbaseAcc}</span></p>','<span class="w140 dis s90">Sequence: </span> <span class="">{sequence}</span>','<p><span class="w140 dis s90">Status: </span> <span class="">{status}</span></p>')},ProteinInfoWidget.prototype.draw=InfoWidget.prototype.draw,ProteinInfoWidget.prototype.render=InfoWidget.prototype.render,ProteinInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,ProteinInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,ProteinInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,ProteinInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Sumary",children:[{text:"Long"},{text:"Seq"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Interactions"},{text:"Variations"}]},ProteinInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"":break;case"":break;case"Reactome":break;case"Interpro":break;case"":break;case"":break;case"":}},SnpInfoWidget.prototype.draw=InfoWidget.prototype.draw,SnpInfoWidget.prototype.render=InfoWidget.prototype.render,SnpInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,SnpInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,SnpInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,SnpInfoWidget.prototype.getSnpTemplate=InfoWidget.prototype.getSnpTemplate,SnpInfoWidget.prototype.getSnpTranscriptTemplate=InfoWidget.prototype.getSnpTranscriptTemplate,SnpInfoWidget.prototype.getConsequenceTypeTemplate=InfoWidget.prototype.getConsequenceTypeTemplate,SnpInfoWidget.prototype.getPhenotypeTemplate=InfoWidget.prototype.getPhenotypeTemplate,SnpInfoWidget.prototype.getPopulationTemplate=InfoWidget.prototype.getPopulationTemplate,SnpInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Transcripts"}]},{text:"Consequence type"},{text:"Annotated phenotype"}]},SnpInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Transcripts":this.panel.add(this.getSnpTranscriptPanel(this.data.transcriptVariations).show());break;case"Consequence type":this.panel.add(this.getConsequenceTypePanel(this.data.transcriptVariations).show());break;case"Annotated phenotype":this.panel.add(this.getPhenotypePanel(this.data.phenotype).show())}},SnpInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getSnpTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.infoPanel},SnpInfoWidget.prototype.getSnpTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpTranscriptGrid){for(var b=this.getSnpTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.snpTranscriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.snpTranscriptGrid},SnpInfoWidget.prototype.getConsequenceTypePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.consequencePanel){for(var b=this.getConsequenceTypeTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.consequencePanel=Ext.create("Ext.panel.Panel",{title:"Consequence type ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.consequencePanel},SnpInfoWidget.prototype.getPhenotypePanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.phenotypePanel){for(var b=this.getPhenotypeTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.phenotypePanel=Ext.create("Ext.panel.Panel",{title:"Phenotype ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.phenotypePanel},SnpInfoWidget.prototype.getPopulationPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.populationPanel){for(var b=this.getPopulationTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.populationPanel=Ext.create("Ext.panel.Panel",{title:"Population ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.populationPanel},SnpInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(c.result)}),b.get("feature","snp",this.query,"info")},SnpInfoWidget.prototype.dataReceived=function(a){this.data=a[0][0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TFInfoWidget.prototype.draw=InfoWidget.prototype.draw,TFInfoWidget.prototype.render=InfoWidget.prototype.render,TFInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TFInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TFInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TFInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TFInfoWidget.prototype.getProteinTemplate=InfoWidget.prototype.getProteinTemplate,TFInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TFInfoWidget.prototype.getPWMTemplate=InfoWidget.prototype.getPWMTemplate,TFInfoWidget.prototype.getProteinXrefTemplate=InfoWidget.prototype.getProteinXrefTemplate,TFInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Information",children:[{text:"Protein"},{text:"Transcript"},{text:"Gene"}]},{text:"Regulatory",children:[{text:"PWM"},{text:"Target Genes"}]},{text:"Protein Features",children:[{text:"Protein profile"},{text:"Mutation sites"},{text:"Pathways"},{text:"Protein interactions"},{text:"Related Diseases"}]}]},TFInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Protein":this.panel.add(this.getProteinPanel(this.data.proteins).show());break;case"Transcript":this.panel.add(this.getTranscriptPanel(this.data.transcripts).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"PWM":this.panel.add(this.getPWMPanel(this.data.pwm).show());break;case"Target Genes":this.panel.add(this.getTargetGenesGrid(this.data.targetGenes).show());break;case"Protein profile":this.panel.add(this.getProteinFeatureGrid(this.data.protein_feature,"Protein profile").show());break;case"Mutation sites":this.panel.add(this.getProteinFeatureGrid(this.data.protein_feature,"Mutation sites").show());break;case"Pathways":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Pathway").show());break;case"Protein interactions":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Interaction").show());break;case"Related Diseases":this.panel.add(this.getProteinXrefPanel(this.data.protein_xref,"Disease").show())}},TFInfoWidget.prototype.getProteinPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.proteinPanel){var b=this.getProteinTemplate();this.proteinPanel=Ext.create("Ext.panel.Panel",{title:"Protein",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a[0],tpl:b})}return this.proteinPanel},TFInfoWidget.prototype.getTranscriptPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.transcriptGrid){for(var b=this.getTranscriptTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.transcriptGrid=Ext.create("Ext.panel.Panel",{title:"Transcripts ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.transcriptGrid},TFInfoWidget.prototype.getGenePanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.genePanel){var b=this.getGeneTemplate();this.genePanel=Ext.create("Ext.panel.Panel",{title:"Gene information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.genePanel},TFInfoWidget.prototype.getPWMPanel=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.pwmPanel){for(var b=this.getPWMTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.pwmPanel=Ext.create("Ext.panel.Panel",{title:"PWM ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.pwmPanel},TFInfoWidget.prototype.getTargetGenesGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.targetGenesGrid){var b="",c="targetGenes",d=["externalName","stableId","biotype","chromosome","start","end","strand","description"],e=[{header:"Name",dataIndex:"externalName",flex:1},{header:"Stable Id",dataIndex:"stableId",flex:2},{header:"Biotype",dataIndex:"biotype",flex:1.5},{header:"Chr",dataIndex:"chromosome",flex:.5},{header:"Start",dataIndex:"start",flex:1},{header:"End",dataIndex:"end",flex:1},{header:"Strand",dataIndex:"strand",flex:.5},{header:"Description",dataIndex:"description",flex:1}];this.targetGenesGrid=this.doGrid(e,d,c,b),this.targetGenesGrid.store.loadData(a)}return this.targetGenesGrid},TFInfoWidget.prototype.getProteinFeatureGrid=function(a,b){if(null==this[b+"Grid"]){for(var c=new Array,d=new Array,e=0;e<a.length;e++)"mutagenesis site"==a[e].type?d.push(a[e]):c.push(a[e]);if(null!=b){if("Protein profile"==b)var a=c;if("Mutation sites"==b)var a=d}if(a.length<=0)return this.notFoundPanel;var f="",g=b,h=["type","start","end","original","variation","description"],i=[{header:"Type",dataIndex:"type",flex:1.5},{header:"Start",dataIndex:"start",flex:.5},{header:"End",dataIndex:"end",flex:.5},{header:"Original",dataIndex:"original",flex:.7},{header:"Variation",dataIndex:"variation",flex:.7},{header:"Description",dataIndex:"description",flex:3}];this[b+"Grid"]=this.doGrid(i,h,g,f),this[b+"Grid"].store.loadData(a)}return this[b+"Grid"]},TFInfoWidget.prototype.getProteinXrefPanel=function(a,b){if(a.length<=0)return this.notFoundPanel;if(null==this[b+"panel"]){for(var c=this.getProteinXrefTemplate(),d=new Array,e=new Array,f=new Array,g=0;g<a.length;g++){var h=a[g].source;("Go"==h||"Reactome"==h||"KEGG"==h)&&d.push(a[g]),("IntAct"==h||"MINT"==h||"DIP"==h||"String"==h)&&e.push(a[g]),("MIN"==h||"PharmGKB"==h||"Orphanet"==h)&&f.push(a[g])}if(null!=b)switch(b){case"Pathway":a=d;break;case"Interaction":a=e;break;case"Disease":a=f}for(var i=[],g=0;g<a.length;g++){var j=Ext.create("Ext.panel.Panel",{border:!1,bodyPadding:5,data:a[g],tpl:c});i.push(j)}this[b+"panel"]=Ext.create("Ext.panel.Panel",{title:b+" ("+g+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:i})}return this[b+"panel"]},TFInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseDataAdapter(this.species);b.successed.addEventListener(function(){a.dataReceived(b.toJSON())}),b.fill("regulatory","tf",this.feature.getName(),"fullinfo"),console.log(this.feature.getName())},TFInfoWidget.prototype.dataReceived=function(a){var b=JSON.parse(a);this.data=b[0],console.log(this.data),this.optionClick({text:"Protein",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TranscriptInfoWidget.prototype.draw=InfoWidget.prototype.draw,TranscriptInfoWidget.prototype.render=InfoWidget.prototype.render,TranscriptInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TranscriptInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TranscriptInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TranscriptInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TranscriptInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TranscriptInfoWidget.prototype.getExonTemplate=InfoWidget.prototype.getExonTemplate,TranscriptInfoWidget.prototype.get3Dprotein=GeneInfoWidget.prototype.get3Dprotein,TranscriptInfoWidget.prototype.getGenePanel=GeneInfoWidget.prototype.getGenePanel,TranscriptInfoWidget.prototype.getXrefGrid=GeneInfoWidget.prototype.getXrefGrid,TranscriptInfoWidget.prototype.getTfbsGrid=GeneInfoWidget.prototype.getTfbsGrid,TranscriptInfoWidget.prototype.getMirnaTargetGrid=GeneInfoWidget.prototype.getMirnaTargetGrid,TranscriptInfoWidget.prototype.getProteinFeaturesGrid=GeneInfoWidget.prototype.getProteinFeaturesGrid,TranscriptInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Gene"},{text:"Exons"},{text:"Xrefs"}]},{text:"Functional information",children:[{text:"GO"},{text:"Reactome"},{text:"Interpro"}]},{text:"Variation",children:[{text:"SNPs"},{text:"Mutations"}]},{text:"Regulatory",children:[{text:"TFBS"},{text:"miRNA targets"}]},{text:"Protein",children:[{text:"Features"},{text:"3D structure"}]}]},TranscriptInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"Exons":this.panel.add(this.getExonsGrid(this.data.exons).show());break;case"Xrefs":this.panel.add(this.getXrefGrid([this.data],"Xref","dbName").show());break;case"GO":this.panel.add(this.getXrefGrid([this.data],"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid([this.data],"Interpro").show());break;case"Reactome":this.panel.add(this.getXrefGrid([this.data],"Reactome").show());break;case"SNPs":this.panel.add(this.getSnpsGrid(this.data.snps).show());break;case"Mutations":this.panel.add(this.getMutationsGrid(this.data.mutations).show());break;case"TFBS":this.panel.add(this.getTfbsGrid(this.data.tfbs).show());break;case"miRNA targets":this.panel.add(this.getMirnaTargetGrid(this.data.mirnaTargets).show());break;case"Features":this.panel.add(this.getProteinFeaturesGrid(this.data.proteinFeatures).show());break;case"3D structure":this.panel.add(this.get3Dprotein(this.data.snps).show())}},TranscriptInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getTranscriptTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,autoScroll:!0,data:a,tpl:b})}return this.infoPanel},TranscriptInfoWidget.prototype.getExonsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.exonsGrid){for(var b=this.getExonTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.exonsGrid=Ext.create("Ext.panel.Panel",{title:"Exons ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.exonsGrid},TranscriptInfoWidget.prototype.getSnpsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpsGrid){var b="",c="SNPs",d=["chromosome","start","end","name","strand","alleleString","displaySoConsequence"],e=[{header:"Name",dataIndex:"name",flex:2},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Alleles",dataIndex:"alleleString",flex:.7},{header:"Most severe SO term",dataIndex:"displaySoConsequence",flex:2}];this.snpsGrid=this.doGrid(e,d,c,b),this.snpsGrid.store.loadData(a)}return this.snpsGrid},TranscriptInfoWidget.prototype.getMutationsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mutationsGrid){var b="",c="Mutations",d=["chromosome","start","end","mutationAa","mutationCds","primaryHistology","source"],e=[{header:"Mutation AA",dataIndex:"mutationAa",flex:1},{header:"Mutation CDS",dataIndex:"mutationCds",flex:1.5},{header:"Location: chr:start-end",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end}",flex:1.7},{header:"Primary histology",dataIndex:"primaryHistology",flex:1},{header:"Source",dataIndex:"source",flex:1}];this.mutationsGrid=this.doGrid(e,d,c,b),this.mutationsGrid.store.loadData(a)}return this.mutationsGrid},TranscriptInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(c.result)}),b.get("feature","transcript",this.query,"fullinfo")},TranscriptInfoWidget.prototype.dataReceived=function(a){this.data=a[0][0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},TranscriptOrangeInfoWidget.prototype.draw=InfoWidget.prototype.draw,TranscriptOrangeInfoWidget.prototype.render=InfoWidget.prototype.render,TranscriptOrangeInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,TranscriptOrangeInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,TranscriptOrangeInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,TranscriptOrangeInfoWidget.prototype.getGeneTemplate=InfoWidget.prototype.getGeneTemplate,TranscriptOrangeInfoWidget.prototype.getTranscriptTemplate=InfoWidget.prototype.getTranscriptTemplate,TranscriptOrangeInfoWidget.prototype.getExonTemplate=InfoWidget.prototype.getExonTemplate,TranscriptOrangeInfoWidget.prototype.getGenePanel=GeneOrangeInfoWidget.prototype.getGenePanel,TranscriptOrangeInfoWidget.prototype.getXrefGrid=GeneOrangeInfoWidget.prototype.getXrefGrid,TranscriptOrangeInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Gene"},{text:"Exons"}]},{text:"Functional information",children:[{text:"GO"},{text:"KEGG"},{text:"Interpro"}]}]},TranscriptOrangeInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data).show());break;case"Gene":this.panel.add(this.getGenePanel(this.data.gene).show());break;case"Exons":this.panel.add(this.getExonsGrid(this.data.exons).show());break;case"GO":this.panel.add(this.getXrefGrid(this.data.go,"GO").show());break;case"Interpro":this.panel.add(this.getXrefGrid(this.data.interpro,"Interpro").show());break;case"KEGG":this.panel.add(this.getXrefGrid(this.data.kegg,"KEGG").show())}},TranscriptOrangeInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getTranscriptTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,autoScroll:!0,data:a,tpl:b})}return this.infoPanel},TranscriptOrangeInfoWidget.prototype.getExonsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.exonsGrid){for(var b=this.getExonTemplate(),c=[],d=0;d<a.length;d++){var e=Ext.create("Ext.container.Container",{padding:5,data:a[d],tpl:b});c.push(e)}this.exonsGrid=Ext.create("Ext.panel.Panel",{title:"Exons ("+d+")",border:!1,cls:"panel-border-left",flex:3,bodyPadding:5,autoScroll:!0,items:c})}return this.exonsGrid},TranscriptOrangeInfoWidget.prototype.getSnpsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.snpsGrid){var b="",c="SNPs",d=["chromosome","start","end","name","strand","alleleString","displaySoConsequence"],e=[{header:"Name",dataIndex:"name",flex:2},{header:"Location: chr:start-end (strand)",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end} ({strand})",flex:2},{header:"Alleles",dataIndex:"alleleString",flex:.7},{header:"Most severe SO term",dataIndex:"displaySoConsequence",flex:2}];this.snpsGrid=this.doGrid(e,d,c,b),this.snpsGrid.store.loadData(a)}return this.snpsGrid},TranscriptOrangeInfoWidget.prototype.getMutationsGrid=function(a){if(a.length<=0)return this.notFoundPanel;if(null==this.mutationsGrid){var b="",c="Mutations",d=["chromosome","start","end","mutationAa","mutationCds","primaryHistology","source"],e=[{header:"Mutation AA",dataIndex:"mutationAa",flex:1},{header:"Mutation CDS",dataIndex:"mutationCds",flex:1.5},{header:"Location: chr:start-end",xtype:"templatecolumn",tpl:"{chromosome}:{start}-{end}",flex:1.7},{header:"Primary histology",dataIndex:"primaryHistology",flex:1},{header:"Source",dataIndex:"source",flex:1}];this.mutationsGrid=this.doGrid(e,d,c,b),this.mutationsGrid.store.loadData(a)}return this.mutationsGrid},TranscriptOrangeInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(JSON.parse(c.result))}),b.get("feature","transcript",this.query,"fullinfo")},TranscriptOrangeInfoWidget.prototype.dataReceived=function(a){this.data=a[0],console.log(this.data),this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},VCFVariantInfoWidget.prototype.draw=InfoWidget.prototype.draw,VCFVariantInfoWidget.prototype.render=InfoWidget.prototype.render,VCFVariantInfoWidget.prototype.getTreePanel=InfoWidget.prototype.getTreePanel,VCFVariantInfoWidget.prototype.checkDataTypes=InfoWidget.prototype.checkDataTypes,VCFVariantInfoWidget.prototype.doGrid=InfoWidget.prototype.doGrid,VCFVariantInfoWidget.prototype.getVCFVariantTemplate=InfoWidget.prototype.getVCFVariantTemplate,VCFVariantInfoWidget.prototype.getVariantEffectTemplate=InfoWidget.prototype.getVariantEffectTemplate,VCFVariantInfoWidget.prototype.getdataTypes=function(){return dataTypes=[{text:"Genomic",children:[{text:"Information"},{text:"Variant effect"},{text:"Header"},{text:"Samples"}]}]},VCFVariantInfoWidget.prototype.optionClick=function(a){if(a.leaf)switch(null!=this.panel.getComponent(1)&&(this.panel.getComponent(1).hide(),this.panel.remove(1,!1)),a.text){case"Information":this.panel.add(this.getInfoPanel(this.data.feature).show());break;case"Variant effect":this.panel.add(this.getEffectPanel(this.data.consequenceType).show());break;case"Header":this.panel.add(this.getHeaderPanel(this.data.header).show());break;case"Samples":this.panel.add(this.getSamplesGrid(this.data.feature.sampleData,this.data.samples,this.data.feature.format).show());break;case"Population":}},VCFVariantInfoWidget.prototype.getInfoPanel=function(a){if(null==a)return this.notFoundPanel;if(null==this.infoPanel){var b=this.getVCFVariantTemplate();this.infoPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,data:a,tpl:b})}return this.infoPanel},VCFVariantInfoWidget.prototype.getEffectPanel=function(a){if(a.length<=0)return this.notFoundPanel;for(var b=0;b<a.length;b++)a[b].consequence=a[b].consequenceType+" - "+a[b].consequenceTypeObo,""==a[b].featureName&&(a[b].featureName="-"),""==a[b].geneId&&(a[b].geneId="-"),""==a[b].transcriptId&&(a[b].transcriptId="-"),""==a[b].featureBiotype&&(a[b].featureBiotype="-"),""==a[b].aaPosition&&(a[b].aaPosition="-"),""==a[b].aminoacidChange&&(a[b].aminoacidChange="-");if(null==this.effectGrid){var c="consequence",d="effectGridModel",e=["featureName","geneId","transcriptId","featureBiotype","aaPosition","aminoacidChange","consequence"],f=[{header:"Feature",dataIndex:"featureName",flex:1},{header:"Gene Id",dataIndex:"geneId",flex:1.5},{header:"Transcript Id",dataIndex:"transcriptId",flex:1.5},{header:"Feat.Biotype",dataIndex:"featureBiotype",flex:1},{header:"aa Position",dataIndex:"aaPosition",flex:1},{header:"aa Change",dataIndex:"aminoacidChange",flex:1}];this.effectGrid=this.doGrid(f,e,d,c),this.effectGrid.store.loadData(a)}return this.effectGrid},VCFVariantInfoWidget.prototype.getHeaderPanel=function(a){return""==a?this.notFoundPanel:(null==this.headerPanel&&(this.headerPanel=Ext.create("Ext.panel.Panel",{title:"Information",border:!1,cls:"panel-border-left",flex:3,bodyPadding:10,html:a})),this.headerPanel)},VCFVariantInfoWidget.prototype.getSamplesGrid=function(a,b,c){var d=a.split("	").slice(9);if(d.length<=0)return this.notFoundPanel;for(var e=new Array(b.length),f=0,g=e.length;g>f;f++)e[f]={id:b[f],info:d[f]};if(null==this.samplesGrid){var h="",i="VCF samples",j=["id","info"],k=[{header:"Identifier",dataIndex:"id",flex:1},{header:c,dataIndex:"info",flex:5}];this.samplesGrid=this.doGrid(k,j,i,h),this.samplesGrid.store.loadData(e)}return this.samplesGrid},VCFVariantInfoWidget.prototype.getData=function(){var a=this;this.panel.disable(),this.panel.setLoading("Getting information...");var b=new CellBaseManager(this.species);b.success.addEventListener(function(b,c){a.dataReceived(c.result)});var c=this.feature.chromosome+":"+this.feature.start+":"+this.feature.ref+":"+this.feature.alt;b.get("genomic","variant",c,"consequence_type")},VCFVariantInfoWidget.prototype.dataReceived=function(a){this.data=new Object,this.data.header=this.adapter.header,this.data.samples=this.adapter.samples,this.data.feature=this.feature,this.data.consequenceType=a,this.optionClick({text:"Information",leaf:"true"}),this.panel.enable(),this.panel.setLoading(!1)},GV_CELLBASE_HOST="http://ws.bioinfo.cipf.es/cellbase/rest",CELLBASE_HOST="http://ws-beta.bioinfo.cipf.es/cellbasebeta/rest",CELLBASE_VERSION="v3",FEATURE_CONFIG={gene:{filters:[{name:"biotype",text:"Biotype",values:["3prime_overlapping_ncrna","ambiguous_orf","antisense","disrupted_domain","IG_C_gene","IG_D_gene","IG_J_gene","IG_V_gene","lincRNA","miRNA","misc_RNA","Mt_rRNA","Mt_tRNA","ncrna_host","nonsense_mediated_decay","non_coding","non_stop_decay","polymorphic_pseudogene","processed_pseudogene","processed_transcript","protein_coding","pseudogene","retained_intron","retrotransposed","rRNA","sense_intronic","sense_overlapping","snoRNA","snRNA","transcribed_processed_pseudogene","transcribed_unprocessed_pseudogene","unitary_pseudogene","unprocessed_pseudogene"],selection:"multi"}]},snp:{filters:[{name:"consequence_type",text:"Consequence Type",values:["2KB_upstream_variant","5KB_upstream_variant","500B_downstream_variant","5KB_downstream_variant","3_prime_UTR_variant","5_prime_UTR_variant","coding_sequence_variant","complex_change_in_transcript","frameshift_variant","incomplete_terminal_codon_variant","inframe_codon_gain","inframe_codon_loss","initiator_codon_change","non_synonymous_codon","intergenic_variant","intron_variant","mature_miRNA_variant","nc_transcript_variant","splice_acceptor_variant","splice_donor_variant","splice_region_variant","stop_gained","stop_lost","stop_retained_variant","synonymous_codon"],selection:"multi"}]},bam:{options:[{text:"View as pairs",name:"view_as_pairs",type:"checkbox",fetch:!0,checked:!1},{text:"Show Soft-clipping",name:"show_softclipping",type:"checkbox",fetch:!0,checked:!1},{text:"Insert size interval",name:"insert_size_interval",type:"doublenumberfield",fetch:!1,minValue:0,maxValue:0}]}},FEATURE_OPTIONS={gene:[{name:"biotype",text:"Biotype",values:["3prime_overlapping_ncrna","ambiguous_orf","antisense","disrupted_domain","IG_C_gene","IG_D_gene","IG_J_gene","IG_V_gene","lincRNA","miRNA","misc_RNA","Mt_rRNA","Mt_tRNA","ncrna_host","nonsense_mediated_decay","non_coding","non_stop_decay","polymorphic_pseudogene","processed_pseudogene","processed_transcript","protein_coding","pseudogene","retained_intron","retrotransposed","rRNA","sense_intronic","sense_overlapping","snoRNA","snRNA","transcribed_processed_pseudogene","transcribed_unprocessed_pseudogene","unitary_pseudogene","unprocessed_pseudogene"],selection:"multi"}],snp:[{name:"consequence_type",text:"Consequence Type",values:["2KB_upstream_variant","5KB_upstream_variant","500B_downstream_variant","5KB_downstream_variant","3_prime_UTR_variant","5_prime_UTR_variant","coding_sequence_variant","complex_change_in_transcript","frameshift_variant","incomplete_terminal_codon_variant","inframe_codon_gain","inframe_codon_loss","initiator_codon_change","non_synonymous_codon","intergenic_variant","intron_variant","mature_miRNA_variant","nc_transcript_variant","splice_acceptor_variant","splice_donor_variant","splice_region_variant","stop_gained","stop_lost","stop_retained_variant","synonymous_codon"],selection:"multi"}],bam:[{name:"view",text:"View",values:["view_as_pairs","show_soft-clipped_bases"],selection:"multi"}]},GENE_BIOTYPE_COLORS={"3prime_overlapping_ncrna":"Orange",ambiguous_orf:"SlateBlue",antisense:"SteelBlue",disrupted_domain:"YellowGreen",IG_C_gene:"#FF7F50",IG_D_gene:"#FF7F50",IG_J_gene:"#FF7F50",IG_V_gene:"#FF7F50",lincRNA:"#8b668b",miRNA:"#8b668b",misc_RNA:"#8b668b",Mt_rRNA:"#8b668b",Mt_tRNA:"#8b668b",ncrna_host:"Fuchsia",nonsense_mediated_decay:"seagreen",non_coding:"orangered",non_stop_decay:"aqua",polymorphic_pseudogene:"#666666",processed_pseudogene:"#666666",processed_transcript:"#0000ff",protein_coding:"#a00000",pseudogene:"#666666",retained_intron:"goldenrod",retrotransposed:"lightsalmon",rRNA:"indianred",sense_intronic:"#20B2AA",sense_overlapping:"#20B2AA",snoRNA:"#8b668b",snRNA:"#8b668b",transcribed_processed_pseudogene:"#666666",transcribed_unprocessed_pseudogene:"#666666",unitary_pseudogene:"#666666",unprocessed_pseudogene:"#666666","":"orangered",other:"#000000"},SNP_BIOTYPE_COLORS={"2KB_upstream_variant":"#a2b5cd","5KB_upstream_variant":"#a2b5cd","500B_downstream_variant":"#a2b5cd","5KB_downstream_variant":"#a2b5cd","3_prime_UTR_variant":"#7ac5cd","5_prime_UTR_variant":"#7ac5cd",coding_sequence_variant:"#458b00",complex_change_in_transcript:"#00fa9a",frameshift_variant:"#ff69b4",incomplete_terminal_codon_variant:"#ff00ff",inframe_codon_gain:"#ffd700",inframe_codon_loss:"#ffd700",initiator_codon_change:"#ffd700",non_synonymous_codon:"#ffd700",intergenic_variant:"#636363",intron_variant:"#02599c",mature_miRNA_variant:"#458b00",nc_transcript_variant:"#32cd32",splice_acceptor_variant:"#ff7f50",splice_donor_variant:"#ff7f50",splice_region_variant:"#ff7f50",stop_gained:"#ff0000",stop_lost:"#ff0000",stop_retained_variant:"#76ee00",synonymous_codon:"#76ee00",other:"#000000"},SEQUENCE_COLORS={A:"#009900",C:"#0000FF",G:"#857A00",T:"#aa0000",N:"#555555"},SAM_FLAGS=[["read paired",1],["read mapped in proper pair",2],["read unmapped",4],["mate unmapped",8],["read reverse strand",16],["mate reverse strand",32],["first in pair",64],["second in pair",128],["not primary alignment",256],["read fails platform/vendor quality checks",512],["read is PCR or optical duplicate",1024]],FEATURE_TYPES={formatTitle:function(a){var b=a.replace(/_/gi," ");
return b=b.charAt(0).toUpperCase()+b.slice(1)},getTipCommons:function(a){var b=null!=a.strand?a.strand:"NA";return'start-end:&nbsp;<span class="emph">'+a.start+"-"+a.end+"</span><br>"+'strand:&nbsp;<span class="emph">'+b+"</span><br>"+'length:&nbsp;<span class="info">'+(a.end-a.start+1).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")+"</span><br>"},sequence:{color:SEQUENCE_COLORS},undefined:{getLabel:function(a){var b="";return b+=a.chromosome+":"+a.start+"-"+a.end},getTipTitle:function(){return" "},getTipText:function(){return" "},getColor:function(){return"grey"},height:10},gene:{label:function(a,b){var c=null!=a.name?a.name:a.id,d="";return d+=a.strand<0||"-"==a.strand?"<":"",d+=" "+c+" ",d+=a.strand>0||"+"==a.strand?">":"",null!=a.biotype&&""!=a.biotype&&b>25&&(d+=" ["+a.biotype+"]"),d},tooltipTitle:function(a){var b=null!=a.name?a.name:a.id;return FEATURE_TYPES.formatTitle("Gene")+' - <span class="ok">'+b+"</span>"},tooltipText:function(a){var b=GENE_BIOTYPE_COLORS[a.biotype];return'id:&nbsp;<span class="ssel">'+a.id+"</span><br>"+'biotype:&nbsp;<span class="emph" style="color:'+b+';">'+a.biotype+"</span><br>"+FEATURE_TYPES.getTipCommons(a)+'source:&nbsp;<span class="ssel">'+a.source+"</span><br><br>"+'description:&nbsp;<span class="emph">'+a.description+"</span><br>"},color:function(a){return GENE_BIOTYPE_COLORS[a.biotype]},infoWidgetId:"id",height:4,histogramColor:"lightblue",handlers:{"feature:click":function(a){console.log(a),new GeneInfoWidget(null,_this.species).draw(a)}}},transcript:{label:function(a){var b=null!=a.name?a.name:a.id,c="";return c+=a.strand<0?"<":"",c+=" "+b+" ",c+=a.strand>0?">":"",null!=a.biotype&&""!=a.biotype&&(c+=" ["+a.biotype+"]"),c},tooltipTitle:function(a){var b=null!=a.name?a.name:a.id;return FEATURE_TYPES.formatTitle("Transcript")+' - <span class="ok">'+b+"</span>"},tooltipText:function(a){var b=GENE_BIOTYPE_COLORS[a.biotype];return'id:&nbsp;<span class="ssel">'+a.id+"</span><br>"+'biotype:&nbsp;<span class="emph" style="color:'+b+';">'+a.biotype+"</span><br>"+'description:&nbsp;<span class="emph">'+a.description+"</span><br>"+FEATURE_TYPES.getTipCommons(a)},color:function(a){return GENE_BIOTYPE_COLORS[a.biotype]},infoWidgetId:"id",height:1,histogramColor:"lightblue"},exon:{label:function(a){var b=null!=a.name?a.name:a.id;return b},tooltipTitle:function(a){var b=null!=a.name?a.name:a.id;return null==b&&(b=""),FEATURE_TYPES.formatTitle("Exon")+' - <span class="ok">'+b+"</span>"},tooltipText:function(a,b){null!=a.name?a.name:a.id,null!=b.name?b.name:b.id;var c=GENE_BIOTYPE_COLORS[b.biotype];return'transcript name:&nbsp;<span class="ssel">'+b.name+"</span><br>"+'transcript Ensembl&nbsp;ID:&nbsp;<span class="ssel">'+b.id+"</span><br>"+'transcript biotype:&nbsp;<span class="emph" style="color:'+c+';">'+b.biotype+"</span><br>"+'transcript description:&nbsp;<span class="emph">'+b.description+"</span><br>"+'transcript start-end:&nbsp;<span class="emph">'+b.start+"-"+b.end+"</span><br>"+'exon start-end:&nbsp;<span class="emph">'+a.start+"-"+a.end+"</span><br>"+'strand:&nbsp;<span class="emph">'+b.strand+"</span><br>"+'length:&nbsp;<span class="info">'+(a.end-a.start+1).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")+"</span><br>"},color:function(){return"black"},infoWidgetId:"id",height:5,histogramColor:"lightblue"},snp:{label:function(a){return"name"in a?a.name:a.id},tooltipTitle:function(a){var b=null!=a.name?a.name:a.id;return a.featureType.toUpperCase()+' - <span class="ok">'+b+"</span>"},tooltipText:function(a){return'alleles:&nbsp;<span class="ssel">'+a.alleleString+"</span><br>"+FEATURE_TYPES.getTipCommons(a)+'source:&nbsp;<span class="ssel">'+a.source+"</span><br>"},color:"lightblue",infoWidgetId:"id",height:8,histogramColor:"orange",handlers:{"feature:mouseover":function(a){console.log(a)},"feature:click":function(a){new SnpInfoWidget(null,genomeViewer.species).draw(a)}}},file:{getLabel:function(a){var b="";return b+=a.label},getTipTitle:function(a){return FEATURE_TYPES.formatTitle(a.featureType)},getTipText:function(a){return FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},height:8,histogramColor:"orange"},vcf:{label:function(a){return a.id},tooltipTitle:function(a){return'VCF variant - <span class="ok">'+a.id+"</span>"},tooltipText:function(a){return'alleles (ref/alt):&nbsp;<span class="emph">'+a.reference+"/"+a.alternate+"</span><br>"+'quality:&nbsp;<span class="emph">'+a.quality+"</span><br>"+'filter:&nbsp;<span class="emph">'+a.filter+"</span><br>"+FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},infoWidgetId:"id",height:8,histogramColor:"gray"},gff2:{getLabel:function(a){var b="";return b+=a.label},getTipTitle:function(a){return a.featureType.toUpperCase()+' - <span class="ok">'+a.label+"</span>"},getTipText:function(a){return'score:&nbsp;<span class="emph">'+a.score+"</span><br>"+'frame:&nbsp;<span class="emph">'+a.frame+"</span><br>"+FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},height:8,histogramColor:"gray"},gff3:{getLabel:function(a){var b="";return b+=a.label},getTipTitle:function(a){return a.featureType.toUpperCase()+' - <span class="ok">'+a.label+"</span>"},getTipText:function(a){return'score:&nbsp;<span class="emph">'+a.score+"</span><br>"+'frame:&nbsp;<span class="emph">'+a.frame+"</span><br>"+FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},height:8,histogramColor:"gray"},gtf:{getLabel:function(a){var b="";return b+=a.label},getTipTitle:function(a){return a.featureType.toUpperCase()+' - <span class="ok">'+a.label+"</span>"},getTipText:function(a){return'score:&nbsp;<span class="emph">'+a.score+"</span><br>"+'frame:&nbsp;<span class="emph">'+a.frame+"</span><br>"+FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},height:8,histogramColor:"gray"},bed:{getLabel:function(a){var b="";return b+=a.label},getTipTitle:function(a){return FEATURE_TYPES.formatTitle(a.featureType)},getTipText:function(a){return FEATURE_TYPES.getTipCommons(a)},getColor:function(a){var b=new Array;b=a.itemRgb.split(",");var c=function(a){var b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return isNaN(a)?"00":b[(a-a%16)/16]+b[a%16]},d=c(b[0])+c(b[1])+c(b[2]);return"#"+d},height:8,histogramColor:"orange"},bam:{explainFlags:function(a){for(var b='<div style="background:#FFEF93;font-weight:bold;margin:0 15px 0 0;">flags : <span class="ssel">'+a+"</span></div>",c=0;c<SAM_FLAGS.length;c++)SAM_FLAGS[c][1]&a&&(b+=SAM_FLAGS[c][0]+"<br>");return b},getLabel:function(a){return"bam  "+a.chromosome+":"+a.start+"-"+a.end},getTipTitle:function(a){return FEATURE_TYPES.formatTitle(a.featureType)+' - <span class="ok">'+a.name+"</span>"},getTipText:function(a){a.strand=FEATURE_TYPES.bam.getStrand(a);var b='cigar:&nbsp;<span class="ssel">'+a.cigar+"</span><br>"+'insert size:&nbsp;<span class="ssel">'+a.inferredInsertSize+"</span><br>"+FEATURE_TYPES.getTipCommons(a)+"<br>"+this.explainFlags(a.flags),c='<div style="background:#FFEF93;font-weight:bold;">attributes</div>';delete a.attributes.BQ;for(var d in a.attributes)c+=d+":"+a.attributes[d]+"<br>";return'<div style="float:left">'+b+"</div>"+'<div style="float:right">'+c+"</div>"},getColor:function(a,b){return a.mateReferenceName!=b?"lightgreen":0==(16&parseInt(a.flags))?"DarkGray":"LightGray"},getStrokeColor:function(a){return this.getMateUnmappedFlag(a)?"tomato":"whitesmoke"},getStrand:function(a){return 0==(16&parseInt(a.flags))?"Forward":"Reverse"},getReadPairedFlag:function(a){return 0==(1&parseInt(a.flags))?!1:!0},getFirstOfPairFlag:function(a){return 0==(64&parseInt(a.flags))?!1:!0},getMateUnmappedFlag:function(a){return 0==(8&parseInt(a.flags))?!1:!0},height:8,histogramColor:"grey"},das:{getLabel:function(a){var b="";return b+=a.id},getTipTitle:function(a){return FEATURE_TYPES.formatTitle(a.featureType)},getTipText:function(a){return FEATURE_TYPES.getTipCommons(a)},getColor:function(){return"black"},height:8,histogramColor:"orange"}},DataSource.prototype.fetch=function(){},FileDataSource.prototype.fetch=DataSource.prototype.fetch,FileDataSource.prototype.error=function(){alert("File is too big. Max file size is 100 Mbytes.")},FileDataSource.prototype.fetch=function(a){var b=this;if(this.file.size<=52428800){if(!a){var c=new FileReaderSync;return c.readAsText(this.file,"UTF-8")}var c=new FileReader;c.onload=function(a){b.success.notify(a.target.result)},c.readAsText(this.file,"UTF-8")}else b.error(),b.error.notify()},StringDataSource.prototype.fetch=DataSource.prototype.fetch,StringDataSource.prototype.fetch=function(a){return a?(this.success.notify(this.str),void 0):this.str},UrlDataSource.prototype.fetch=DataSource.prototype.fetch,UrlDataSource.prototype.fetch=function(a){var b=this,c=null;return this.url?($.ajax({type:"GET",url:this.url,async:a,success:function(d){a?b.success.notify(d):c=d},error:function(a,c,d){console.log("URL Data source: Ajax call returned : "+d+"	"+c+"	"+a.statusText+" END"),b.error.notify()}}),c):void 0},CellBaseAdapter.prototype.clearData=function(){this.featureCache.clear()},CellBaseAdapter.prototype.setFilters=function(a){this.clearData(),this.filters=a;for(filter in a){var b=a[filter].toString();delete this.params[filter],""!=b&&(this.params[filter]=b)}},CellBaseAdapter.prototype.setOption=function(a,b){a.fetch&&this.clearData(),this.options[a.name]=b;for(option in this.options)null!=this.options[a.name]?this.params[a.name]=this.options[a.name]:delete this.params[a.name]},CellBaseAdapter.prototype.getData=function(a){var b=String.fromCharCode(65+Math.round(10*Math.random())),c=this;this.params.histogram=a.histogram,this.params.interval=a.interval,this.params.transcript=a.transcript,this.params.chromosome=a.chromosome,this.params.resource=this.resource,a.start<1&&(a.start=1),a.end>3e8&&(a.end=3e8);var d="data";a.transcript&&(d="withTranscripts"),a.histogram&&(d="histogram"+a.interval),this.params.dataType=d;for(var e=this.featureCache._getChunk(a.start),f=this.featureCache._getChunk(a.end),g=[],h=[],i=e;f>=i;i++){var j=a.chromosome+":"+i;if(null==this.featureCache.cache[j]||null==this.featureCache.cache[j][d])g.push(i);else{var k=this.featureCache.getFeatureChunk(j);h.push(k)}}var l=new CellBaseManager(this.species,{host:this.host});l.success.addEventListener(function(a,d){var e="data";d.params.transcript&&(e="withTranscripts"),d.params.histogram&&(e="histogram"+d.params.interval),1==d.params.histogram&&(d.result=[d.result]);for(var f=d.resource,g=[],i=0;i<d.query.length;i++){var j=d.query[i].split(":"),k=j[1].split("-");g.push({chromosome:j[0],start:k[0],end:k[1]})}for(var i=0;i<d.result.length;i++){if(d.result[i].constructor!=Array&&(d.result[i]=[d.result[i]]),1!=d.params.histogram&&"gene"==f&&1==d.params.transcript)for(var l=0,m=d.result[i].length;m>l;l++)for(var n=0,o=d.result[i][l].transcripts.length;o>n;n++){d.result[i][l].transcripts[n].featureType="transcript";for(var p=0,q=d.result[i][l].transcripts[n].exons.length;q>p;p++)d.result[i][l].transcripts[n].exons[p].featureType="exon"}"regulatory"==f&&(f=d.params.type,"TF_binding_site_motif"==f&&(f="tfbs")),console.time(c.resource+" save "+b),c.featureCache.putFeaturesByRegion(d.result[i],g[i],f,e);var r=c.featureCache.getFeatureChunksByRegion(g[i]);console.timeEnd(c.resource+" save "+b),null!=r&&(h=h.concat(r))}h.length>0&&c.trigger("data:ready",{items:h,params:c.params,cached:!1,sender:c}),console.timeEnd(c.resource+" get and save "+b)});var m=[],n=!0,o=!0;if(g.length>0){for(var i=0;i<g.length;i++){if(n){var p=parseInt(g[i]*this.featureCache.chunkSize);n=!1}if(o){var q=parseInt(g[i]*this.featureCache.chunkSize+this.featureCache.chunkSize-1);o=!1}if(null!=g[i+1])if(g[i]+1==g[i+1])o=!0;else{var r=a.chromosome+":"+p+"-"+q;m.push(r),n=!0,o=!0}else{var r=a.chromosome+":"+p+"-"+q;m.push(r),n=!0,o=!0}}console.time(c.resource+" get and save "+b),l.get(this.category,this.subCategory,m,this.resource,this.params)}else h.length>0&&c.trigger("data:ready",{items:h,params:this.params,sender:this})},SequenceAdapter.prototype.clearData=function(){this.sequence={},this.start={},this.end={}},SequenceAdapter.prototype.getData=function(a){var b=this;this.sender=a.sender;var c=a.chromosome;a.start<1&&(a.start=1),a.end<1&&(a.end=1),a.end>3e8&&(a.end=3e8),(a.start<this.start[c]-5e3||a.end>this.end[c]+5e3)&&this.clearData(),this.params.histogram=a.histogram,this.params.interval=a.interval,this.params.transcript=a.transcript,this.params.chromosome=a.chromosome,this.params.resource=this.resource;var d=this._getSequenceQuery(a);if(""!=d){var e=new CellBaseManager(this.species,{host:this.host});e.success.addEventListener(function(a,c){b._processSequenceQuery(c,!0)}),e.get(this.category,this.subCategory,d,this.resource,this.params)}else"move"!=this.sender&&(this.onGetData.notify({items:{sequence:this.sequence[c],phastCons:this.phastCons[c],phylop:this.phylop[c],start:this.start[c],end:this.end[c]},params:this.params}),this.trigger("data:ready",{items:{sequence:this.sequence[c],phastCons:this.phastCons[c],phylop:this.phylop[c],start:this.start[c],end:this.end[c]},params:this.params,sender:this}))},SequenceAdapter.prototype._getSequenceQuery=function(a){var b,c,d,e=this,f=a.chromosome,g=[];return null==e.start[f]&&null==e.end[f]?(e.start[f]=a.start,e.end[f]=a.end,b=a.start,c=a.end,d=f+":"+b+"-"+c,g.push(d)):(a.start<=e.start[f]&&(b=a.start,c=e.start[f]-1,c=1>c?a.end=1:c,e.start[f]=b,d=a.chromosome+":"+b+"-"+c,g.push(d)),a.end>=e.end[f]&&(c=a.end,b=e.end[f]+1,e.end[f]=c,d=a.chromosome+":"+b+"-"+c,g.push(d))),g.toString()},SequenceAdapter.prototype._processSequenceQuery=function(a,b){for(var c=a.result,d=a.params,e=a.params.chromosome,f=0;f<c.length;f++){var g=a.query[f].split(":"),h=g[1].split("-"),i=parseInt(h[0]),j=parseInt(h[1]);this.sequence[e]=null==this.sequence[e]?c[f].sequence:i==this.start[e]?c[f].sequence+this.sequence[e]:this.sequence[e]+c[f].sequence,"move"==this.sender&&1==b&&(this.onGetData.notify({items:{sequence:c[f].sequence,phastCons:c[f].phastCons,phylop:c[f].phylop,start:i,end:j},params:d}),this.trigger("data:ready",{items:{sequence:c[f].sequence,phastCons:c[f].phastCons,phylop:c[f].phylop,start:i,end:j},params:d,sender:this}))}"move"!=this.sender&&1==b&&(this.onGetData.notify({items:{sequence:this.sequence[e],phastCons:this.phastCons[e],phylop:this.phylop[e],start:this.start[e],end:this.end[e]},params:d}),this.trigger("data:ready",{items:{sequence:this.sequence[e],phastCons:this.phastCons[e],phylop:this.phylop[e],start:this.start[e],end:this.end[e]},params:d,sender:this}))},SequenceAdapter.prototype.getNucleotidByPosition=function(a){var b=this;if(a.start>0&&a.end>0){var c=this._getSequenceQuery(a),d=a.chromosome;if(""!=c){var e=new CellBaseManager(this.species,{host:this.host,async:!1}),f=e.get(this.category,this.subCategory,c,this.resource,this.params);b._processSequenceQuery(f)}if(null!=this.sequence[d]){var g=this.sequence[d].substr(a.start-this.start[d],1);return g}return console.log("SequenceRender: this.sequence[chromosome] is undefined"),""}},FeatureDataAdapter.prototype.getData=function(a){console.log("TODO comprobar histograma"),console.log(a),this.params.dataType="data",this.params.chromosome=a.chromosome,1!=this.chromosomesLoaded[a.chromosome]&&(this._fetchData(a),this.chromosomesLoaded[a.chromosome]=!0);var b=this.featureCache.getFeatureChunksByRegion(a);null!=b&&this.trigger("data:ready",{items:b,params:this.params,cached:!0,sender:this})},FeatureDataAdapter.prototype._fetchData=function(a){var b=this;if(null!=this.dataSource)if(this.async)this.dataSource.success.addEventListener(function(c,d){b.parse(d,a),b.trigger("file:load",{sender:b})}),this.dataSource.fetch(this.async);else{var c=this.dataSource.fetch(this.async);this.parse(c,a)}},FeatureDataAdapter.prototype.addFeatures=function(a){this.featureCache.putFeatures(a,"data")},BEDDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,BEDDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,BEDDataAdapter.prototype.parse=function(a,b){for(var c="data",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	"),h=g[0].replace("chr","");if(h==b.chromosome){var i={label:g[3],chromosome:h,start:parseFloat(g[1]),end:parseFloat(g[2]),score:g[4],strand:g[5],thickStart:g[6],thickEnd:g[7],itemRgb:g[8],blockCount:g[9],blockSizes:g[10],blockStarts:g[11],featureType:"bed"};this.featureCache.putFeatures(i,c),null==this.featuresByChromosome[h]&&(this.featuresByChromosome[h]=0),this.featuresByChromosome[h]++,this.featuresCount++}}}},GFF2DataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GFF2DataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GFF2DataAdapter.prototype.parse=function(a,b){for(var c="data",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	"),h=g[0].replace("chr","");if(h==b.chromosome){var i={chromosome:h,label:g[2],start:parseInt(g[3]),end:parseInt(g[4]),score:g[5],strand:g[6],frame:g[7],group:g[8],featureType:"gff2"};this.featureCache.putFeatures(i,c),null==this.featuresByChromosome[h]&&(this.featuresByChromosome[h]=0),this.featuresByChromosome[h]++,this.featuresCount++}}}},GFF3DataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GFF3DataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GFF3DataAdapter.prototype.parse=function(a,b){for(var c=function(a){for(var b=a.split(";"),c={},d=0,e=b.length;e>d;d++){var f=b[d].split("=");c[f[0]]=f[1]}return c},d="data",e=a.split("\n"),f=0;f<e.length;f++){var g=e[f].replace(/^\s+|\s+$/g,"");if(null!=g&&g.length>0){var h=g.split("	"),i=h[0].replace("chr","");if(i==b.chromosome){var j={chromosome:i,label:h[2],start:parseInt(h[3]),end:parseInt(h[4]),score:h[5],strand:h[6],frame:h[7],attributes:c(h[8]),featureType:"gff3"};this.featureCache.putFeatures(j,d),null==this.featuresByChromosome[i]&&(this.featuresByChromosome[i]=0),this.featuresByChromosome[i]++,this.featuresCount++}}}},GTFDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,GTFDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,GTFDataAdapter.prototype.parse=function(a,b){for(var c=function(a){for(var b=a.split(";"),c={},d=0,e=b.length;e>d;d++){var f=b[d].split("=");c[f[0]]=f[1]}return c},d="data",e=a.split("\n"),f=0;f<e.length;f++){var g=e[f].replace(/^\s+|\s+$/g,"");if(null!=g&&g.length>0){var h=g.split("	"),i=h[0].replace("chr","");if(i==b.chromosome){var j={chromosome:i,label:h[2],start:parseInt(h[3]),end:parseInt(h[4]),score:h[5],strand:h[6],frame:h[7],attributes:c(h[8]),featureType:"gtf"};this.featureCache.putFeatures(j,d),null==this.featuresByChromosome[i]&&(this.featuresByChromosome[i]=0),this.featuresByChromosome[i]++,this.featuresCount++}}}},VCFDataAdapter.prototype.getData=FeatureDataAdapter.prototype.getData,VCFDataAdapter.prototype._fetchData=FeatureDataAdapter.prototype._fetchData,VCFDataAdapter.prototype.parse=function(a,b){console.log(a);for(var c="data",d=a.split("\n"),e=0;e<d.length;e++){var f=d[e].replace(/^\s+|\s+$/g,"");if(null!=f&&f.length>0){var g=f.split("	");if(g[0]==b.chromosome)if("#"===f.substr(0,1))"#"===f.substr(1,1)?this.header+=f.replace(/</gi,"&#60;").replace(/>/gi,"&#62;")+"<br>":this.samples=g.slice(9);else{var h={chromosome:g[0],position:parseInt(g[1]),start:parseInt(g[1]),end:parseInt(g[1]),id:g[2],reference:g[3],alternate:g[4],quality:g[5],filter:g[6],info:g[7].replace(/;/gi,"<br>"),format:g[8],sampleData:f,featureType:"vcf"};this.featureCache.putFeatures(h,c),null==this.featuresByChromosome[g[0]]&&(this.featuresByChromosome[g[0]]=0),this.featuresByChromosome[g[0]]++,this.featuresCount++}}}},Region.prototype={load:function(a){this.chromosome=a.chromosome||this.chromosome,this.start=a.start||this.start,this.end=a.end||this.end,this.start=parseInt(this.start),this.end=parseInt(this.end)},parse:function(a){var b=/^([a-zA-Z0-9])+\:([0-9])+\-([0-9])+$/,c=/^([a-zA-Z0-9])+\:([0-9])+$/;if(b.test(a)||c.test(a)){var d=a.split(":");if(2==d.length){var e=d[1].split("-");this.chromosome=d[0],this.start=parseInt(e[0]),this.end=2==e.length?parseInt(e[1]):this.start}return!0}return!1},center:function(){return this.start+Math.floor(this.length()/2)},length:function(){return this.end-this.start+1},toString:function(a){var b;return b=1==a?this.chromosome+":"+Utils.formatNumber(this.start)+"-"+Utils.formatNumber(this.end):this.chromosome+":"+this.start+"-"+this.end}},FeatureBinarySearchTree.prototype={constructor:FeatureBinarySearchTree,add:function(a){var b,c={value:a,left:null,right:null};if(null===this._root)return this._root=c,!0;for(b=this._root;;)if(c.value.end<b.value.start){if(null===b.left)return b.left=c,!0;b=b.left}else{if(!(c.value.start>b.value.end))return!1;if(null===b.right)return b.right=c,!0;b=b.right}},contains:function(a){for(var b={value:a,left:null,right:null},c=!1,d=this._root;!c&&d;)b.value.end<d.value.start?d=d.left:b.value.start>d.value.end?d=d.right:c=!0;return c}},FeatureCache.prototype._getChunk=function(a){return Math.floor(a/this.chunkSize)},FeatureCache.prototype.getChunkRegion=function(a){return start=this._getChunk(a.start)*this.chunkSize,end=this._getChunk(a.end)*this.chunkSize+this.chunkSize-1,{start:start,end:end}},FeatureCache.prototype.getFirstFeature=function(){var a;return a=this.gzip?JSON.parse(RawDeflate.inflate(this.cache[Object.keys(this.cache)[0]].data[0])):this.cache[Object.keys(this.cache)[0]].data[0]},FeatureCache.prototype.getFeatureChunk=function(a){return null!=this.cache[a]?this.cache[a]:null},FeatureCache.prototype.getFeatureChunksByRegion=function(a){var b,c,d,e=[];b=this._getChunk(a.start),c=this._getChunk(a.end);for(var f=b;c>=f;f++)d=a.chromosome+":"+f,null!=this.cache[d]&&e.push(this.cache[d]);return e},FeatureCache.prototype.putFeaturesByRegion=function(a,b,c,d){var e,f,g,h,i,j,k;f=this._getChunk(b.start),g=this._getChunk(b.end);for(var l=f;g>=l;l++)e=b.chromosome+":"+l,null==this.cache[e]&&(this.cache[e]={},this.cache[e].key=e),null==this.cache[e][d]&&(this.cache[e][d]=[]);a.constructor!=Array&&(a=[a]);for(var m=0,n=a.length;n>m;m++){j=a[m],j.featureType=c,h=this._getChunk(j.start),i=this._getChunk(j.end),k=this.gzip?RawDeflate.deflate(JSON.stringify(j)):j;for(var l=h;i>=l;l++)l>=f&&g>=l&&(e=b.chromosome+":"+l,this.cache[e][d].push(k))}},FeatureCache.prototype.putFeatures=function(a,b){var c,d,e,f;a.constructor!=Array&&(a=[a]);for(var g=0,h=a.length;h>g;g++){c=a[g],e=this._getChunk(c.start),f=this._getChunk(c.end);for(var i=e;f>=i;i++)d=c.chromosome+":"+i,null==this.cache[d]&&(this.cache[d]=[],this.cache[d].key=d),null==this.cache[d][b]&&(this.cache[d][b]=[]),this.gzip?this.cache[d][b].push(RawDeflate.deflate(JSON.stringify(c))):this.cache[d][b].push(c)}},FeatureCache.prototype.putChunk=function(a,b){this.cache[a]=b},FeatureCache.prototype.getChunk=function(a){return this.cache[a]},FeatureCache.prototype.putCustom=function(a){a(this)},FeatureCache.prototype.getCustom=function(a){a(this)},FeatureCache.prototype.remove=function(a){for(var b=this._getChunk(a.start),c=this._getChunk(a.end),d=b;c>=d;d++){var e=a.chromosome+":"+d;this.cache[e]=null}},FeatureCache.prototype.clear=function(){this.size=0,this.cache={}},NavigationBar.prototype={render:function(a){var b=this;if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;var c='<a id="restoreDefaultRegionButton">&nbsp;</a><button id="regionHistoryButton">&nbsp;</button><ul id="regionHistoryMenu" style="display: inline-block; position: absolute; width: 150px; z-index:100000"></ul><button id="speciesButton"><span id="speciesText">'+this.species.text+"</span></button>"+'<ul id="speciesMenu" style="display: inline-block; position: absolute; width: 200px; z-index:100000"></ul>'+'<button id="chromosomesButton"> <span id="chromosomesText">'+this.region.chromosome+"</span></button>"+'<ul id="chromosomesMenu" style="display: inline-block; position: absolute; width: 100px; z-index:100000"></ul>'+'<div class="buttonset inlineblock">'+'<input type="checkbox" checked="true" id="karyotypeButton" /><label for="karyotypeButton"></label>'+'<input type="checkbox" checked="true" id="chromosomeButton" /><label for="chromosomeButton"></label>'+'<input type="checkbox" checked="true" id="regionButton" /><label for="regionButton"></label>'+"</div>"+'<a id="zoomOutButton">&nbsp;</a>'+'<div id="slider" class="ocb-zoom-slider"></div>'+'<a id="zoomInButton">&nbsp;</a>'+'<label class="ocb-text" style="margin-left:10px" for="regionField">Position:</label><input id="regionField" class="ocb-input-text" placeholder="Enter region..." type="text">'+'<button id="goButton">Go!</button>'+'<div class="buttonset inlineblock">'+'<a id="moveFurtherLeftButton">&nbsp;</a>'+'<a id="moveLeftButton">&nbsp;</a>'+'<a id="moveRightButton">&nbsp;</a>'+'<a id="moveFurtherRightButton">&nbsp;</a>'+"</div>"+'<label class="ocb-text" style="margin-left:10px" for="searchField">Search</label><input id="searchField" class="ocb-input-text" placeholder="gene, snp..." size="8" type="text">'+'<a id="fullScreenButton" style="margin-left:10px" >&nbsp;</a>';this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="navigation-bar" class="gv-navigation-bar unselectable">'+c+"</div>")[0],$(this.targetDiv).append(this.div),$(this.div).find(".buttonset").buttonset().css({margin:"0px 10px"}),this.restoreDefaultRegionButton=$(this.div).find("#restoreDefaultRegionButton").button({icons:{primary:"ocb-icon-repeat"},text:!1}),$(this.restoreDefaultRegionButton).click(function(a){b.trigger("restoreDefaultRegion:click",{clickEvent:a,sender:{}})}),this.regionHistoryButton=$(this.div).find("#regionHistoryButton").button({icons:{primary:"ocb-icon-clock",secondary:"ui-icon-triangle-1-s"},text:" "}),this.regionHistoryMenu=$(this.div).find("#regionHistoryMenu").hide().menu(),this._addRegionHistoryMenuItem(this.region),$(this.regionHistoryButton).click(function(){var a=$(b.regionHistoryMenu);return"none"==$(a).css("display")?($(a).show().position({my:"left top",at:"left bottom",of:this}),$(document).one("click",function(){a.hide()})):a.hide(),!1}),this.speciesButton=$(this.div).find("#speciesButton").button({icons:{secondary:"ui-icon-triangle-1-s"}}),this.speciesText=$(this.div).find("#speciesText"),this.speciesMenu=$(this.div).find("#speciesMenu").hide().menu(),this._setSpeciesMenu(),$(this.speciesButton).click(function(){var a=$(b.speciesMenu);return"none"==$(a).css("display")?($(a).show().position({my:"left top",at:"left bottom",of:this}),$(document).one("click",function(){a.hide()})):a.hide(),!1}),this.chromosomesButton=$(this.div).find("#chromosomesButton").button({icons:{primary:"ocb-icon-chromosome",secondary:"ui-icon-triangle-1-s"}}),this.chromosomesText=$(this.div).find("#chromosomesText"),this.chromosomesMenu=$(this.div).find("#chromosomesMenu").hide().menu(),this._setChromosomeMenu(),$(this.chromosomesButton).click(function(){var a=$(b.chromosomesMenu);return"none"==$(a).css("display")?($(a).show().position({my:"left top",at:"left bottom",of:this}),$(document).one("click",function(){a.hide()})):a.hide(),!1}),this.karyotypeButton=$(this.div).find("#karyotypeButton").button({icons:{primary:"ocb-icon-karyotype"},text:!1,label:"karyotype"}),this.chromosomeButton=$(this.div).find("#chromosomeButton").button({icons:{primary:"ocb-icon-chromosome"},text:!1,label:"chromosome"}),this.regionButton=$(this.div).find("#regionButton").button({icons:{primary:"ocb-icon-region"},text:!1,label:"region"}),$(this.div).find(".buttonset").find(".ui-icon").css({"margin-left":"-9px"}),$(this.karyotypeButton).click(function(){b.trigger("karyotype-button:change",{selected:$(this).is(":checked"),sender:b})}),$(this.chromosomeButton).click(function(){b.trigger("chromosome-button:change",{selected:$(this).is(":checked"),sender:b})}),$(this.regionButton).click(function(){b.trigger("region-button:change",{selected:$(this).is(":checked"),sender:b})}),this.zoomSlider=$(this.div).find("#slider"),$(this.zoomSlider).slider({range:"min",value:this.zoom,min:0,max:100,step:Number.MIN_VALUE,stop:function(a,c){b._handleZoomSlider(c.value)}}),this.zoomInButton=$(this.div).find("#zoomInButton").button({icons:{primary:"ocb-icon-plus"},text:!1}),this.zoomOutButton=$(this.div).find("#zoomOutButton").button({icons:{primary:"ocb-icon-minus"},text:!1}),$(this.zoomOutButton).click(function(){b._handleZoomOutButton()}),$(this.zoomInButton).click(function(){b._handleZoomInButton()}),this.regionField=$(this.div).find("#regionField")[0],$(this.regionField).bind("keypress",function(a){var c=a.keyCode?a.keyCode:a.which;13==c&&b._goRegion($(this).val())}),$(this.regionField).val(this.region.toString()),this.goButton=$(this.div).find("#goButton").button(),$(this.goButton).click(function(){b._goRegion($(b.regionField).val())}),this.moveFurtherLeftButton=$(this.div).find("#moveFurtherLeftButton").button({icons:{primary:"ocb-icon-arrow-w-bold"},text:!1}),this.moveFurtherRightButton=$(this.div).find("#moveFurtherRightButton").button({icons:{primary:"ocb-icon-arrow-e-bold"},text:!1}),this.moveLeftButton=$(this.div).find("#moveLeftButton").button({icons:{primary:"ocb-icon-arrow-w"},text:!1}),this.moveRightButton=$(this.div).find("#moveRightButton").button({icons:{primary:"ocb-icon-arrow-e"},text:!1}),$(this.moveFurtherLeftButton).click(function(){b._handleMoveRegion(10)}),$(this.moveFurtherRightButton).click(function(){b._handleMoveRegion(-10)}),$(this.moveLeftButton).click(function(){b._handleMoveRegion(1)}),$(this.moveRightButton).click(function(){b._handleMoveRegion(-1)}),this.fullScreenButton=$(this.div).find("#fullScreenButton").button({icons:{primary:"ocb-icon-resize"},text:!1}),$(this.fullScreenButton).click(function(a){b.trigger("fullscreen:click",{clickEvent:a,sender:{}})}),this.searchField=$(this.div).find("#searchField"),$(this.searchField).autocomplete({source:function(a,c){c(b._quickSearch(a))},minLength:3}),this.rendered=!0},_addRegionHistoryMenuItem:function(a){var b=this,c=$('<li class="ui-menu-item" role="presentation"><a id="ui-id-1" class="ui-corner-all" tabindex="-1" role="menuitem">'+a.toString()+"</a></li>")[0];$(this.regionHistoryMenu).append(c),$(c).click(function(){b.region.parse($(this).text()),b._recalculateZoom(),b.trigger("region:change",{region:b.region,sender:b}),console.log($(this).text())})},_setChromosomeMenu:function(){var a=this;$(this.chromosomesMenu).empty();var b=[];for(var c in this.availableSpecies.items)for(var d in this.availableSpecies.items[c].items){var e=this.availableSpecies.items[c].items[d];if(e.text===this.species.text){b=e.chromosomes;break}}this.currentChromosomeList=b;for(var c in b){var f=$('<li class="ui-menu-item" role="presentation"><a id="ui-id-1" class="ui-corner-all" tabindex="-1" role="menuitem">'+b[c]+"</a></li>")[0];$(this.chromosomesMenu).append(f),$(f).click(function(){$(a.chromosomesText).text($(this).text()),a.region.chromosome=$(this).text(),a._recalculateZoom(),a._addRegionHistoryMenuItem(a.region),a.trigger("region:change",{region:a.region,sender:a}),console.log($(this).text())})}},_setSpeciesMenu:function(){var a=this,b=function(b){var c=$('<li class="ui-menu-item" role="presentation"><a id="ui-id-1" class="ui-corner-all" tabindex="-1" role="menuitem">'+b.text+"</a></li>")[0];$(a.speciesMenu).append(c),$(c).click(function(){a.species=b,$(a.speciesText).text($(this).text()),a._setChromosomeMenu(),a.trigger("species:change",{species:b,sender:a})})};for(var c in this.availableSpecies.items)for(var d in this.availableSpecies.items[c].items){var e=this.availableSpecies.items[c].items[d];b(e)}},_goRegion:function(a){var b=new Region;!b.parse(a)||b.start<0||b.end<0||-1==_.indexOf(this.currentChromosomeList,b.chromosome)?($(this.regionField).css({opacity:0}),$(this.regionField).animate({opacity:1},700)):(this.region.load(b),$(this.chromosomeText).text(this.region.chromosome),this._recalculateZoom(),this._addRegionHistoryMenuItem(this.region),this.trigger("region:change",{region:this.region,sender:this}))},_quickSearch:function(a){var b=[],c=Utils.getSpeciesCode(this.species.text).substr(0,3),d="http://ws.bioinfo.cipf.es/cellbase/rest";
return $.ajax({url:d+"/latest/"+c+"/feature/id/"+a.term+"/starts_with?of=json",async:!1,dataType:"json",success:function(a){for(var c in a[0])b.push(a[0][c].displayId)},error:function(a,b){console.log(b)}}),b},_goFeature:function(a){null!=a&&("rs"==a.slice(0,"rs".length)||"AFFY_"==a.slice(0,"AFFY_".length)||"SNP_"==a.slice(0,"SNP_".length)||"VAR_"==a.slice(0,"VAR_".length)||"CRTAP_"==a.slice(0,"CRTAP_".length)||"FKBP10_"==a.slice(0,"FKBP10_".length)||"LEPRE1_"==a.slice(0,"LEPRE1_".length)||"PPIB_"==a.slice(0,"PPIB_".length)?this.openSNPListWidget(a):this.openGeneListWidget(a))},_handleZoomOutButton:function(){this._handleZoomSlider(Math.max(0,this.zoom-1)),$(this.zoomSlider).slider("value",this.zoom)},_handleZoomSlider:function(a){this.zoom=a,this.region.load(this._calculateRegionByZoom()),$(this.regionField).val(this.region.toString()),this._addRegionHistoryMenuItem(this.region),this.trigger("region:change",{region:this.region,sender:this})},_handleZoomInButton:function(){this._handleZoomSlider(Math.min(100,this.zoom+1)),$(this.zoomSlider).slider("value",this.zoom)},_handleMoveRegion:function(a){var b=(this.width-this.svgCanvasWidthOffset)/this.region.length(),c=Math.round(10*a/b);this.region.start-=c,this.region.end-=c,$(this.regionField).val(this.region.toString()),this.trigger("region:move",{region:this.region,disp:c,sender:this})},setVisible:function(a){for(key in a){var b=$(this.div).find("#"+key);a[key]?b.show():b.hide()}},setRegion:function(a){this.region.load(a),$(this.chromosomeText).text(this.region.chromosome),$(this.regionField).val(this.region.toString()),this._recalculateZoom(),this._addRegionHistoryMenuItem(a)},moveRegion:function(a){this.region.load(a),$(this.chromosomeText).text(this.region.chromosome),$(this.regionField).val(this.region.toString()),this._recalculateZoom()},setWidth:function(a){this.width=a,this._recalculateZoom()},_recalculateZoom:function(){this.zoom=this._calculateZoomByRegion(),$(this.zoomSlider).slider("value",this.zoom)},draw:function(){return this.rendered?void 0:(console.info(this.id+" is not rendered yet"),void 0)},_calculateRegionByZoom:function(){var a=(this.width-this.svgCanvasWidthOffset)/Utils.getPixelBaseByZoom(this.zoom),b=this.region.center(),c=Math.ceil(a/2-1),d=Math.floor(b-c),e=Math.floor(b+c);return{start:d,end:e}},_calculateZoomByRegion:function(){return Utils.getZoomByPixelBase((this.width-this.svgCanvasWidthOffset)/this.region.length())},_handleNavigationBar:function(a){if("GoToGene"==a){var b=Ext.getCmp(this.id+"quickSearch").getValue();null!=b&&("rs"==b.slice(0,"rs".length)||"AFFY_"==b.slice(0,"AFFY_".length)||"SNP_"==b.slice(0,"SNP_".length)||"VAR_"==b.slice(0,"VAR_".length)||"CRTAP_"==b.slice(0,"CRTAP_".length)||"FKBP10_"==b.slice(0,"FKBP10_".length)||"LEPRE1_"==b.slice(0,"LEPRE1_".length)||"PPIB_"==b.slice(0,"PPIB_".length)?this.openSNPListWidget(b):this.openGeneListWidget(b))}},setSpeciesVisible:function(a){a?Ext.getCmp(this.id+"speciesMenuButton").show():Ext.getCmp(this.id+"speciesMenuButton").hide()},setChromosomeMenuVisible:function(a){a?Ext.getCmp(this.id+"chromosomeMenuButton").show():Ext.getCmp(this.id+"chromosomeMenuButton").hide()},setKaryotypePanelButtonVisible:function(a){this.karyotypeButton.setVisible(a)},setChromosomePanelButtonVisible:function(a){this.chromosomeButton.setVisible(a)},setRegionOverviewPanelButtonVisible:function(a){this.regionButton.setVisible(a)},setRegionTextBoxVisible:function(a){a?(Ext.getCmp(this.id+"positionLabel").show(),Ext.getCmp(this+"tbCoordinate").show(),Ext.getCmp(this.id+"GoButton").show()):(Ext.getCmp(this.id+"positionLabel").hide(),Ext.getCmp(this.id+"tbCoordinate").hide(),Ext.getCmp(this.id+"GoButton").hide())},setSearchVisible:function(a){a?(this.searchComboBox.show(),Ext.getCmp(this.id+"GoToGeneButton").show()):(this.searchComboBox.hide(),Ext.getCmp(this.id+"GoToGeneButton").hide())},setFullScreenButtonVisible:function(a){this.fullscreenButton.setVisible(a)}},ChromosomePanel.prototype={show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).html(a)},setWidth:function(a){for(this.width=a,this.svg.setAttribute("width",a),this.tracksViewedRegion=this.width/Utils.getPixelBaseByZoom(this.zoom);this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);this._drawSvg(this.data)},render:function(a){return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="chromosome-panel"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title&&(this.titleDiv=$('<div id="tl-title" class="gv-panel-title unselectable">'+this.title+"</div>")[0],$(this.div).append(this.titleDiv)),this.svg=SVG.init(this.div,{width:this.width,height:this.height}),$(this.div).addClass("unselectable"),this.colors={gneg:"white",stalk:"#666666",gvar:"#CCCCCC",gpos25:"silver",gpos33:"lightgrey",gpos50:"gray",gpos66:"dimgray",gpos75:"darkgray",gpos100:"black",gpos:"gray",acen:"blue",clementina:"#ffc967"},this.rendered=!0,void 0)},setSpecies:function(a){this.species=a},draw:function(){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;for(var a=this;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);var b=function(a,b){return a.start-b.start};console.log("In chromosome-widget: "+this.region);var c=new CellBaseManager(this.species);c.success.addEventListener(function(c,d){a.data=d.result[0],a.data.cytobands.sort(b),a._drawSvg(a.data)}),c.get("feature","chromosome",this.region.chromosome,"info"),this.lastChromosome=this.region.chromosome},_drawSvg:function(a){var b=this;this.chromosomeLength=a.size,b.pixelBase=(b.width-40)/this.chromosomeLength;for(var c=20,d=10,e=!0,f=20,g=b.region.center(),h="",i=g*b.pixelBase+f,j=SVG.addChild(b.svg,"g",{cursor:"pointer"}),k=0;k<a.cytobands.length;k++){var l=a.cytobands[k],m=b.pixelBase*(l.end-l.start),n=18,o=b.colors[l.stain];null==o&&(o="purple");var p=c+m/2,q=d+n;if("acen"==l.stain){var r="",s=d+n/2,t=c+m;e?(r=c+","+d+" "+p+","+d+" "+t+","+s+" "+p+","+q+" "+c+","+q,e=!1):r=c+","+s+" "+p+","+d+" "+t+","+d+" "+t+","+q+" "+p+","+q,SVG.addChild(j,"polyline",{points:r,stroke:"black",opacity:.8,fill:o})}else SVG.addChild(j,"rect",{x:c,y:d,width:m,height:n,stroke:"black",opacity:.8,fill:o});var u=q+2,v=SVG.addChild(j,"text",{x:p,y:u,"font-size":10,transform:"rotate(90, "+p+", "+u+")",fill:"black"});v.textContent=l.name,c+=m}$(this.svg).on("mousedown",function(){h="setRegion"});var w=SVG.addChild(this.svg,"rect",{x:0,y:2,"stroke-width":"2",stroke:"deepskyblue",opacity:"0.5",fill:"honeydew"}),x=b.region.length()*b.pixelBase,y=SVG.addChild(j,"g");this.positionBox=SVG.addChild(y,"rect",{x:i-x/2,y:2,width:x,height:b.height-3,stroke:"orangered","stroke-width":2,opacity:.5,fill:"navajowhite",cursor:"move"}),$(this.positionBox).on("mousedown",function(){h="movePositionBox"});var z=SVG.addChild(y,"rect",{x:i-x/2,y:2,width:5,height:b.height-3,opacity:.5,fill:"orangered",visibility:"hidden"});$(z).on("mousedown",function(){h="resizePositionBoxLeft"});var A=SVG.addChild(y,"rect",{x:x-5,y:2,width:5,height:b.height-3,opacity:.5,fill:"orangered",visibility:"hidden"});$(A).on("mousedown",function(){h="resizePositionBoxRight"}),$(this.positionBox).off("mouseenter"),$(this.positionBox).off("mouseleave");var B=function(){var a=parseInt(b.positionBox.getAttribute("x")),c=parseInt(b.positionBox.getAttribute("width"));z.setAttribute("x",a-5),A.setAttribute("x",a+c),$(z).css({cursor:"ew-resize"}),$(A).css({cursor:"ew-resize"})},C=function(){z.setAttribute("visibility","hidden"),A.setAttribute("visibility","hidden")},D=function(){z.setAttribute("visibility","visible"),A.setAttribute("visibility","visible")};$(y).mouseenter(function(){B(),D()}),$(y).mouseleave(function(){C()}),$(this.svg).off("contextmenu"),$(this.svg).off("mousedown"),$(this.svg).off("mouseup"),$(this.svg).off("mousemove"),$(this.svg).off("mouseleave"),$(this.svg).contextmenu(function(a){a.preventDefault()});var E,F,G;$(this.svg).mousedown(function(a){E=a.pageX-$(b.svg).offset().left,w.setAttribute("x",E),G=b.positionBox.getAttribute("x"),""==h&&(h="setRegion"),C(),$(this).mousemove(function(a){switch(F=a.pageX-$(b.svg).offset().left,C(),h){case"resizePositionBoxLeft":var c=F-E,d=parseInt(b.positionBox.getAttribute("width"))-c;d>0&&(b.positionBox.setAttribute("x",parseInt(b.positionBox.getAttribute("x"))+c),b.positionBox.setAttribute("width",d)),E=F;break;case"resizePositionBoxRight":var c=F-E,d=parseInt(b.positionBox.getAttribute("width"))+c;d>0&&b.positionBox.setAttribute("width",d),E=F;break;case"movePositionBox":var c=F-E;b.positionBox.setAttribute("x",parseInt(b.positionBox.getAttribute("x"))+c),E=F;break;case"setRegion":case"selectingRegion":h="selectingRegion",E>F&&w.setAttribute("x",F),w.setAttribute("width",Math.abs(F-E)),w.setAttribute("height",b.height-3)}})}),$(this.svg).mouseup(function(){if($(this).off("mousemove"),null!=E){switch(h){case"resizePositionBoxLeft":case"resizePositionBoxRight":case"movePositionBox":if(null!=F){var a=parseInt(b.positionBox.getAttribute("width")),c=parseInt(b.positionBox.getAttribute("x")),d=c,e=c+a,g=(d-f)/b.pixelBase,i=(e-f)/b.pixelBase;b.region.start=Math.round(g),b.region.end=Math.round(i),B(),D(),b.trigger("region:change",{region:b.region,sender:b}),B(),D()}break;case"setRegion":var a=b.positionBox.getAttribute("width"),d=E-a/2,e=E+a/2,g=(d-f)/b.pixelBase,i=(e-f)/b.pixelBase;b.region.start=Math.round(g),b.region.end=Math.round(i),b.positionBox.setAttribute("x",E-a/2),b.trigger("region:change",{region:b.region,sender:b});break;case"selectingRegion":var g=(E-f)/b.pixelBase,i=(F-f)/b.pixelBase;b.region.start=parseInt(Math.min(g,i)),b.region.end=parseInt(Math.max(g,i));var a=Math.abs(E-F);b.positionBox.setAttribute("width",a),b.positionBox.setAttribute("x",Math.abs((E+F)/2)-a/2),b.trigger("region:change",{region:b.region,sender:b})}h=""}w.setAttribute("width",0),w.setAttribute("height",0),E=null,F=null,G=b.positionBox.getAttribute("x")}),$(this.svg).mouseleave(function(){$(this).off("mousemove"),null!=G&&b.positionBox.setAttribute("x",G),w.setAttribute("width",0),w.setAttribute("height",0),E=null,F=null,G=null,overPositionBox=!1,movingPositionBox=!1,selectingRegion=!1})},setRegion:function(a){this.region.load(a);var b=!1;this.lastChromosome!=this.region.chromosome&&(b=!0);var c=this.region.length(),d=c*this.pixelBase,e=this.region.start*this.pixelBase+20;this.positionBox.setAttribute("x",e),this.positionBox.setAttribute("width",d),b&&this.draw()}},KaryotypePanel.prototype={show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).html(a)},setWidth:function(a){for(this.width=a,this.svg.setAttribute("width",a);this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);this._drawSvg(this.chromosomeList,this.data2)},render:function(a){return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="karyotype-panel"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title&&(this.titleDiv=$('<div id="tl-title" class="gv-panel-title unselectable">'+this.title+"</div>")[0],$(this.div).append(this.titleDiv)),this.svg=SVG.init(this.div,{width:this.width,height:this.height}),this.markGroup=SVG.addChild(this.svg,"g",{cursor:"pointer"}),$(this.div).addClass("unselectable"),this.colors={gneg:"white",stalk:"#666666",gvar:"#CCCCCC",gpos25:"silver",gpos33:"lightgrey",gpos50:"gray",gpos66:"dimgray",gpos75:"darkgray",gpos100:"black",gpos:"gray",acen:"blue"},this.rendered=!0,void 0)},setSpecies:function(a){this.lastSpecies=this.species,this.species=a},draw:function(){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;for(var a=this;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);var b=function(a,b){for(var c=!0,d=0;d<a.name.length&&1==c;d++)isNaN(a.name[d])&&(c=!1);return c?a.name-b.name:1},c=new CellBaseManager(this.species);c.success.addEventListener(function(c,d){a.chromosomeList=d.result,a.chromosomeList.sort(b),a._drawSvg(a.chromosomeList)}),c.get("feature","chromosome",null,"all")},_drawSvg:function(a){for(var b=this,c=20,d=b.width/a.length,e=2,f=0,g=0,h=a.length;h>g;g++){var i=a[g].size;i>f&&(f=i)}b.pixelBase=(b.height-10)/f,b.chrOffsetY={},b.chrOffsetX={};for(var g=0,h=a.length;h>g;g++){var j=a[g],k=j.size*b.pixelBase,l=e+f*b.pixelBase-k;b.chrOffsetY[j.name]=l;var m=!0,n=b.region.center(),o=n*b.pixelBase,p=SVG.addChild(b.svg,"g",{cursor:"pointer",chr:j.name});$(p).click(function(a){var c=this.getAttribute("chr"),d=a.pageY-$(b.svg).offset().top;b.positionBox.setAttribute("x1",b.chrOffsetX[c]-10),b.positionBox.setAttribute("x2",b.chrOffsetX[c]+23),b.positionBox.setAttribute("y1",d),b.positionBox.setAttribute("y2",d);var e=parseInt((d-b.chrOffsetY[c])/b.pixelBase);b.region.chromosome=c,b.region.start=e,b.region.end=e,b.trigger("region:change",{region:b.region,sender:b})});for(var q=0,r=j.cytobands.length;r>q;q++){var s=j.cytobands[q],t=b.pixelBase*(s.end-s.start),u=13,v=b.colors[s.stain];if(null==v&&(v="purple"),"acen"==s.stain){var w="",x=c+u/2,y=l+t/2,z=c+u,A=l+t;m?(w=c+","+l+" "+z+","+l+" "+z+","+y+" "+x+","+A+" "+c+","+y,m=!1):w=c+","+A+" "+c+","+y+" "+x+","+l+" "+z+","+y+" "+z+","+A,SVG.addChild(p,"polyline",{points:w,stroke:"black",opacity:.8,fill:v})}else SVG.addChild(p,"rect",{x:c,y:l,width:u,height:t,stroke:"grey",opacity:.8,fill:v});l+=t}var B=SVG.addChild(b.svg,"text",{x:c+1,y:b.height,"font-size":9,fill:"black"});B.textContent=j.name,b.chrOffsetX[j.name]=c,c+=d}b.positionBox=SVG.addChild(b.svg,"line",{x1:b.chrOffsetX[b.region.chromosome]-10,y1:o+b.chrOffsetY[b.region.chromosome],x2:b.chrOffsetX[b.region.chromosome]+23,y2:o+b.chrOffsetY[b.region.chromosome],stroke:"orangered","stroke-width":2,opacity:.5}),b.rendered=!0,b.afterRender.notify()},setRegion:function(a){this.region.load(a);var b=!1;console.log(this.lastSpecies!=this.species),this.lastSpecies!=this.species&&(b=!0,this.lastSpecies=this.species);var c=this.region.center(),d=c*this.pixelBase+this.chrOffsetY[this.region.chromosome];this.positionBox.setAttribute("x1",this.chrOffsetX[this.region.chromosome]-10),this.positionBox.setAttribute("x2",this.chrOffsetX[this.region.chromosome]+23),this.positionBox.setAttribute("y1",d),this.positionBox.setAttribute("y2",d),b&&this.draw()},updatePositionBox:function(){this.positionBox.setAttribute("x1",this.chrOffsetX[this.region.chromosome]-10),this.positionBox.setAttribute("x2",this.chrOffsetX[this.region.chromosome]+23);var a=Utils.centerPosition(this.region),b=a*this.pixelBase+this.chrOffsetY[this.region.chromosome];this.positionBox.setAttribute("y1",b),this.positionBox.setAttribute("y2",b)},addMark:function(){var a=this,b=function(){if(null!=a.region.chromosome&&null!=a.region.start&&null!=a.chrOffsetX[a.region.chromosome]){var b=a.chrOffsetX[a.region.chromosome]-10,c=a.chrOffsetX[a.region.chromosome],d=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome]-4,e=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome],f=a.region.start*a.pixelBase+a.chrOffsetY[a.region.chromosome]+4,g=b+","+d+" "+c+","+e+" "+b+","+f+" "+b+","+d;SVG.addChild(a.markGroup,"polyline",{points:g,stroke:"black",opacity:.8,fill:"#33FF33"})}};this.rendered?b():this.afterRender.addEventListener(function(){b()})},unmark:function(){for(;this.markGroup.firstChild;)this.markGroup.removeChild(this.markGroup.firstChild)}},TrackListPanel.prototype={render:function(a){if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;var b=this;if(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="tracklist-panel" style="height:100%;position: relative;"></div>')[0],$(this.targetDiv).append(this.div),"title"in this&&""!==this.title){var c=$('<div id="tl-title" class="gv-panel-title unselectable">'+this.title+"</div>")[0];$(this.div).append(c)}var d=$('<div id="tl-header"></div>')[0],e=$('<div id="tl-panel"></div>')[0];$(e).css({position:"relative",width:"100%"}),this.tlTracksDiv=$('<div id="tl-tracks"></div>')[0],$(this.tlTracksDiv).css({position:"relative","z-index":3}),$(this.div).append(d),$(this.div).append(e),$(e).append(this.tlTracksDiv),this.svgTop=SVG.init(d,{width:this.width,height:25});var f=this.width/2;this.positionText=SVG.addChild(this.svgTop,"text",{x:f-30,y:24,"font-size":12,"font-family":b.fontFamily,fill:"green"}),this.nucleotidText=SVG.addChild(this.svgTop,"text",{x:f+35,y:24,"font-family":b.fontFamily,"font-size":13}),this.firstPositionText=SVG.addChild(this.svgTop,"text",{x:0,y:24,"font-size":12,"font-family":b.fontFamily,fill:"green"}),this.lastPositionText=SVG.addChild(this.svgTop,"text",{x:this.width-70,y:24,"font-size":12,"font-family":b.fontFamily,fill:"green"}),this.viewNtsArrow=SVG.addChild(this.svgTop,"rect",{x:2,y:6,width:this.width-4,height:2,opacity:"0.5",fill:"black"}),this.viewNtsArrowLeft=SVG.addChild(this.svgTop,"polyline",{points:"0,1 2,1 2,13 0,13",opacity:"0.5",fill:"black"}),this.viewNtsArrowRight=SVG.addChild(this.svgTop,"polyline",{points:this.width+",1 "+(this.width-2)+",1 "+(this.width-2)+",13 "+this.width+",13",opacity:"0.5",fill:"black"}),this.windowSize="Window size: "+this.region.length()+" nts",this.viewNtsTextBack=SVG.addChild(this.svgTop,"rect",{x:f-40,y:0,width:6*this.windowSize.length,height:13,fill:"white"}),this.viewNtsText=SVG.addChild(this.svgTop,"text",{x:f-30,y:11,"font-size":12,"font-family":b.fontFamily,fill:"black"}),this.viewNtsText.textContent=this.windowSize,this._setTextPosition(),this.centerLine=$('<div id="'+this.id+'centerLine"></div>')[0],$(e).append(this.centerLine),$(this.centerLine).css({"z-index":2,position:"absolute",left:f,top:0,width:this.pixelBase,height:"100%",opacity:.5,border:"1px solid orangered","background-color":"orange"}),this.mouseLine=$('<div id="'+this.id+'mouseLine"></div>')[0],$(e).append(this.mouseLine),$(this.mouseLine).css({"z-index":1,position:"absolute",left:-20,top:0,width:this.pixelBase,height:"100%",border:"1px solid lightgray",opacity:.7,visibility:"hidden","background-color":"gainsboro"});var g=$('<div id="'+this.id+'selBox"></div>')[0];$(e).append(g),$(g).css({"z-index":0,position:"absolute",left:0,top:0,height:"100%",border:"2px solid deepskyblue",opacity:.5,visibility:"hidden","background-color":"honeydew"}),$(this.div).mousemove(function(a){var c=b.region.center(),d=b.width/2,e=b.pixelBase/2,f=a.clientX-$(b.tlTracksDiv).offset().left,g=f-e,h=0|g/b.pixelBase,i=h*b.pixelBase+d%b.pixelBase;$(b.mouseLine).css({left:i});var j=0|d/b.pixelBase;b.mousePosition=c+h-j,b.trigger("mousePosition:change",{mousePos:b.mousePosition,baseHtml:b.getMousePosition(b.mousePosition)})});var h,i;$(this.tlTracksDiv).mousedown(function(a){switch($("html").addClass("unselectable"),$(b.mouseLine).css({visibility:"hidden"}),a.which){case 1:$(this).css({cursor:"move"}),h=a.clientX;var c=0;$(this).mousemove(function(a){var d=0|(h-a.clientX)/b.pixelBase;if(d!=c){var e=c-d,f=b.region.center(),g=f-e;g>0&&(b.region.start-=e,b.region.end-=e,b._setTextPosition(),b.trigger("region:move",{region:b.region,disp:e,sender:b}),b.trigger("trackRegion:move",{region:b.region,disp:e,sender:b}),c=d,b.setNucleotidPosition(g))}});break;case 2:$(g).css({visibility:"visible"}),$(g).css({width:0}),h=a.pageX-$(b.tlTracksDiv).offset().left,$(g).css({left:h}),$(this).mousemove(function(a){i=a.pageX-$(b.tlTracksDiv).offset().left,h>i&&$(g).css({left:i}),$(g).css({width:Math.abs(i-h)})});break;case 3:}}),$(this.tlTracksDiv).mouseup(function(a){switch($("html").removeClass("unselectable"),$(this).css({cursor:"default"}),$(b.mouseLine).css({visibility:"visible"}),$(this).off("mousemove"),a.which){case 1:break;case 2:if($(g).css({visibility:"hidden"}),$(this).off("mousemove"),null!=h&&null!=i){var c=h/b.pixelBase,d=i/b.pixelBase;c+=b.visualRegion.start,d+=b.visualRegion.start,b.region.start=parseInt(Math.min(c,d)),b.region.end=parseInt(Math.max(c,d)),b.trigger("region:change",{region:b.region,sender:b}),b.onRegionSelect.notify(),i=null}else if(null!=h&&null==i){var e=new Region({chromosome:b.region.chromosome,start:b.mousePosition,end:b.mousePosition});b.trigger("region:change",{region:e,sender:b})}break;case 3:}}),$(this.tlTracksDiv).mouseleave(function(){$(this).css({cursor:"default"}),$(b.mouseLine).css({visibility:"hidden"}),$(this).off("mousemove"),$("body").off("keydown"),$(g).css({visibility:"hidden"}),h=null,i=null}),$(this.tlTracksDiv).mouseenter(function(){$(b.mouseLine).css({visibility:"visible"}),$("body").off("keydown"),j()});var j=function(){$("body").keydown(function(a){var c=0;switch(a.keyCode){case 37:c=a.ctrlKey?Math.round(100/b.pixelBase):Math.round(10/b.pixelBase);break;case 39:c=a.ctrlKey?Math.round(-100/b.pixelBase):Math.round(-10/b.pixelBase);break;case 109:a.shiftKey&&console.log("zoom out");break;case 107:a.shiftKey&&console.log("zoom in")}0!=c&&(b.region.start-=c,b.region.end-=c,b._setTextPosition(),b.trigger("region:move",{region:b.region,disp:c,sender:b}),b.trigger("trackRegion:move",{region:b.region,disp:c,sender:b}))})};this.rendered=!0},show:function(){$(this.div).css({display:"block"})},hide:function(){$(this.div).css({display:"none"})},setVisible:function(a){a?$(this.div).css({display:"block"}):$(this.div).css({display:"none"})},setTitle:function(a){"titleDiv"in this&&$(this.titleDiv).html(a)},setHeight:function(){},setWidth:function(a){console.log(a),this.width=a-18;var b=this.width/2;this._setPixelBaseAndZoom(),$(this.centerLine).css({left:b,width:this.pixelBase}),$(this.mouseLine).css({width:this.pixelBase}),this.svgTop.setAttribute("width",this.width),this.positionText.setAttribute("x",b-30),this.nucleotidText.setAttribute("x",b+35),this.lastPositionText.setAttribute("x",this.width-70),this.viewNtsArrow.setAttribute("width",this.width-4),this.viewNtsArrowRight.setAttribute("points",this.width+",1 "+(this.width-2)+",1 "+(this.width-2)+",13 "+this.width+",13"),this.viewNtsText.setAttribute("x",b-30),this.viewNtsTextBack.setAttribute("x",b-40),this.trigger("trackWidth:change",{width:this.width,sender:this}),this._setTextPosition()},setZoom:function(){},highlight:function(a){this.trigger("trackFeature:highlight",a)},moveRegion:function(a){this.region.load(a.region),this.visualRegion.load(a.region),this._setTextPosition(),this.trigger("trackRegion:move",a)},setSpecies:function(a){this.species=a,this.trigger("trackSpecies:change",{species:a,sender:this})},setRegion:function(a){var b=this;this.region.load(a),this.visualRegion.load(a),this._setPixelBaseAndZoom(),$(this.centerLine).css({width:this.pixelBase}),$(this.mouseLine).css({width:this.pixelBase}),this.viewNtsText.textContent="Window size: "+this.region.length()+" nts",this.windowSize=this.viewNtsText.textContent,this._setTextPosition(),this.onWindowSize.notify({windowSize:this.viewNtsText.textContent}),this.trigger("trackRegion:change",{region:this.region,sender:this}),this.nucleotidText.textContent="";var c=function(a){for(i in b.trackSvgList)if(b.trackSvgList[i].status!=a)return!1;return!0},d=function(){c("ready")?b.trigger("tracks:ready",{sender:b}):setTimeout(d,100)};setTimeout(d,10)},draw:function(){this.trigger("track:draw",{sender:this})},addTrack:function(a){if(!this.rendered)return console.info(this.id+" is not rendered yet"),void 0;var b=this,c=this.trackSvgList.push(a);this.swapHash[a.id]={index:c-1,visible:!0},a.set("pixelBase",this.pixelBase),a.set("zoom",this.zoom),a.set("region",this.region),a.set("width",this.width),a.rendered||a.render(this.tlTracksDiv),a.draw(),a.set("track:draw",function(){a.draw()}),a.set("trackSpecies:change",function(b){a.setSpecies(b.species)}),a.set("trackRegion:change",function(c){a.set("pixelBase",b.pixelBase),a.set("zoom",b.zoom),a.set("region",c.region),a.draw()}),a.set("trackRegion:move",function(c){a.set("region",c.region),a.set("pixelBase",b.pixelBase),a.set("zoom",b.zoom),a.move(c.disp)}),a.set("trackWidth:change",function(c){a.setWidth(c.width),a.set("pixelBase",b.pixelBase),a.set("zoom",b.zoom),a.draw()}),a.set("trackFeature:highlight",function(b){var c=b.attrName||"feature_id";if("attrValue"in b){b.attrValue=$.isArray(b.attrValue)?b.attrValue:[b.attrValue];for(var d in b.attrValue){var e=c+"~="+b.attrValue[d],f=$(a.svgdiv).find("g["+e+"]");$(f).each(function(){var b=$(this).find("animate");b=0==b.length?SVG.addChild(this,"animate",{attributeName:"opacity",attributeType:"XML",begin:"indefinite",from:"0.0",to:"1",begin:"0s",dur:"0.5s",repeatCount:"5"}):b[0];var c=$(f).find("rect").attr("y");$(a.svgdiv).scrollTop(c),b.beginElement()})}}}),this.on("track:draw",a.get("track:draw")),this.on("trackSpecies:change",a.get("trackSpecies:change")),this.on("trackRegion:change",a.get("trackRegion:change")),this.on("trackRegion:move",a.get("trackRegion:move")),this.on("trackWidth:change",a.get("trackWidth:change")),this.on("trackFeature:highlight",a.get("trackFeature:highlight"))},removeTrack:function(a){this._hideTrack(a);var b=this.swapHash[a].index,c=this.trackSvgList.splice(b,1)[0];delete this.swapHash[a],this.off("track:draw",c.get("track:draw")),this.off("trackSpecies:change",c.get("trackSpecies:change")),this.off("trackRegion:change",c.get("trackRegion:change")),this.off("trackRegion:move",c.get("trackRegion:move")),this.off("trackWidth:change",c.set("trackWidth:change")),this.off("trackFeature:highlight",c.get("trackFeature:highlight"));for(var b=0;b<this.trackSvgList.length;b++)this.swapHash[this.trackSvgList[b].id].index=b;return c},restoreTrack:function(a,b){this.addTrack(a),null!=b&&this.setTrackIndex(a.id,b)},_redraw:function(){$(this.tlTracksDiv);for(var a=0;a<this.trackSvgList.length;a++){var b=this.trackSvgList[a];$(b.div).detach(),this.swapHash[b.id].visible&&$(this.tlTracksDiv).append(b.div)}},_reallocateAbove:function(a){var b=this.swapHash[a].index;if(console.log(b+" wants to move up"),b>0){var c=this.trackSvgList[b-1],d=this.trackSvgList[b],e=parseInt(c.main.getAttribute("y")),f=parseInt(d.main.getAttribute("height"));c.main.setAttribute("y",e+f),d.main.setAttribute("y",e),this.trackSvgList[b]=c,this.trackSvgList[b-1]=d,this.swapHash[c.id].index=b,this.swapHash[d.id].index=b-1}else console.log("is at top")},_reallocateUnder:function(a){var b=this.swapHash[a].index;if(console.log(b+" wants to move down"),b+1<this.trackSvgList.length){var c=this.trackSvgList[b],d=this.trackSvgList[b+1],e=parseInt(c.main.getAttribute("y")),f=parseInt(d.main.getAttribute("height"));c.main.setAttribute("y",e+f),d.main.setAttribute("y",e),this.trackSvgList[b]=d,this.trackSvgList[b+1]=c,this.swapHash[d.id].index=b,this.swapHash[c.id].index=b+1}else console.log("is at bottom")},setTrackIndex:function(a,b){var c=this.swapHash[a].index,d=this.trackSvgList.splice(c,1)[0];this.trackSvgList.splice(b,0,d);for(var e=0;e<this.trackSvgList.length;e++)this.swapHash[this.trackSvgList[e].id].index=e;this._redraw()},scrollToTrack:function(a){var b=this.swapHash[a];if(null!=b){var c=b.index,d=this.trackSvgList[c],e=$(d.div).position().top;$(this.tlTracksDiv).scrollTop(e)}},_hideTrack:function(a){this.swapHash[a].visible=!1;var b=this.swapHash[a].index,c=this.trackSvgList[b];$(c.div).css({display:"hidden"}),this._redraw()},_showTrack:function(a){this.swapHash[a].visible=!0;var b=this.swapHash[a].index,c=this.trackSvgList[b];$(c.div).css({display:"auto"}),this._redraw()},_setPixelBaseAndZoom:function(){this.pixelBase=this.width/this.region.length(),this.pixelBase=this.pixelBase/this.zoomMultiplier,this.pixelBase=Math.max(this.pixelBase,10/Math.pow(2,20)),this.halfVirtualBase=3*this.width/2/this.pixelBase,this.zoom=Utils.getZoomByPixelBase(this.pixelBase)},_setTextPosition:function(){var a=this.region.center(),b=parseInt(this.width/this.pixelBase),c=Math.ceil(b/2-1);this.visualRegion.start=Math.floor(a-c),this.visualRegion.end=Math.floor(a+c),this.positionText.textContent=Utils.formatNumber(a),this.firstPositionText.textContent=Utils.formatNumber(this.visualRegion.start),this.lastPositionText.textContent=Utils.formatNumber(this.visualRegion.end),this.viewNtsText.textContent="Window size: "+this.visualRegion.length()+" nts",this.viewNtsTextBack.setAttribute("width",6*this.viewNtsText.textContent.length),this.windowSize=this.viewNtsText.textContent},getTrackSvgById:function(a){if(null!=this.swapHash[a]){var b=this.swapHash[a].index;return this.trackSvgList[b]}return null},getMousePosition:function(a){var b="",c="";return a>0&&(b=this.getSequenceNucleotid(a),c="color:"+SEQUENCE_COLORS[b]),'<span style="'+c+'">'+b+"</span>"},getSequenceNucleotid:function(a){var b=this.getTrackSvgById(1);return null!=b&&this.zoom>=b.visibleRange.start-this.zoomOffset&&this.zoom<=b.visibleRange.end?b.dataAdapter.getNucleotidByPosition({start:a,end:a,chromosome:this.region.chromosome}):""},setNucleotidPosition:function(a){var b=this.getSequenceNucleotid(a);this.nucleotidText.setAttribute("fill",SEQUENCE_COLORS[b]),this.nucleotidText.textContent=b}},StatusBar.prototype={render:function(a){return this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1?(console.log("targetId not found in DOM"),void 0):(this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="'+this.id+'" class="gv-status-bar" align="right"></div>')[0],$(this.targetDiv).append(this.div),this.mousePositionDiv=$('<div id="'+this.id+'position" style="display: inline">&nbsp;</div>')[0],$(this.mousePositionDiv).css({"margin-left":"5px","margin-right":"5px","font-size":"12px"}),this.versionDiv=$('<div id="'+this.id+'version" style="display: inline">'+this.version+"</div>")[0],$(this.versionDiv).css({"margin-left":"5px","margin-right":"5px"}),$(this.div).append(this.mousePositionDiv),$(this.div).append(this.versionDiv),this.rendered=!0,void 0)},setRegion:function(a){this.region.load(a.region),$(this.mousePositionDiv).html(Utils.formatNumber(a.region.center()))},setMousePosition:function(a){$(this.mousePositionDiv).html(a.baseHtml+" "+this.region.chromosome+":"+Utils.formatNumber(a.mousePos))}},LegendPanel.prototype.getColorItems=function(a){panelsArray=new Array;for(var b in a){var c=15,d=Ext.create("Ext.draw.Component",{width:c,height:c,items:[{type:"rect",fill:a[b],x:0,y:0,width:c,height:c}]}),e=Utils.formatText(b,"_"),f=Ext.create("Ext.panel.Panel",{height:c,border:!1,flex:1,margin:"1 0 0 1",layout:{type:"hbox",align:"stretch"},items:[d,{xtype:"tbtext",text:e,margin:"1 0 0 3"}]});panelsArray.push(f)}return panelsArray},LegendPanel.prototype.getPanel=function(a){if(null==this.panel){var b=this.getColorItems(a);this.panel=Ext.create("Ext.panel.Panel",{bodyPadding:"0 0 0 2",border:!1,layout:{type:"vbox",align:"stretch"},items:b,width:this.width,height:20*b.length})}return this.panel},LegendPanel.prototype.getButton=function(a){return null==this.button&&(this.button=Ext.create("Ext.button.Button",{text:this.title,menu:{plain:!0,items:[this.getPanel(a)]}})),this.button},LegendWidget.prototype.draw=function(a){var b=this;if(null==this.panel){var c=this.legendPanel.getPanel(a);this.panel=Ext.create("Ext.ux.Window",{title:this.title,resizable:!1,constrain:!0,closable:!0,width:c.width+10,height:c.height+70,items:[c],buttonAlign:"right",layout:{type:"hbox",align:"stretch"},buttons:[{text:"Close",handler:function(){b.panel.close()}}]})}this.panel.show()},Track.prototype={get:function(a){return this[a]},set:function(a,b){this[a]=b},setSpecies:function(a){this.species=a,this.dataAdapter.species=this.species},setWidth:function(a){this.width=a,this.main.setAttribute("width",a)},updateHeight:function(){if(this.histogram)var a=this.height;else var a=20*Object.keys(this.renderedArea).length;this.main.setAttribute("height",a),this.svgCanvasFeatures.setAttribute("height",a),this.titlebar.setAttribute("height",a)
},setTitle:function(a){$(this.titlediv).html(a)},setLoading:function(a){a?(this.svgLoading.setAttribute("visibility","visible"),this.status="rendering"):(this.svgLoading.setAttribute("visibility","hidden"),this.status="ready")},updateHistogramParams:function(){this.zoom<=this.histogramZoom?(this.histogram=!0,this.histogramLogarithm=!0,this.histogramMax=500,this.interval=parseInt(5/this.pixelBase)):(this.histogram=void 0,this.histogramLogarithm=void 0,this.histogramMax=void 0)},cleanSvg:function(){for(;this.svgCanvasFeatures.firstChild;)this.svgCanvasFeatures.removeChild(this.svgCanvasFeatures.firstChild);this.chunksDisplayed={},this.renderedArea={}},initializeDom:function(a){var b=this,c=$('<div id="'+this.id+'-div"></div>')[0],d=$('<div id="'+this.id+'-titlediv">'+this.title+"</div>")[0],e=$('<div id="'+this.id+'-svgdiv"></div>')[0];$(a).addClass("unselectable"),$(a).append(c),$(c).append(d),$(c).append(e),$(d).css({"font-family":"Source Sans Pro","font-size":"14px",height:"16px"}),$(e).css({"z-index":3,height:this.height,"overflow-y":this.resizable?"auto":"hidden","overflow-x":"hidden"});var f=SVG.addChild(e,"svg",{id:this.id,"class":"trackSvg",x:0,y:0,width:this.width,height:this.height});if(this.resizable){var g=$('<div id="'+this.id+'-resizediv"></div>')[0];$(g).css({"background-color":"lightgray",height:3,opacity:.3}),$(g).mousedown(function(a){$("html").addClass("unselectable"),a.stopPropagation();var b=a.clientY;$("html").mousemove(function(a){var c=a.clientY-b,d=$(e).outerHeight();$(e).css({height:d+c}),b=a.clientY})}),$("html").mouseup(function(){$("html").removeClass("unselectable"),$("html").off("mousemove")}),$(g).mouseenter(function(){$(this).css({cursor:"ns-resize"}),$(this).css({opacity:1})}),$(g).mouseleave(function(){$(this).css({cursor:"default"}),$(this).css({opacity:.3})}),$(c).append(g)}var h=SVG.addChild(f,"g",{"class":"trackTitle"}),i=this.title;15+6*i.length;var j=SVG.addChild(h,"rect",{x:0,y:0,width:this.width,height:this.height,opacity:"0.6",fill:"transparent"});this.svgCanvasFeatures=SVG.addChild(h,"svg",{"class":"features",x:-this.pixelPosition,width:this.svgCanvasWidth,height:this.height}),this.fnTitleMouseEnter=function(){j.setAttribute("opacity","0.1"),j.setAttribute("fill","greenyellow")},this.fnTitleMouseLeave=function(){j.setAttribute("opacity","0.6"),j.setAttribute("fill","transparent")},$(h).off("mouseenter"),$(h).off("mouseleave"),$(h).mouseenter(this.fnTitleMouseEnter),$(h).mouseleave(this.fnTitleMouseLeave),this.invalidZoomText=SVG.addChild(h,"text",{x:154,y:18,"font-size":12,"font-family":b.fontFamily,opacity:"0.6",fill:"black",visibility:"hidden"}),this.invalidZoomText.textContent="This level of zoom isn't appropiate for this track";var k='<?xml version="1.0" encoding="utf-8"?><svg version="1.1" width="22px" height="22px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><g id="pair"><ellipse cx="7" cy="0" rx="4" ry="1.7" style="fill:#ccc; fill-opacity:0.5;"/><ellipse cx="-7" cy="0" rx="4" ry="1.7" style="fill:#aaa; fill-opacity:1.0;"/></g></defs><g transform="translate(11,11)"><g><animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="1.5s" repeatDur="indefinite"/><use xlink:href="#pair"/><use xlink:href="#pair" transform="rotate(45)"/><use xlink:href="#pair" transform="rotate(90)"/><use xlink:href="#pair" transform="rotate(135)"/></g></g></svg>';this.svgLoading=SVG.addChildImage(f,{"xlink:href":"data:image/svg+xml,"+encodeURIComponent(k),x:10,y:0,width:22,height:22,visibility:"hidden"}),this.div=c,this.svgdiv=e,this.titlediv=d,this.main=f,this.titleGroup=h,this.titlebar=j,this.rendered=!0,this.status="ready"},draw:function(){}},FeatureTrack.prototype=new Track({}),FeatureTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){b.renderer=1==a.params.histogram?b.histogramRenderer:b.defaultRenderer;var c=b._getFeaturesByChunks(a);b.renderer.render(c,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),width:b.width,zoom:b.zoom,labelZoom:b.labelZoom,pixelPosition:b.pixelPosition}),b.updateHeight(),b.setLoading(!1)})},FeatureTrack.prototype.draw=function(){this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateHistogramParams(),this.cleanSvg(),this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end?(this.setLoading(!0),this.dataAdapter.getData({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible")},FeatureTrack.prototype.move=function(a){var b=this;b.region.center();var c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end&&(a>0&&e<this.svgCanvasLeftLimit&&(this.dataAdapter.getData({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(this.dataAdapter.getData({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset),histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},FeatureTrack.prototype._getFeaturesByChunks=function(a){for(var b,c,d,e,f=a.items,g=a.params.dataType,h=a.params.chromosome,i=[],i=[],j=0,k=f.length;k>j;j++)if(1!=this.chunksDisplayed[f[j].key+g]){for(var l=0,m=f[j][g].length;m>l;l++){b=f[j][g][l],c=!1,d=this.dataAdapter.featureCache._getChunk(b.start),e=this.dataAdapter.featureCache._getChunk(b.end);for(var n=d;e>=n;n++){var o=h+":"+n;if(1==this.chunksDisplayed[o+g]){c=!0;break}}c||i.push(b)}this.chunksDisplayed[f[j].key+g]=!0}return i},GeneTrack.prototype=new Track({}),GeneTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){b.renderer=1==a.params.histogram?b.histogramRenderer:b.defaultRenderer;var c=b._getFeaturesByChunks(a);b.renderer.render(c,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),width:b.width,zoom:b.zoom,labelZoom:b.labelZoom,pixelPosition:b.pixelPosition}),b.updateHeight(),b.setLoading(!1)}),this.renderer.on("feature:click",function(a){b.showInfoWidget(a)})},GeneTrack.prototype.updateTranscriptParams=function(){this.transcript=this.transcriptZoom<=this.zoom?!0:!1},GeneTrack.prototype.draw=function(){this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateTranscriptParams(),this.updateHistogramParams(),this.cleanSvg(),this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end?(this.setLoading(!0),this.dataAdapter.getData({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset,transcript:this.transcript,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible")},GeneTrack.prototype.move=function(a){var b=this;b.region.center();var c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end&&(a>0&&e<this.svgCanvasLeftLimit&&(console.log("left"),this.dataAdapter.getData({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit,transcript:this.transcript,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(console.log("right"),this.dataAdapter.getData({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset),transcript:this.transcript,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},GeneTrack.prototype._getFeaturesByChunks=function(a){for(var b,c,d,e,f=a.items,g=a.params.dataType,h=a.params.chromosome,i=[],i=[],j=0,k=f.length;k>j;j++)if(1!=this.chunksDisplayed[f[j].key+g]){for(var l=0,m=f[j][g].length;m>l;l++){b=f[j][g][l],c=!1,d=this.dataAdapter.featureCache._getChunk(b.start),e=this.dataAdapter.featureCache._getChunk(b.end);for(var n=d;e>=n;n++){var o=h+":"+n;if(1==this.chunksDisplayed[o+g]){c=!0;break}}c||i.push(b)}this.chunksDisplayed[f[j].key+g]=!0}return i},GeneTrack.prototype.showInfoWidget=function(a){switch(a.featureType){case"gene":new GeneInfoWidget(null,this.dataAdapter.species).draw(a);break;case"transcript":new TranscriptInfoWidget(null,this.dataAdapter.species).draw(a)}},SequenceTrack.prototype=new Track({}),SequenceTrack.prototype.render=function(a){var b=this;this.initializeDom(a),this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.dataAdapter.on("data:ready",function(a){b.renderer=1==a.params.histogram?HistogramRender:b.defaultRenderer,b.renderer.render(a,{svgCanvasFeatures:b.svgCanvasFeatures,featureTypes:b.featureTypes,renderedArea:b.renderedArea,pixelBase:b.pixelBase,position:b.region.center(),width:b.width,zoom:b.zoom,labelZoom:b.labelZoom,pixelPosition:b.pixelPosition}),b.setLoading(!1)})},SequenceTrack.prototype.draw=function(){this.svgCanvasOffset=3*this.width/2/this.pixelBase,this.svgCanvasLeftLimit=this.region.start-2*this.svgCanvasOffset,this.svgCanvasRightLimit=this.region.start+2*this.svgCanvasOffset,this.updateHistogramParams(),this.cleanSvg(),this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end?(this.setLoading(!0),this.dataAdapter.getData({chromosome:this.region.chromosome,start:this.region.start-2*this.svgCanvasOffset,end:this.region.end+2*this.svgCanvasOffset,histogram:this.histogram,histogramLogarithm:this.histogramLogarithm,histogramMax:this.histogramMax,interval:this.interval}),this.invalidZoomText.setAttribute("visibility","hidden")):this.invalidZoomText.setAttribute("visibility","visible")},SequenceTrack.prototype.move=function(a){var b=this,c=a*b.pixelBase;this.pixelPosition-=c;var d=parseFloat(this.svgCanvasFeatures.getAttribute("x"))+c;this.svgCanvasFeatures.setAttribute("x",d);var e=parseInt(this.region.start-this.svgCanvasOffset),f=parseInt(this.region.end+this.svgCanvasOffset);this.zoom>=this.visibleRange.start&&this.zoom<=this.visibleRange.end&&(a>0&&e<this.svgCanvasLeftLimit&&(this.dataAdapter.getData({chromosome:b.region.chromosome,start:parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset),end:this.svgCanvasLeftLimit,histogram:this.histogram,interval:this.interval,sender:"move"}),this.svgCanvasLeftLimit=parseInt(this.svgCanvasLeftLimit-this.svgCanvasOffset)),0>a&&f>this.svgCanvasRightLimit&&(this.dataAdapter.getData({chromosome:b.region.chromosome,start:this.svgCanvasRightLimit,end:parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset),histogram:this.histogram,interval:this.interval,transcript:this.transcript,sender:"move"}),this.svgCanvasRightLimit=parseInt(this.svgCanvasRightLimit+this.svgCanvasOffset)))},Renderer.prototype={render:function(){},getFeatureX:function(a,b){var c=b.width/2,d=b.pixelPosition+c-(b.position-a.start)*b.pixelBase;return d},getDefaultConfig:function(a){return FEATURE_TYPES[a]}},FeatureRenderer.prototype=new Renderer({}),FeatureRenderer.prototype.render=function(a,b){for(var c=this,d=(function(a){var d=_.isFunction(c.color)?c.color(a):c.color,f=_.isFunction(c.label)?c.label(a,b.zoom):c.label,g=_.isFunction(c.height)?c.height(a):c.height,h=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,i=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText,j=_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId,k=a.start,l=a.end,m=l-k+1;m=0>m?Math.abs(m):m,m=0==m?1:m;var n=m*b.pixelBase,o=c.getFeatureX(a,b),p=Math.max(n,2),q=0;b.zoom>b.labelZoom&&(q=9,p=Math.max(n,8*f.length));for(var r=0,s=q+g,t=q+g+2;;){r in b.renderedArea||(b.renderedArea[r]=new FeatureBinarySearchTree);var u=b.renderedArea[r].add({start:o,end:o+p-1});if(u){var v=SVG.addChild(b.svgCanvasFeatures,"g",{feature_id:a.id});if(SVG.addChild(v,"rect",{x:o,y:r,width:n,height:g,stroke:"#3B0B0B","stroke-width":1,"stroke-opacity":.7,fill:d,cursor:"pointer"}),b.zoom>b.labelZoom){var w=SVG.addChild(v,"text",{i:e,x:o,y:s,"font-size":12,"font-family":c.fontFamily,"font-weight":400,opacity:null,fill:"black",cursor:"pointer"});w.textContent=f}"tooltipText"in c&&$(v).qtip({content:{text:i,title:h},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:"font-lato ui-tooltip ui-tooltip-shadow"}}),$(v).mouseover(function(b){c.trigger("feature:mouseover",{query:a[j],feature:a,featureType:a.featureType,mouseoverEvent:b})}),$(v).click(function(b){c.trigger("feature:click",{query:a[j],feature:a,featureType:a.featureType,clickEvent:b})});break}r+=t,s+=t}}),e=0,f=a.length;f>e;e++)d(a[e])},GeneRenderer.prototype=new Renderer({}),GeneRenderer.prototype.setFeatureConfig=function(a){_.extend(this,this.getDefaultConfig(a))},GeneRenderer.prototype.render=function(a,b){for(var c=this,d=(function(a){c.setFeatureConfig("gene");var d=_.isFunction(c.color)?c.color(a):c.color,e=_.isFunction(c.label)?c.label(a,b.zoom):c.label,f=_.isFunction(c.height)?c.height(a):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(a):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(a):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(a):c.infoWidgetId,j=a.start,k=a.end,l=k-j+1,m=l*b.pixelBase,n=c.getFeatureX(a,b),o=Math.max(m,2),p=0;b.zoom>b.labelZoom&&(p=9,o=Math.max(m,8*e.length));for(var q=0,r=p+f+1,s=p+f+5;;){q in b.renderedArea||(b.renderedArea[q]=new FeatureBinarySearchTree);var t,u=q;if(null!=a.transcripts)for(var v=0,w=a.transcripts.length+1;w>v&&(u in b.renderedArea||(b.renderedArea[u]=new FeatureBinarySearchTree),t=!b.renderedArea[u].contains({start:n,end:n+o-1}),0!=t);v++)u+=s;else t=b.renderedArea[q].add({start:n,end:n+o-1});if(t){var x=SVG.addChild(b.svgCanvasFeatures,"rect",{x:n,y:q,width:m,height:f,stroke:"#3B0B0B","stroke-width":.5,fill:d,cursor:"pointer",feature_id:a.id}),y=SVG.addChild(b.svgCanvasFeatures,"text",{i:v,x:n,y:r,"font-size":12,"font-family":c.fontFamily,fill:"black",cursor:"pointer"});y.textContent=e,$([x,y]).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:"font-lato ui-tooltip ui-tooltip-shadow"}}),$([x,y]).click(function(b){c.trigger("feature:click",{query:a[i],feature:a,featureType:a.featureType,clickEvent:b})});var u=q+s,z=r+s;if(null!=a.transcripts)for(var v=0,w=a.transcripts.length;w>v;v++){u in b.renderedArea||(b.renderedArea[u]=new FeatureBinarySearchTree);var A=a.transcripts[v],B=c.getFeatureX(A,b),C=(A.end-A.start+1)*b.pixelBase;c.setFeatureConfig("transcript");var D=_.isFunction(c.color)?c.color(A):c.color,e=_.isFunction(c.label)?c.label(A):c.label,f=_.isFunction(c.height)?c.height(A):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(A):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(A):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(A):c.infoWidgetId,o=Math.max(m,m-(a.end-A.start)*b.pixelBase+7*e.length);b.renderedArea[u].add({start:n,end:n+o-1});var E=SVG.addChild(b.svgCanvasFeatures,"g",{widgetId:A[i]}),x=SVG.addChild(E,"rect",{x:B,y:u+1,width:C,height:f,fill:"gray",cursor:"pointer",feature_id:A.id}),y=SVG.addChild(E,"text",{x:B,y:z,"font-size":12,"font-family":c.fontFamily,opacity:null,fill:"black",cursor:"pointer"});y.textContent=e,$(E).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:"font-lato ui-tooltip ui-tooltip-shadow"}}),$(E).click(function(a){var b=this.getAttribute("widgetId");c.trigger("feature:click",{query:b,feature:A,featureType:A.featureType,clickEvent:a})});for(var F=0,G=a.transcripts[v].exons.length;G>F;F++){var H=a.transcripts[v].exons[F],I=parseInt(H.start),J=parseInt(H.end),K=b.width/2,L=b.pixelPosition+K-(b.position-I)*b.pixelBase,M=(J-I+1)*b.pixelBase;c.setFeatureConfig("exon");var d=_.isFunction(c.color)?c.color(H):c.color,e=_.isFunction(c.label)?c.label(H):c.label,f=_.isFunction(c.height)?c.height(H):c.height,g=_.isFunction(c.tooltipTitle)?c.tooltipTitle(H):c.tooltipTitle,h=_.isFunction(c.tooltipText)?c.tooltipText(H,A):c.tooltipText,i=_.isFunction(c.infoWidgetId)?c.infoWidgetId(H):c.infoWidgetId,N=SVG.addChild(b.svgCanvasFeatures,"g");$(N).qtip({content:{text:h,title:g},position:{target:"mouse",adjust:{x:25,y:15}},style:{width:!0,classes:"font-lato ui-tooltip ui-tooltip-shadow"}}),SVG.addChild(N,"rect",{i:v,x:L,y:u-1,width:M,height:f,stroke:"gray","stroke-width":1,fill:"white",cursor:"pointer"});var O=0,P=0;A.genomicCodingStart>I&&A.genomicCodingStart<J?(O=parseInt(A.genomicCodingStart),P=J):A.genomicCodingEnd>I&&A.genomicCodingEnd<J?(O=I,P=parseInt(A.genomicCodingEnd)):A.genomicCodingStart<I&&A.genomicCodingEnd>J&&(O=I,P=J);var Q=P-O,R=b.pixelPosition+K-(b.position-O)*b.pixelBase,S=(Q+1)*b.pixelBase;if(Q>0){SVG.addChild(N,"rect",{i:v,x:R,y:u-1,width:S,height:f,stroke:D,"stroke-width":1,fill:D,cursor:"pointer"});for(var T=0,U=3-H.phase;U>T&&10==Math.round(b.pixelBase)&&-1!=H.phase;T++)SVG.addChild(N,"rect",{i:v,x:R+10*T,y:u-1,width:b.pixelBase,height:f,stroke:d,"stroke-width":1,fill:"white",cursor:"pointer"})}}u+=s,z+=s}break}q+=s,r+=s}}),e=0,f=a.length;f>e;e++)d(a[e])},HistogramRenderer.prototype=new Renderer({}),HistogramRenderer.prototype.render=function(a,b){var c=b.width/2,d=5,e=75,f="";if(a.length>0){var g=a[0],h=(g.end-g.start)*b.pixelBase,i=b.pixelPosition+c-(b.position-parseInt(g.start))*b.pixelBase;f=i+h/2+","+e+" "}for(var j=0,k=a.length;k>j;j++){var l=a[j];l.start=parseInt(l.start),l.end=parseInt(l.end);var h=l.end-l.start;try{var m=b.featureTypes[l.featureType],n=m.histogramColor}catch(o){var n="gray"}h*=b.pixelBase;var i=b.pixelPosition+c-(b.position-l.start)*b.pixelBase,p=a[j].features_count;null==p?(p=a[j].value,p=e*p):p*=d,f+=i+h/2+","+(e-p)+" "}if(a.length>0){var q=a[a.length-1],h=(q.end-q.start)*b.pixelBase,i=b.pixelPosition+c-(b.position-parseInt(q.start))*b.pixelBase;f+=i+h/2+","+e+" "}SVG.addChild(b.svgCanvasFeatures,"polyline",{points:f,stroke:"#000000","stroke-width":.2,fill:n,cursor:"pointer"})},SequenceRenderer.prototype=new Renderer({}),SequenceRenderer.prototype.render=function(a,b){console.time("Sequence render "+a.items.sequence.length);var c="16";95==this.zoom&&(c="10");for(var d=b.width/2,e=a.items.start,f=a.items.start,g=a.items.sequence,h=0;h<g.length;h++){var i=b.pixelPosition+d-(b.position-e)*b.pixelBase;e++;var j=SVG.addChild(b.svgCanvasFeatures,"text",{x:i+1,y:12,"font-size":c,"font-family":"Ubuntu Mono",fill:SEQUENCE_COLORS[g.charAt(h)]});j.textContent=g.charAt(h),$(j).qtip({content:g.charAt(h)+" "+(f+h).toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),position:{target:"mouse",adjust:{x:15,y:0},viewport:$(window),effect:!1},style:{width:!0,classes:"font-lato qtip-light qtip-shadow"}})}console.timeEnd("Sequence render "+a.items.sequence.length)},FileWidget.prototype.getTitleName=function(){return this.trackNameField.getValue()},FileWidget.prototype.getFileFromServer=function(){},FileWidget.prototype.loadFileFromLocal=function(){},FileWidget.prototype.getFileUpload=function(){var a=this;return this.uploadField=Ext.create("Ext.form.field.File",{msgTarget:"side",flex:1,padding:1,emptyText:"Choose a file",allowBlank:!1,anchor:"100%",buttonText:"Browse local",listeners:{change:{fn:function(){a.panel.setLoading();var b=document.getElementById(a.uploadField.fileInputEl.id).files[0];a.trackNameField.setValue(b.name),a.fileNameLabel.setText('<span class="emph">'+b.name+'</span> <span class="info">(local)</span>',!1),a.loadFileFromLocal(b),a.panel.setLoading(!1)}}}}),this.uploadField},FileWidget.prototype.draw=function(){var a=this;if(null==this.openDialog){var b=Ext.create("Ext.toolbar.Toolbar");this.featureCountLabel=Ext.create("Ext.toolbar.TextItem",{text:'<span class="dis">No file loaded</span>'}),b.add([this.featureCountLabel]);var c=Ext.create("Ext.toolbar.Toolbar",{cls:"bio-border-false"});c.add(this.getFileUpload()),this.panel=Ext.create("Ext.panel.Panel",{border:!1,cls:"panel-border-top panel-border-bottom",height:230,title:"Previsualization",bbar:b}),this.trackNameField=Ext.create("Ext.form.field.Text",{name:"file",fieldLabel:"Track Name",allowBlank:!1,value:"New track from "+this.title+" file",emptyText:"Choose a name",flex:1});var d=Ext.create("Ext.panel.Panel",{border:!1,layout:"hbox",bodyPadding:10,items:[this.trackNameField]});this.wum&&(null!=$.cookie("bioinfo_sid")?this.sessionInitiated():this.sessionFinished()),this.fileNameLabel=Ext.create("Ext.toolbar.TextItem",{}),this.btnOk=Ext.create("Ext.button.Button",{text:"Ok",disabled:!0,handler:function(){a.onOk.notify({fileName:a.file.name,adapter:a.adapter}),a.openDialog.close()}}),this.openDialog=Ext.create("Ext.window.Window",{title:"Open "+this.title+" file",width:600,resizable:!1,items:[c,d],buttons:[this.btnOk,{text:"Cancel",handler:function(){a.openDialog.close()}}],listeners:{scope:this,minimize:function(){this.openDialog.hide()},destroy:function(){delete this.openDialog}}})}this.openDialog.show()},FileWidget.prototype.sessionInitiated=function(){},FileWidget.prototype.sessionFinished=function(){},BEDFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,BEDFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,BEDFileWidget.prototype.draw=FileWidget.prototype.draw,BEDFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,BEDFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,BEDFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,BEDFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,BEDFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new BEDDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.onLoad.addEventListener(function(){b._loadChartInfo()}),b.btnOk.enable()},BEDFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new BEDDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this._loadChartInfo(),this.btnOk.enable()},GFFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,GFFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,GFFFileWidget.prototype.draw=FileWidget.prototype.draw,GFFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,GFFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,GFFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,GFFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,GFFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;switch(this.file=a,this.version){case"2":this.adapter=new GFF2DataAdapter(new FileDataSource(a),{species:this.viewer.species});break;case"3":this.adapter=new GFF3DataAdapter(new FileDataSource(a),{species:this.viewer.species});break;default:this.adapter=new GFF2DataAdapter(new FileDataSource(a),{species:this.viewer.species})}this.adapter.onLoad.addEventListener(function(){b._loadChartInfo()}),b.btnOk.enable()},GFFFileWidget.prototype.loadFileFromServer=function(a){switch(this.file={name:a.filename},this.version){case"2":this.adapter=new GFF2DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species});break;case"3":this.adapter=new GFF3DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species});break;default:this.adapter=new GFF2DataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species})}this._loadChartInfo(),this.btnOk.enable()},GTFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,GTFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,GTFFileWidget.prototype.draw=FileWidget.prototype.draw,GTFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,GTFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,GTFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,GTFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,GTFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new GTFDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.onLoad.addEventListener(function(){console.log(b.adapter.featuresByChromosome),b._loadChartInfo()}),b.btnOk.enable()},GTFFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new GTFDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this._loadChartInfo(),this.btnOk.enable()},VCFFileWidget.prototype.getTitleName=FileWidget.prototype.getTitleName,VCFFileWidget.prototype.getFileUpload=FileWidget.prototype.getFileUpload,VCFFileWidget.prototype.draw=FileWidget.prototype.draw,VCFFileWidget.prototype.sessionInitiated=FileWidget.prototype.sessionInitiated,VCFFileWidget.prototype.sessionFinished=FileWidget.prototype.sessionFinished,VCFFileWidget.prototype.getChartItems=FileWidget.prototype.getChartItems,VCFFileWidget.prototype._loadChartInfo=FileWidget.prototype._loadChartInfo,VCFFileWidget.prototype.loadFileFromLocal=function(a){var b=this;this.file=a,this.adapter=new VCFDataAdapter(new FileDataSource(a),{species:this.viewer.species}),this.adapter.on("file:load",function(){console.log(b.adapter.featuresByChromosome)}),b.btnOk.enable()},VCFFileWidget.prototype.loadFileFromServer=function(a){this.file={name:a.filename},this.adapter=new VCFDataAdapter(new StringDataSource(a.data),{async:!1,species:this.viewer.species}),this.btnOk.enable()},GenomeViewer.prototype={render:function(a){if(this.targetId=a?a:this.targetId,$("#"+this.targetId).length<1)return console.log("targetId not found in DOM"),void 0;console.log("Initializing GenomeViewer structure."),this.targetDiv=$("#"+this.targetId)[0],this.div=$('<div id="'+this.id+'" class="ocb-gv ocb-box-vertical"></div>')[0],$(this.targetDiv).append(this.div);var b=Math.max($(this.div).width(),$(this.targetDiv).width());if(0==b)return console.log("target div width is zero"),void 0;if(this._setWidth(b),this.border){var c=Utils.isString(this.border)?this.border:"1px solid lightgray";$(this.div).css({border:c})}Utils.setMinRegion(this.region,this.getSVGCanvasWidth()),this._recalculateZoom(),this.navigationbarDiv=$('<div id="navigation-'+this.id+'" class="ocb-gv-navigation"></div>')[0],$(this.div).append(this.navigationbarDiv),this.centerPanelDiv=$('<div id="center-'+this.id+'" class="ocb-gv-center"></div>')[0],$(this.div).append(this.centerPanelDiv),this.statusbarDiv=$('<div id="statusbar-'+this.id+'" class="ocb-gv-status"></div>'),$(this.div).append(this.statusbarDiv),this.rightSidebarDiv=$('<div id="rightsidebar-'+this.id+'" style="position:absolute; z-index:50;right:0px;"></div>')[0],this.leftSidebarDiv=$('<div id="leftsidebar-'+this.id+'" style="position:absolute; z-index:50;left:0px;"></div>')[0],$(this.centerPanelDiv).append(this.rightSidebarDiv),$(this.centerPanelDiv).append(this.leftSidebarDiv),this.karyotypeDiv=$('<div id="karyotype-'+this.id+'"></div>'),$(this.centerPanelDiv).append(this.karyotypeDiv),this.chromosomeDiv=$('<div id="chromosome-'+this.id+'"></div>'),$(this.centerPanelDiv).append(this.chromosomeDiv),this.regionDiv=$('<div id="region-'+this.id+'" ></div>'),$(this.centerPanelDiv).append(this.regionDiv),this.tracksDiv=$('<div id="tracks-'+this.id+'" ></div>'),$(this.centerPanelDiv).append(this.tracksDiv),this.rendered=!0},getRightSidePanelId:function(){return $(this.rightSidebarDiv).attr("id")},getLeftSidePanelId:function(){return $(this.leftSidebarDiv).attr("id")},getNavigationPanelId:function(){return $(this.navigationbarDiv).attr("id")},getStatusPanelId:function(){return $(this.statusbarDiv).attr("id")},setNavigationBar:function(a){this.navigationBar=a;var b={availableSpecies:this.availableSpecies,species:this.species,region:this.region,width:this.width,svgCanvasWidthOffset:this.trackPanelScrollWidth+this.sidePanelWidth,zoom:this.zoom};_.extend(this.navigationBar,b),a.render(this.getNavigationPanelId())},_setWidth:function(a){this.width=a,this._recalculateZoom(),this.trigger("width:change",{width:this.width,sender:this})},setWidth:function(a){$(this.div).width(a),this._setWidth(a)},getSVGCanvasWidth:function(){return this.width-this.trackPanelScrollWidth-this.sidePanelWidth},_setRegion:function(a){this.region.load(a),this._recalculateZoom()},setRegion:function(a){this.region.load(a),Utils.setMinRegion(this.region,this.getSVGCanvasWidth()),this.trigger("region:change",{region:this.region,sender:this})},move:function(a){this.region.start+=a,this.region.end+=a,this.trigger("region:move",{region:this.region,disp:-a,sender:this})},_recalculateZoom:function(){this.zoom=this._calculateZoomByRegion()},_calculateRegionByWidth:function(){var a=parseInt(this.getSVGCanvasWidth()/Utils.getPixelBaseByZoom(this.zoom)),b=this.region.center(),c=Math.ceil(a/2-1);return{start:Math.floor(b-c),end:Math.floor(b+c)}},_calculateZoomByRegion:function(){return Utils.getZoomByPixelBase(this.getSVGCanvasWidth()/this.region.length())},mark:function(a){var b=a.attrName||"feature_id",c=a.class||"feature-emph";if("attrValues"in a){a.attrValues=$.isArray(a.attrValues)?a.attrValues:[a.attrValues];for(var d in a.attrValues)$("rect["+b+"~="+a.attrValues[d]+"]").attr("class",c)}},unmark:function(a){var b=a.attrName||"feature_id";if("attrValues"in a){a.attrValues=$.isArray(a.attrValues)?a.attrValues:[a.attrValues];for(var c in a.attrValues)$("rect["+b+"~="+a.attrValues[c]+"]").attr("class","")}},highlight:function(a){this.trigger("feature:highlight",a)},draw:function(){if(!this.rendered)return console.info("Genome Viewer is not rendered yet"),void 0;var a=this;this.resizable&&$(window).resize(function(b){b.target==window&&(a.resizing||(a.resizing=!0,a._setWidth($(a.targetDiv).width()),setTimeout(function(){a.resizing=!1},400)))}),this.drawNavigationBar&&(this.navigationBar=this._createNavigationBar($(this.navigationbarDiv).attr("id"))),this.drawKaryotypePanel&&(this.karyotypePanel=this._drawKaryotypePanel($(this.karyotypeDiv).attr("id"))),this.drawChromosomePanel&&(this.chromosomePanel=this._drawChromosomePanel($(this.chromosomeDiv).attr("id"))),this.drawRegionOverviewPanel&&(this.regionOverviewPanel=this._createRegionOverviewPanel($(this.regionDiv).attr("id"))),this.trackListPanel=this._createTrackListPanel($(this.tracksDiv).attr("id")),this.drawStatusBar&&(this.statusBar=this._createStatusBar($(this.statusbarDiv).attr("id"))),this.on("region:change region:move",function(b){b.sender!=a&&a._setRegion(b.region)
})},_createNavigationBar:function(a){var b=this,c=new NavigationBar({targetId:a,availableSpecies:this.availableSpecies,species:this.species,region:this.region,width:this.width,svgCanvasWidthOffset:this.trackPanelScrollWidth+this.sidePanelWidth,zoom:this.zoom,autoRender:!0,handlers:{"region:change":function(a){Utils.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"karyotype-button:change":function(a){a.selected?b.karyotypePanel.show():b.karyotypePanel.hide()},"chromosome-button:change":function(a){a.selected?b.chromosomePanel.show():b.chromosomePanel.hide()},"region-button:change":function(a){a.selected?b.regionOverviewPanel.show():b.regionOverviewPanel.hide()},"region:move":function(a){b.trigger("region:move",a)},"species:change":function(a){b.trigger("species:change",a),b.setRegion(a.species.region)},"fullscreen:click":function(){b.fullscreen?($(b.div).css({width:"auto"}),Utils.cancelFullscreen(),b.fullscreen=!1):($(b.div).css({width:screen.width}),Utils.launchFullScreen(b.div),b.fullscreen=!0)},"restoreDefaultRegion:click":function(a){Utils.setMinRegion(b.defaultRegion,b.getSVGCanvasWidth()),a.region=b.defaultRegion,b.trigger("region:change",a)}}});return this.on("region:change",function(a){a.sender!=c&&b.navigationBar.setRegion(a.region)}),this.on("region:move",function(a){a.sender!=c&&b.navigationBar.moveRegion(a.region)}),this.on("width:change",function(a){b.navigationBar.setWidth(a.width)}),c.draw(),c},_drawKaryotypePanel:function(a){var b=this;return karyotypePanel=new KaryotypePanel({targetId:a,width:this.width-this.sidePanelWidth,height:125,species:this.species,title:"Karyotype",region:this.region,autoRender:!0,handlers:{"region:change":function(a){Utils.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)}}}),this.on("region:change region:move",function(a){a.sender!=karyotypePanel&&karyotypePanel.setRegion(a.region)}),this.on("width:change",function(a){karyotypePanel.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){karyotypePanel.setSpecies(a.species)}),karyotypePanel.draw(),karyotypePanel},_drawChromosomePanel:function(a){var b=this,c=new ChromosomePanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,height:65,species:this.species,title:"Chromosome",region:this.region,handlers:{"region:change":function(a){b.trigger("region:change",a)}}});return this.on("region:change region:move",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)}),c.draw(),c},_createRegionOverviewPanel:function(a){var b=this,c=new TrackListPanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,zoom:this.zoom,zoomMultiplier:8,title:"Region overview",region:this.region,handlers:{"region:change":function(a){a.sender={},Utils.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"region:move":function(a){b.trigger("region:move",a)}}});this.on("region:change",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("region:move",function(a){a.sender!=c&&c.moveRegion(a)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)});var d=new FeatureTrack({targetId:null,id:2,title:"Gene",histogramZoom:10,labelZoom:20,height:100,visibleRange:{start:0,end:100},titleVisibility:"hidden",featureTypes:FEATURE_TYPES,renderer:new FeatureRenderer("gene"),dataAdapter:new CellBaseAdapter({category:"genomic",subCategory:"region",resource:"gene",species:this.species,featureCache:{gzip:!0,chunkSize:5e4}})});return c.addTrack(d),c},_createTrackListPanel:function(a){var b=this,c=new TrackListPanel({targetId:a,autoRender:!0,width:this.width-this.sidePanelWidth,zoom:this.zoom,title:this.trackListTitle,region:this.region,handlers:{"region:change":function(a){a.sender={},Utils.setMinRegion(a.region,b.getSVGCanvasWidth()),b.trigger("region:change",a)},"region:move":function(a){b.trigger("region:move",a)}}});return this.on("feature:highlight",function(a){c.highlight(a)}),this.on("region:change",function(a){a.sender!=c&&c.setRegion(a.region)}),this.on("region:move",function(a){a.sender!=c&&c.moveRegion(a)}),this.on("width:change",function(a){c.setWidth(a.width-b.sidePanelWidth)}),this.on("species:change",function(a){c.setSpecies(a.species)}),c},_createStatusBar:function(a){var b=new StatusBar({targetId:a,autoRender:!0,region:this.region,width:this.width,version:this.version});return this.trackListPanel.on("mousePosition:change",function(a){b.setMousePosition(a)}),this.on("region:change",function(a){b.setRegion(a)}),b},setSpeciesVisible:function(a){this.navigationBar.setSpeciesVisible(a)},setChromosomesVisible:function(a){this.navigationBar.setChromosomeMenuVisible(a)},setKaryotypePanelVisible:function(a){this.karyotypePanel.setVisible(a),this.navigationBar.setVisible({karyotype:a})},setChromosomePanelVisible:function(a){this.chromosomePanel.setVisible(a),this.navigationBar.setVisible({chromosome:a})},setRegionOverviewPanelVisible:function(a){this.regionOverviewPanel.setVisible(a),this.navigationBar.setVisible({region:a})},setRegionTextBoxVisible:function(a){this.navigationBar.setRegionTextBoxVisible(a)},setSearchVisible:function(a){this.navigationBar.setSearchVisible(a)},setFullScreenVisible:function(a){this.navigationBar.setFullScreenButtonVisible(a)}},GenomeViewer.prototype.addTrack=function(a,b){this.trackListPanel.addTrack(a,b)},GenomeViewer.prototype.getTrackSvgById=function(a){return this.trackListPanel.getTrackSvgById(a)},GenomeViewer.prototype.removeTrack=function(a){return this.trackListPanel.removeTrack(a)},GenomeViewer.prototype.restoreTrack=function(a,b){return this.trackListPanel.restoreTrack(a,b)},GenomeViewer.prototype.setTrackIndex=function(a,b){return this.trackListPanel.setTrackIndex(a,b)},GenomeViewer.prototype.scrollToTrack=function(a){return this.trackListPanel.scrollToTrack(a)},GenomeViewer.prototype.showTrack=function(a){this.trackListPanel._showTrack(a)},GenomeViewer.prototype.hideTrack=function(a){this.trackListPanel._hideTrack(a)},GenomeViewer.prototype.checkRenderedTrack=function(a){return this.trackListPanel.swapHash[a]?!0:!1};